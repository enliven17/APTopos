{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/base64.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/helpers.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/connect/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/WalletRequest.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/AccountAuthenticatorInput.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/AccountInfo.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/PublicKey.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/AccountInput.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/DappInfo.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/EntryFunctionArgument.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/Signature.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/TransactionPayloadInput.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/UserResponse.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/WalletResponse.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/connect/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/disconnect/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/disconnect/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/AptosSignInInput.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signIn/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/shared/AptosSignInOutput.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signIn/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/getConnectedAccounts/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/getConnectedAccounts/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/isConnected/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/isConnected/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signAndSubmitTransaction/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signAndSubmitTransaction/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signMessage/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signMessage/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signTransaction/request.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/features/signTransaction/response.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/messages/common.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/messages/prompt.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/PopupWalletRequest.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40aptos-connect/wallet-api/src/WalletRequestBody.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport function base64ToBytes(base64: string) {\n  const binaryString = atob(base64);\n  return Uint8Array.from(binaryString, (m) => m.charCodeAt(0));\n}\n\nexport function bytesToBase64(bytes: Uint8Array) {\n  const binaryString = String.fromCharCode(...bytes);\n  return btoa(binaryString);\n}\n\nexport function base64urlToBytes(base64: string) {\n  return base64ToBytes(base64.replace(/-/g, '+').replace(/_/g, '/'));\n}\n\nexport function bytesToBase64url(bytes: Uint8Array) {\n  return bytesToBase64(bytes).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Network, NetworkToChainId, Serializer } from '@aptos-labs/ts-sdk';\n\nexport type SerializeFn<T> = (serializer: Serializer, value: T) => void;\nexport type DeserializeFn<T> = (deserializer: Deserializer) => T;\n\nexport function chainIdToNetwork(chainId: number): Network {\n  switch (chainId) {\n    case NetworkToChainId.mainnet:\n      return Network.MAINNET;\n    case NetworkToChainId.testnet:\n      return Network.TESTNET;\n    default:\n      // TODO: fetch Devnet's chain id and compare, otherwise throw error\n      return Network.DEVNET;\n  }\n}\n\nexport function isSupportedNetwork(network: string): network is Network {\n  return [Network.MAINNET, Network.TESTNET, Network.DEVNET].includes(network as Network);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Ed25519PrivateKey, Network, Serializer } from '@aptos-labs/ts-sdk';\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequestWithArgs,\n  SerializedWalletRequest,\n  serializeWalletRequestWithArgs,\n  WalletRequest,\n} from '../../WalletRequest';\nimport { isSupportedNetwork } from '../../helpers';\n\nexport interface ClaimOptions {\n  asset?: string;\n  network: Network;\n  secretKey: Ed25519PrivateKey;\n}\n\nexport interface ConnectRequest extends WalletRequest<ConnectRequest.RequestName, ConnectRequest.SupportedVersions> {\n  args: ConnectRequest.Args;\n}\n\nexport namespace ConnectRequest {\n  export const name = 'connect' as const;\n  export type RequestName = typeof name;\n\n  export const supportedVersions = [1, 2, 3, 4] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n  export const currentVersion = 4 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region Args\n\n  export type Args = {\n    claimOptions?: ClaimOptions;\n    dappEd25519PublicKeyB64?: string;\n    dappId?: string;\n    // Whether to display paired accounts under the specified wallet first\n    preferredWalletName?: string;\n  };\n\n  export function serializeArgs(serializer: Serializer, value: Args) {\n    serializer.serializeOptionStr(value.dappId);\n    serializer.serializeOptionStr(value.dappEd25519PublicKeyB64);\n    serializer.serializeOptionStr(value.preferredWalletName);\n\n    serializer.serializeBool(value.claimOptions !== undefined);\n    if (value.claimOptions) {\n      serializer.serialize(value.claimOptions.secretKey);\n      serializer.serializeStr(value.claimOptions.network);\n      serializer.serializeOptionStr(value.claimOptions.asset);\n      if (!isSupportedNetwork(value.claimOptions.network)) {\n        throw new Error(`Unsupported network '${value.claimOptions.network}'`);\n      }\n    }\n  }\n\n  export function deserializeArgs(deserializer: Deserializer, version: SupportedVersions): Args {\n    if (version === 1) {\n      return {};\n    }\n\n    const dappId = deserializer.deserializeOption('string');\n    const dappEd25519PublicKeyB64 = deserializer.deserializeOption('string');\n    const preferredWalletName = version >= 3 ? deserializer.deserializeOption('string') : undefined;\n\n    const hasClaimOptions = version >= 4 ? deserializer.deserializeBool() : false;\n    let claimOptions: ClaimOptions | undefined;\n    if (hasClaimOptions) {\n      const secretKey = deserializer.deserialize(Ed25519PrivateKey);\n      const network = deserializer.deserializeStr();\n      const asset = deserializer.deserializeOption('string');\n\n      if (!isSupportedNetwork(network)) {\n        throw new Error(`Unsupported network '${network}'`);\n      }\n\n      claimOptions = { asset, network, secretKey };\n    }\n\n    return { claimOptions, dappEd25519PublicKeyB64, dappId, preferredWalletName };\n  }\n\n  // endregion\n\n  export function serialize(\n    dappInfo: DappInfo,\n    args: ConnectRequest.Args = {},\n  ): SerializedWalletRequest<RequestName, CurrentVersion> {\n    return serializeWalletRequestWithArgs({ args, dappInfo, name, version: currentVersion }, serializeArgs);\n  }\n\n  export function deserialize(request: SerializedWalletRequest<RequestName, SupportedVersions>): ConnectRequest {\n    return deserializeWalletRequestWithArgs(request, (d) => deserializeArgs(d, request.version));\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, SupportedVersions> {\n    return request.name === name && supportedVersions.includes(request.version as SupportedVersions);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { DappInfo, deserializeDappInfo, serializeDappInfo } from './shared';\nimport { DeserializeFn, SerializeFn } from './helpers';\n\nexport interface WalletRequest<RequestName extends string, Version extends number> {\n  dappInfo: DappInfo;\n  name: RequestName;\n  version: Version;\n}\n\nexport interface WalletRequestWithArgs<RequestName extends string, Version extends number, TArgs>\n  extends WalletRequest<RequestName, Version> {\n  args: TArgs;\n}\n\nexport interface SerializedWalletRequest<RequestName extends string = string, Version extends number = number> {\n  data: Uint8Array;\n  name: RequestName;\n  version: Version;\n}\n\nexport function serializeWalletRequest<RequestName extends string, Version extends number>({\n  dappInfo,\n  name,\n  version,\n}: WalletRequest<RequestName, Version>): SerializedWalletRequest<RequestName, Version> {\n  const serializer = new Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\n\nexport function deserializeWalletRequest<RequestName extends string, Version extends number>({\n  data,\n  name,\n  version,\n}: SerializedWalletRequest<RequestName, Version>): WalletRequest<RequestName, Version> {\n  const deserializer = new Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  return { dappInfo, name, version };\n}\n\nexport function serializeWalletRequestWithArgs<RequestName extends string, Version extends number, TArgs>(\n  { args, dappInfo, name, version }: WalletRequestWithArgs<RequestName, Version, TArgs>,\n  serializeArgsFn: SerializeFn<TArgs>,\n): SerializedWalletRequest<RequestName, Version> {\n  const serializer = new Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  serializeArgsFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\n\nexport function deserializeWalletRequestWithArgs<RequestName extends string, Version extends number, TArgs>(\n  { data, name, version }: SerializedWalletRequest<RequestName, Version>,\n  deserializeArgsFn: DeserializeFn<TArgs>,\n): WalletRequestWithArgs<RequestName, Version, TArgs> {\n  const deserializer = new Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  const args = deserializeArgsFn(deserializer);\n  return { args, dappInfo, name, version };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountAddress, AccountAuthenticator, Deserializer, Serializer } from '@aptos-labs/ts-sdk';\n\nexport interface AccountAuthenticatorInput {\n  address: AccountAddress;\n  authenticator: AccountAuthenticator;\n}\n\nexport function serializeAccountAuthenticatorInput(serializer: Serializer, value: AccountAuthenticatorInput) {\n  serializer.serialize(value.address);\n  serializer.serialize(value.authenticator);\n}\n\nexport function deserializeAccountAuthenticatorInput(deserializer: Deserializer): AccountAuthenticatorInput {\n  const address = deserializer.deserialize(AccountAddress);\n  const authenticator = deserializer.deserialize(AccountAuthenticator);\n  return { address, authenticator };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountAddress, Deserializer, PublicKey, Serializer } from '@aptos-labs/ts-sdk';\nimport { deserializePublicKey, serializePublicKey } from './PublicKey';\n\nexport interface AccountInfo {\n  address: AccountAddress;\n  name?: string;\n  publicKey: PublicKey;\n}\n\nexport function serializeAccountInfo(serializer: Serializer, value: AccountInfo) {\n  serializer.serialize(value.address);\n  serializePublicKey(serializer, value.publicKey);\n  serializer.serializeStr(value.name ?? '');\n}\n\nexport function deserializeAccountInfo(deserializer: Deserializer): AccountInfo {\n  const address = deserializer.deserialize(AccountAddress);\n  const publicKey = deserializePublicKey(deserializer);\n  const name = deserializer.deserializeStr();\n  return {\n    address,\n    publicKey,\n    ...(name.length > 0 ? { name } : undefined),\n  };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AnyPublicKey,\n  Deserializer,\n  Ed25519PublicKey,\n  MultiEd25519PublicKey,\n  MultiKey,\n  PublicKey,\n  Serializer,\n  SigningScheme,\n} from '@aptos-labs/ts-sdk';\n\nexport function serializePublicKey(serializer: Serializer, value: PublicKey) {\n  if (value instanceof Ed25519PublicKey) {\n    serializer.serializeU32AsUleb128(SigningScheme.Ed25519);\n  } else if (value instanceof MultiEd25519PublicKey) {\n    serializer.serializeU32AsUleb128(SigningScheme.MultiEd25519);\n  } else if (value instanceof AnyPublicKey) {\n    serializer.serializeU32AsUleb128(SigningScheme.SingleKey);\n  } else if (value instanceof MultiKey) {\n    serializer.serializeU32AsUleb128(SigningScheme.MultiKey);\n  } else {\n    throw new Error('Unexpected public key type');\n  }\n  serializer.serialize(value);\n}\n\nexport function deserializePublicKey(deserializer: Deserializer): PublicKey {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case SigningScheme.Ed25519:\n      return deserializer.deserialize(Ed25519PublicKey);\n    case SigningScheme.MultiEd25519:\n      return deserializer.deserialize(MultiEd25519PublicKey);\n    case SigningScheme.SingleKey:\n      return deserializer.deserialize(AnyPublicKey);\n    case SigningScheme.MultiKey:\n      return deserializer.deserialize(MultiKey);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountAddress, Deserializer, PublicKey, Serializer } from '@aptos-labs/ts-sdk';\nimport { deserializePublicKey, serializePublicKey } from './PublicKey';\n\nexport interface AccountInput {\n  address: AccountAddress;\n  publicKey?: PublicKey;\n}\n\nexport function serializeAccountInput(serializer: Serializer, value: AccountInput) {\n  serializer.serialize(value.address);\n  serializer.serializeBool(value.publicKey !== undefined);\n  if (value.publicKey) {\n    serializePublicKey(serializer, value.publicKey);\n  }\n}\n\nexport function deserializeAccountInput(deserializer: Deserializer): AccountInput {\n  const address = deserializer.deserialize(AccountAddress);\n  const hasPublicKey = deserializer.deserializeBool();\n  const publicKey = hasPublicKey ? deserializePublicKey(deserializer) : undefined;\n  return { address, publicKey };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\n\nexport interface DappInfo {\n  domain: string;\n  imageURI?: string;\n  name: string;\n}\n\nexport function serializeDappInfo(serializer: Serializer, value: DappInfo) {\n  serializer.serializeStr(value.domain);\n  serializer.serializeStr(value.name);\n  serializer.serializeBool(value.imageURI !== undefined);\n  if (value.imageURI !== undefined) {\n    serializer.serializeStr(value.imageURI);\n  }\n}\n\nexport function deserializeDappInfo(deserializer: Deserializer): DappInfo {\n  const domain = deserializer.deserializeStr();\n  const name = deserializer.deserializeStr();\n  const hasImageUri = deserializer.deserializeBool();\n  const imageURI = hasImageUri ? deserializer.deserializeStr() : undefined;\n  return { domain, imageURI, name };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  Deserializer,\n  EntryFunctionArgumentTypes,\n  FixedBytes,\n  Serializer,\n  SimpleEntryFunctionArgumentTypes,\n} from '@aptos-labs/ts-sdk';\n\nexport type EntryFunctionArgument = EntryFunctionArgumentTypes | SimpleEntryFunctionArgumentTypes;\n\n/* eslint-disable @typescript-eslint/no-shadow */\nexport enum EntryFunctionArgumentVariant {\n  Undefined,\n  Array,\n  String,\n  Uint8Array,\n  AccountAddress,\n  FixedBytes,\n}\n\n/* eslint-enable @typescript-eslint/no-shadow */\n\nexport function serializeEntryFunctionArgument(serializer: Serializer, argument: EntryFunctionArgument) {\n  // undefined | null -> undefined\n  if (argument === undefined || argument === null) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Undefined);\n    return;\n  }\n\n  // Array -> Array\n  if (Array.isArray(argument)) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Array);\n    serializer.serializeU32AsUleb128(argument.length);\n    for (const subArgument of argument) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n\n  // boolean | number | bigint | string -> string\n  if (\n    typeof argument === 'string' ||\n    typeof argument === 'number' ||\n    typeof argument === 'boolean' ||\n    typeof argument === 'bigint'\n  ) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.String);\n    serializer.serializeStr(argument.toString());\n    return;\n  }\n\n  // Uint8Array -> Uint8Array\n  if (argument instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Uint8Array);\n    serializer.serializeBytes(argument);\n    return;\n  }\n\n  // ArrayBuffer -> Uint8Array\n  if (argument instanceof ArrayBuffer) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Uint8Array);\n    serializer.serializeBytes(new Uint8Array(argument));\n    return;\n  }\n\n  // MoveVector -> Array\n  if ('values' in argument) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Array);\n    serializer.serializeU32AsUleb128(argument.values.length);\n    for (const subArgument of argument.values) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n\n  // AccountAddress -> AccountAddress\n  if ('data' in argument) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.AccountAddress);\n    serializer.serialize(argument);\n    return;\n  }\n\n  // Empty MoveOption -> undefined\n  if (argument.value === undefined) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.Undefined);\n    serializer.serialize(argument);\n    return;\n  }\n\n  // FixedBytes -> FixedBytes\n  if (argument.value instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.FixedBytes);\n    serializer.serializeBytes(argument.value);\n    return;\n  }\n\n  // Bool | U8 | U16 | U32 | U64 | U128 | U256 | MoveString -> string\n  serializer.serializeU32AsUleb128(EntryFunctionArgumentVariant.String);\n  serializer.serializeStr(argument.value.toString());\n}\n\nexport function deserializeEntryFunctionArgument(deserializer: Deserializer): EntryFunctionArgument {\n  const variant = deserializer.deserializeUleb128AsU32() as EntryFunctionArgumentVariant;\n\n  switch (variant) {\n    // undefined | null | empty MoveOption\n    case EntryFunctionArgumentVariant.Undefined: {\n      return undefined;\n    }\n    // Array | MoveVector\n    case EntryFunctionArgumentVariant.Array: {\n      const length = deserializer.deserializeUleb128AsU32();\n      const args: (EntryFunctionArgumentTypes | SimpleEntryFunctionArgumentTypes)[] = [];\n      for (let i = 0; i < length; i += 1) {\n        const argument = deserializeEntryFunctionArgument(deserializer);\n        args.push(argument);\n      }\n      return args;\n    }\n    // Uint8Array | ArrayBuffer | FixedBytes\n    case EntryFunctionArgumentVariant.Uint8Array: {\n      return deserializer.deserializeBytes();\n    }\n    // AccountAddress\n    case EntryFunctionArgumentVariant.AccountAddress: {\n      return deserializer.deserialize(AccountAddress);\n    }\n    // Bool | U8 | U16 | U32 | U64 | U128 | U256 | MoveString\n    case EntryFunctionArgumentVariant.String: {\n      return deserializer.deserializeStr();\n    }\n    // FixedBytes (custom serialization)\n    case EntryFunctionArgumentVariant.FixedBytes: {\n      const bytes = deserializer.deserializeBytes();\n      return new FixedBytes(bytes);\n    }\n    default: {\n      throw new Error('Unexpected variant');\n    }\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AnySignature,\n  Deserializer,\n  Ed25519Signature,\n  MultiEd25519Signature,\n  // This type got renamed in the zeta branch, commenting out until it's synced with main\n  // MultiSignature,\n  Serializer,\n  Signature,\n  SigningScheme,\n} from '@aptos-labs/ts-sdk';\n\nexport function serializeSignature(serializer: Serializer, value: Signature) {\n  if (value instanceof Ed25519Signature) {\n    serializer.serializeU32AsUleb128(SigningScheme.Ed25519);\n  } else if (value instanceof MultiEd25519Signature) {\n    serializer.serializeU32AsUleb128(SigningScheme.MultiEd25519);\n  } else if (value instanceof AnySignature) {\n    serializer.serializeU32AsUleb128(SigningScheme.SingleKey);\n    // } else if (value instanceof MultiSignature) {\n    //   serializer.serializeU32AsUleb128(SigningScheme.MultiKey);\n  } else {\n    throw new Error('Unexpected signature type');\n  }\n  serializer.serialize(value);\n}\n\nexport function deserializeSignature(deserializer: Deserializer) {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case SigningScheme.Ed25519:\n      return deserializer.deserialize(Ed25519Signature);\n    case SigningScheme.MultiEd25519:\n      return deserializer.deserialize(MultiEd25519Signature);\n    case SigningScheme.SingleKey:\n      return deserializer.deserialize(AnySignature);\n    // case SigningScheme.MultiKey:\n    //   return deserializer.deserialize(MultiSignature);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  deserializeFromScriptArgument,\n  Deserializer,\n  Hex,\n  InputGenerateTransactionPayloadData,\n  MoveFunctionId,\n  parseTypeTag,\n  ScriptFunctionArgumentTypes,\n  Serializer,\n  TypeArgument,\n  TypeTag,\n} from '@aptos-labs/ts-sdk';\nimport {\n  deserializeEntryFunctionArgument,\n  EntryFunctionArgument,\n  serializeEntryFunctionArgument,\n} from './EntryFunctionArgument';\n\nexport enum TransactionPayloadInputVariant {\n  EntryFunction,\n  Script,\n  Multisig,\n}\n\n// region Utils\n\nfunction serializeTypeArguments(serializer: Serializer, typeArguments: TypeArgument[]) {\n  serializer.serializeU32AsUleb128(typeArguments.length);\n  for (const typeArgument of typeArguments) {\n    const typeTag =\n      typeof typeArgument === 'string' ? parseTypeTag(typeArgument, { allowGenerics: true }) : typeArgument;\n    serializer.serialize(typeTag);\n  }\n}\n\nfunction deserializeTypeArguments(deserializer: Deserializer) {\n  const typeArguments: TypeTag[] = [];\n  const typeArgumentsLength = deserializer.deserializeUleb128AsU32();\n  for (let i = 0; i < typeArgumentsLength; i += 1) {\n    const typeTag = deserializer.deserialize(TypeTag);\n    typeArguments.push(typeTag);\n  }\n  return typeArguments;\n}\n\nfunction serializeEntryFunctionArguments(serializer: Serializer, functionArguments: EntryFunctionArgument[]) {\n  serializer.serializeU32AsUleb128(functionArguments.length);\n  for (const functionArgument of functionArguments) {\n    serializeEntryFunctionArgument(serializer, functionArgument);\n  }\n}\n\nfunction deserializeEntryFunctionArguments(deserializer: Deserializer) {\n  const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n  const functionArguments: EntryFunctionArgument[] = [];\n  for (let i = 0; i < functionArgumentsLength; i += 1) {\n    const functionArgument = deserializeEntryFunctionArgument(deserializer);\n    functionArguments.push(functionArgument);\n  }\n  return functionArguments;\n}\n\n// endregion\n\nexport function serializeTransactionPayloadInput(serializer: Serializer, value: InputGenerateTransactionPayloadData) {\n  if ('multisigAddress' in value) {\n    serializer.serializeU32AsUleb128(TransactionPayloadInputVariant.Multisig);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n    const multisigAddress = AccountAddress.from(value.multisigAddress);\n    serializer.serialize(multisigAddress);\n  } else if ('function' in value) {\n    serializer.serializeU32AsUleb128(TransactionPayloadInputVariant.EntryFunction);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n    // TODO: possibly serialize ABI?\n  } else {\n    serializer.serializeU32AsUleb128(TransactionPayloadInputVariant.Script);\n    const bytecode = Hex.fromHexInput(value.bytecode);\n    serializer.serializeBytes(bytecode.toUint8Array());\n    serializer.serializeU32AsUleb128(value.functionArguments.length);\n    for (const argument of value.functionArguments) {\n      argument.serializeForScriptFunction(serializer);\n    }\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n  }\n}\n\nexport function deserializeTransactionPayloadInput(deserializer: Deserializer): InputGenerateTransactionPayloadData {\n  const variant = deserializer.deserializeUleb128AsU32();\n  switch (variant) {\n    case TransactionPayloadInputVariant.Multisig: {\n      const functionId = deserializer.deserializeStr() as MoveFunctionId;\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      const multisigAddress = deserializer.deserialize(AccountAddress);\n      return {\n        function: functionId,\n        functionArguments,\n        multisigAddress,\n        typeArguments,\n      };\n    }\n    case TransactionPayloadInputVariant.EntryFunction: {\n      const functionId = deserializer.deserializeStr() as MoveFunctionId;\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        function: functionId,\n        functionArguments,\n        typeArguments,\n      };\n    }\n    case TransactionPayloadInputVariant.Script: {\n      const bytecode = deserializer.deserializeBytes();\n      const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n      const functionArguments: ScriptFunctionArgumentTypes[] = [];\n      for (let i = 0; i < functionArgumentsLength; i += 1) {\n        const argument = deserializeFromScriptArgument(deserializer);\n        functionArguments.push(argument as ScriptFunctionArgumentTypes);\n      }\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        bytecode,\n        functionArguments,\n        typeArguments,\n      };\n    }\n    default: {\n      throw new Error('Unexpected variant');\n    }\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { DeserializeFn, SerializeFn } from './helpers';\n\nexport interface UserApproval<TApprovalArgs> {\n  args: TApprovalArgs;\n  status: 'approved';\n}\n\nexport interface UserDismissal {\n  status: 'dismissed';\n}\n\nexport type UserResponse<TApprovalArgs> = UserApproval<TApprovalArgs> | UserDismissal;\n\nexport function makeUserApproval<TApprovalArgs>(args: TApprovalArgs): UserApproval<TApprovalArgs> {\n  return { args, status: 'approved' };\n}\n\nexport function makeUserResponseSerializeFn<TArgs>(\n  serializeArgs: SerializeFn<TArgs>,\n): SerializeFn<UserResponse<TArgs>> {\n  return (serializer: Serializer, value: UserResponse<TArgs>) => {\n    serializer.serializeBool(value.status === 'approved');\n    if (value.status === 'approved') {\n      serializeArgs(serializer, value.args);\n    }\n  };\n}\n\nexport function makeUserResponseDeserializeFn<TArgs>(\n  deserializeArgs: DeserializeFn<TArgs>,\n): DeserializeFn<UserResponse<TArgs>> {\n  return (deserializer: Deserializer) => {\n    const isApproved = deserializer.deserializeBool();\n    return isApproved ? { args: deserializeArgs(deserializer), status: 'approved' } : { status: 'dismissed' };\n  };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { DeserializeFn, SerializeFn } from './helpers';\n\nexport interface WalletResponseWithArgs<TResponseArgs> {\n  args: TResponseArgs;\n}\n\nexport interface SerializedWalletResponse {\n  data: Uint8Array;\n}\n\nexport function serializeWalletResponse<TArgs>(args: TArgs, serializeFn: SerializeFn<TArgs>): SerializedWalletResponse {\n  const serializer = new Serializer();\n  serializeFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data };\n}\n\nexport function deserializeWalletResponse<TArgs>(\n  { data }: SerializedWalletResponse,\n  deserializeFn: DeserializeFn<TArgs>,\n): WalletResponseWithArgs<TArgs> {\n  const deserializer = new Deserializer(data);\n  const args = deserializeFn(deserializer);\n  return { args };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { FinalizedPairingData, SerializedDate } from '@identity-connect/api';\nimport { type AccountInfo, deserializeAccountInfo, serializeAccountInfo } from '../../shared';\nimport { makeUserResponseDeserializeFn, makeUserResponseSerializeFn, UserResponse } from '../../UserResponse';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface ConnectResponse extends WalletResponseWithArgs<ConnectResponse.Args> {}\n\nexport namespace ConnectResponse {\n  export const supportedVersions = [1, 2] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n  export const currentVersion = 2 as const;\n\n  // region ApprovalArgs\n\n  export interface ApprovalArgs {\n    account: AccountInfo;\n    pairing?: SerializedDate<FinalizedPairingData>;\n  }\n\n  function serializeApprovalArgsV1(serializer: Serializer, value: ApprovalArgs) {\n    serializeAccountInfo(serializer, value.account);\n  }\n\n  function serializeApprovalArgs(serializer: Serializer, value: ApprovalArgs) {\n    serializeAccountInfo(serializer, value.account);\n    serializer.serializeOptionStr(value.pairing !== undefined ? JSON.stringify(value.pairing) : undefined);\n  }\n\n  function deserializeApprovalArgs(deserializer: Deserializer): ApprovalArgs {\n    const account = deserializeAccountInfo(deserializer);\n    const serializedPairing = deserializer.deserializeOption('string');\n    const pairing = serializedPairing !== undefined ? JSON.parse(serializedPairing) : undefined;\n    return { account, pairing };\n  }\n\n  // endregion\n\n  // region ResponseArgs\n\n  export type Args = UserResponse<ApprovalArgs>;\n\n  const serializeArgsV1 = makeUserResponseSerializeFn(serializeApprovalArgsV1);\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n\n  // endregion\n\n  type _Response = ConnectResponse;\n\n  export function serialize(args: Args, version: SupportedVersions = currentVersion): SerializedWalletResponse {\n    return serializeWalletResponse(args, version === 1 ? serializeArgsV1 : serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequest,\n  SerializedWalletRequest,\n  serializeWalletRequest,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface DisconnectRequest\n  extends WalletRequest<DisconnectRequest.RequestName, DisconnectRequest.CurrentVersion> {}\n\nexport namespace DisconnectRequest {\n  export const name = 'disconnect' as const;\n  export type RequestName = typeof name;\n\n  export const currentVersion = 1 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  export function serialize(dappInfo: DappInfo): SerializedWalletRequest<RequestName, CurrentVersion> {\n    return serializeWalletRequest({ dappInfo, name, version: currentVersion });\n  }\n\n  export function deserialize(request: SerializedWalletRequest<RequestName, CurrentVersion>): DisconnectRequest {\n    return deserializeWalletRequest(request);\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, CurrentVersion> {\n    return request.name === name && request.version === currentVersion;\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface DisconnectResponse extends WalletResponseWithArgs<DisconnectResponse.Args> {}\n\nexport namespace DisconnectResponse {\n  export type Args = {};\n  type _Response = DisconnectResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, () => {});\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, () => ({}));\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { AptosSignInInput } from '@aptos-labs/wallet-standard';\n\nexport function serializeAptosSignInInput(serializer: Serializer, value: AptosSignInInput) {\n  serializer.serializeStr(JSON.stringify(value));\n}\n\nexport function deserializeAptosSignInInput(deserializer: Deserializer): AptosSignInInput {\n  return JSON.parse(deserializer.deserializeStr());\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Network, Serializer } from '@aptos-labs/ts-sdk';\nimport { AptosSignInInput } from '@aptos-labs/wallet-standard';\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequestWithArgs,\n  SerializedWalletRequest,\n  serializeWalletRequestWithArgs,\n  WalletRequest,\n} from '../../WalletRequest';\nimport { deserializeAptosSignInInput, serializeAptosSignInInput } from '../../shared/AptosSignInInput';\nimport { isSupportedNetwork } from '../../helpers';\n\nexport interface SignInRequest extends WalletRequest<SignInRequest.RequestName, SignInRequest.SupportedVersions> {\n  args: SignInRequest.Args;\n}\n\nexport namespace SignInRequest {\n  export const name = 'signIn' as const;\n  export type RequestName = typeof name;\n\n  export const supportedVersions = [1, 2] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n\n  export const currentVersion = 2 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region Args\n\n  export type Args = AptosSignInInput & {\n    network: Network;\n  };\n\n  export function serializeArgs(serializer: Serializer, value: Args) {\n    if (value.network !== undefined && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}' in SignInRequest.serializeArgs`);\n    }\n\n    serializeAptosSignInInput(serializer, value);\n    serializer.serializeStr(value.network);\n  }\n\n  export function deserializeArgs(deserializer: Deserializer, _: SupportedVersions): Args {\n    return { ...deserializeAptosSignInInput(deserializer), network: deserializer.deserializeStr() as Network };\n  }\n\n  // endregion\n\n  export function serialize(\n    dappInfo: DappInfo,\n    args: SignInRequest.Args,\n  ): SerializedWalletRequest<RequestName, CurrentVersion> {\n    return serializeWalletRequestWithArgs({ args, dappInfo, name, version: currentVersion }, serializeArgs);\n  }\n\n  export function deserialize(request: SerializedWalletRequest<RequestName, SupportedVersions>): SignInRequest {\n    return deserializeWalletRequestWithArgs(request, (d) => deserializeArgs(d, request.version));\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, SupportedVersions> {\n    return request.name === name && supportedVersions.includes(request.version as SupportedVersions);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { AccountInfo, AptosSignInOutput } from '@aptos-labs/wallet-standard';\nimport { deserializeSignature, serializeSignature } from './Signature';\nimport { serializeAccountInfo, deserializeAccountInfo } from './AccountInfo';\n\nexport function serializeAptosSignInOutputV1(\n  serializer: Serializer,\n  value: AptosSignInOutput & { plainText: string; signingMessage: Uint8Array },\n) {\n  serializeAccountInfo(serializer, value.account);\n  serializer.serializeStr(JSON.stringify(value.input));\n  serializer.serializeStr(value.plainText);\n  serializeSignature(serializer, value.signature);\n  serializer.serializeBytes(value.signingMessage);\n  serializer.serializeStr(value.type);\n}\n\nexport function deserializeAptosSignInOutputV1(\n  deserializer: Deserializer,\n): AptosSignInOutput & { plainText: string; signingMessage: Uint8Array } {\n  return {\n    account: new AccountInfo(deserializeAccountInfo(deserializer)),\n    input: JSON.parse(deserializer.deserializeStr()),\n    plainText: deserializer.deserializeStr(),\n    signature: deserializeSignature(deserializer),\n    signingMessage: deserializer.deserializeBytes(),\n    type: deserializer.deserializeStr(),\n  };\n}\n\nexport function serializeAptosSignInOutput(serializer: Serializer, value: AptosSignInOutput) {\n  serializeAccountInfo(serializer, value.account);\n  serializer.serializeStr(JSON.stringify(value.input));\n  serializeSignature(serializer, value.signature);\n  serializer.serializeStr(value.type);\n}\n\nexport function deserializeAptosSignInOutput(deserializer: Deserializer): AptosSignInOutput {\n  return {\n    account: new AccountInfo(deserializeAccountInfo(deserializer)),\n    input: JSON.parse(deserializer.deserializeStr()),\n    signature: deserializeSignature(deserializer),\n    type: deserializer.deserializeStr(),\n  };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { AptosSignInOutput } from '@aptos-labs/wallet-standard';\nimport { makeUserResponseDeserializeFn, makeUserResponseSerializeFn, UserResponse } from '../../UserResponse';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\nimport {\n  deserializeAptosSignInOutput,\n  deserializeAptosSignInOutputV1,\n  serializeAptosSignInOutput,\n  serializeAptosSignInOutputV1,\n} from '../../shared/AptosSignInOutput';\n\nexport interface SignInResponse extends WalletResponseWithArgs<SignInResponse.Args> {}\n\nexport namespace SignInResponse {\n  export const supportedVersions = [1, 2] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n\n  export const currentVersion = 2 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region ApprovalArgs\n\n  export interface ApprovalArgsV1 extends AptosSignInOutput {\n    plainText: string;\n    signingMessage: Uint8Array;\n  }\n\n  export interface ApprovalArgs extends AptosSignInOutput {}\n\n  function serializeApprovalArgsV1(serializer: Serializer, value: ApprovalArgsV1) {\n    serializeAptosSignInOutputV1(serializer, value);\n  }\n\n  function deserializeApprovalArgsV1(deserializer: Deserializer): ApprovalArgsV1 {\n    return deserializeAptosSignInOutputV1(deserializer);\n  }\n\n  function serializeApprovalArgs(serializer: Serializer, value: ApprovalArgs) {\n    serializeAptosSignInOutput(serializer, value);\n  }\n\n  function deserializeApprovalArgs(deserializer: Deserializer): ApprovalArgs {\n    return deserializeAptosSignInOutput(deserializer);\n  }\n\n  // endregion\n\n  // region ResponseArgs\n\n  export type Args = UserResponse<ApprovalArgs>;\n\n  const serializeArgsV1 = makeUserResponseSerializeFn(serializeApprovalArgsV1);\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n\n  const deserializeArgsV1 = makeUserResponseDeserializeFn(deserializeApprovalArgsV1);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n\n  // endregion\n\n  type _Response = SignInResponse;\n\n  export function serialize(args: Args, version: SupportedVersions = currentVersion): SerializedWalletResponse {\n    return serializeWalletResponse(args as any, version === 1 ? serializeArgsV1 : serializeArgs);\n  }\n\n  export function deserialize(\n    serializedResponse: SerializedWalletResponse,\n    version: SupportedVersions = currentVersion,\n  ): _Response {\n    return deserializeWalletResponse(serializedResponse, version === 1 ? deserializeArgsV1 : deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequest,\n  SerializedWalletRequest,\n  serializeWalletRequest,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface GetConnectedAccountsRequest\n  extends WalletRequest<GetConnectedAccountsRequest.RequestName, GetConnectedAccountsRequest.CurrentVersion> {}\n\nexport namespace GetConnectedAccountsRequest {\n  export const name = 'getConnectedAccounts' as const;\n  export type RequestName = typeof name;\n\n  export const currentVersion = 1 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  export function serialize(dappInfo: DappInfo): SerializedWalletRequest<RequestName, CurrentVersion> {\n    return serializeWalletRequest({ dappInfo, name, version: currentVersion });\n  }\n\n  export function deserialize(\n    request: SerializedWalletRequest<RequestName, CurrentVersion>,\n  ): GetConnectedAccountsRequest {\n    return deserializeWalletRequest(request);\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, CurrentVersion> {\n    return request.name === name && request.version === currentVersion;\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { type AccountInfo, deserializeAccountInfo, serializeAccountInfo } from '../../shared';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface GetConnectedAccountsResponse extends WalletResponseWithArgs<GetConnectedAccountsResponse.Args> {}\n\nexport namespace GetConnectedAccountsResponse {\n  // region Args\n\n  export type Args = AccountInfo[];\n\n  function serializeArgs(serializer: Serializer, args: Args) {\n    serializer.serializeU32AsUleb128(args.length);\n    for (const account of args) {\n      serializeAccountInfo(serializer, account);\n    }\n  }\n\n  function deserializeArgs(deserializer: Deserializer): Args {\n    const length = deserializer.deserializeUleb128AsU32();\n\n    const accounts: AccountInfo[] = [];\n    for (let i = 0; i < length; i += 1) {\n      accounts.push(deserializeAccountInfo(deserializer));\n    }\n\n    return accounts;\n  }\n\n  // endregion\n\n  type _Response = GetConnectedAccountsResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequest,\n  SerializedWalletRequest,\n  serializeWalletRequest,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface IsConnectedRequest\n  extends WalletRequest<IsConnectedRequest.RequestName, IsConnectedRequest.CurrentVersion> {}\n\nexport namespace IsConnectedRequest {\n  export const name = 'isConnected' as const;\n  export type RequestName = typeof name;\n\n  export const currentVersion = 1 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  export function serialize(dappInfo: DappInfo): SerializedWalletRequest<RequestName, CurrentVersion> {\n    return serializeWalletRequest({ dappInfo, name, version: currentVersion });\n  }\n\n  export function deserialize(request: SerializedWalletRequest<RequestName, CurrentVersion>): IsConnectedRequest {\n    return deserializeWalletRequest(request);\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, CurrentVersion> {\n    return request.name === name && request.version === currentVersion;\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface IsConnectedResponse extends WalletResponseWithArgs<IsConnectedResponse.Args> {}\n\nexport namespace IsConnectedResponse {\n  // region Args\n\n  export type Args = boolean;\n\n  function serializeArgs(serializer: Serializer, value: Args) {\n    serializer.serializeBool(value);\n  }\n\n  function deserializeArgs(deserializer: Deserializer): Args {\n    return deserializer.deserializeBool();\n  }\n\n  // endregion\n\n  type _Response = IsConnectedResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  Deserializer,\n  InputGenerateTransactionPayloadData,\n  Network,\n  Serializer,\n  TransactionPayload,\n} from '@aptos-labs/ts-sdk';\nimport { isSupportedNetwork } from '../../helpers';\nimport {\n  AccountAuthenticatorInput,\n  DappInfo,\n  deserializeAccountAuthenticatorInput,\n  deserializeTransactionPayloadInput,\n  serializeAccountAuthenticatorInput,\n  serializeTransactionPayloadInput,\n} from '../../shared';\nimport {\n  deserializeWalletRequestWithArgs,\n  SerializedWalletRequest,\n  serializeWalletRequestWithArgs,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface SignAndSubmitTransactionRequest\n  extends WalletRequest<\n    SignAndSubmitTransactionRequest.RequestName,\n    SignAndSubmitTransactionRequest.SupportedVersions\n  > {\n  args: SignAndSubmitTransactionRequest.Args;\n}\n\nexport namespace SignAndSubmitTransactionRequest {\n  export const name = 'signAndSubmitTransaction' as const;\n  export type RequestName = typeof name;\n\n  export const supportedVersions = [1, 2, 3] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n  export const currentVersion = 3 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region Args\n\n  export interface Args {\n    expirationTimestamp?: number;\n    feePayer?: AccountAuthenticatorInput;\n    gasUnitPrice?: number;\n    maxGasAmount?: number;\n    network?: Network;\n    payload: TransactionPayload | InputGenerateTransactionPayloadData;\n    signerAddress?: AccountAddress;\n  }\n\n  export function serializeArgs(serializer: Serializer, value: Args) {\n    if (value.network !== undefined && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n\n    serializer.serializeBool(value.signerAddress !== undefined);\n    if (value.signerAddress !== undefined) {\n      serializer.serialize(value.signerAddress);\n    }\n\n    serializer.serializeOptionStr(value.network);\n\n    if ('bcsToBytes' in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n    serializer.serializeU32AsUleb128(value.feePayer ? 1 : 0);\n    if (value.feePayer) {\n      serializeAccountAuthenticatorInput(serializer, value.feePayer);\n    }\n  }\n\n  export function deserializeArgs(deserializer: Deserializer, version: SupportedVersions): Args {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(AccountAddress) : undefined;\n\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOption('string');\n    if (network !== undefined && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n\n    const isPayloadBcsSerializable = version === 1 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable\n      ? deserializer.deserialize(TransactionPayload)\n      : deserializeTransactionPayloadInput(deserializer);\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeUleb128AsU32();\n    const feePayer = hasFeePayer ? deserializeAccountAuthenticatorInput(deserializer) : undefined;\n\n    return {\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : undefined,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : undefined,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : undefined,\n      network,\n      payload,\n      signerAddress,\n    };\n  }\n\n  // endregion\n\n  // region Request\n\n  export function serialize(dappInfo: DappInfo, args: Args): SerializedWalletRequest<RequestName, CurrentVersion> {\n    const request = { args, dappInfo, name, version: currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n\n  export function deserialize(\n    serializedRequest: SerializedWalletRequest<RequestName, SupportedVersions>,\n  ): SignAndSubmitTransactionRequest {\n    return deserializeWalletRequestWithArgs(serializedRequest, (deserializer) =>\n      deserializeArgs(deserializer, serializedRequest.version),\n    );\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, SupportedVersions> {\n    return request.name === name && supportedVersions.includes(request.version as SupportedVersions);\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { makeUserResponseDeserializeFn, makeUserResponseSerializeFn, UserResponse } from '../../UserResponse';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface SignAndSubmitTransactionResponse\n  extends WalletResponseWithArgs<SignAndSubmitTransactionResponse.Args> {}\n\nexport namespace SignAndSubmitTransactionResponse {\n  // region ApprovalArgs\n\n  export interface ApprovalArgs {\n    txnHash: string;\n  }\n\n  function serializeApprovalArgs(serializer: Serializer, value: ApprovalArgs) {\n    serializer.serializeStr(value.txnHash);\n  }\n\n  function deserializeApprovalArgs(deserializer: Deserializer): ApprovalArgs {\n    const txnHash = deserializer.deserializeStr();\n    return { txnHash };\n  }\n\n  // endregion\n\n  // region ResponseArgs\n\n  export type Args = UserResponse<ApprovalArgs>;\n\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n\n  // endregion\n\n  type _Response = SignAndSubmitTransactionResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { AccountAddress, Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { DappInfo } from '../../shared';\nimport {\n  deserializeWalletRequestWithArgs,\n  SerializedWalletRequest,\n  serializeWalletRequestWithArgs,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface SignMessageRequest\n  extends WalletRequest<SignMessageRequest.RequestName, SignMessageRequest.SupportedVersions> {\n  args: SignMessageRequest.Args;\n}\n\nexport namespace SignMessageRequest {\n  export const name = 'signMessage' as const;\n  export type RequestName = typeof name;\n\n  export const supportedVersions = [1, 2] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n  export const currentVersion = 2 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region Args\n\n  export interface Args {\n    chainId: number;\n    message: Uint8Array;\n    nonce: Uint8Array;\n    signerAddress?: AccountAddress;\n  }\n\n  function serializeArgs(serializer: Serializer, value: Args) {\n    serializer.serializeBool(value.signerAddress !== undefined);\n    if (value.signerAddress !== undefined) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeU8(value.chainId);\n    serializer.serializeBytes(value.nonce);\n    serializer.serializeBytes(value.message);\n  }\n\n  function deserializeArgs(deserializer: Deserializer, version: SupportedVersions): Args {\n    const hasSignerAddress = version >= 2 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(AccountAddress) : undefined;\n    const chainId = deserializer.deserializeU8();\n    const nonce = deserializer.deserializeBytes();\n    const message = deserializer.deserializeBytes();\n    return { chainId, message, nonce, signerAddress };\n  }\n\n  // endregion\n\n  // region Request\n\n  export function serialize(dappInfo: DappInfo, args: Args): SerializedWalletRequest<RequestName, CurrentVersion> {\n    const request = { args, dappInfo, name, version: currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n\n  export function deserialize(\n    serializedRequest: SerializedWalletRequest<RequestName, SupportedVersions>,\n  ): SignMessageRequest {\n    return deserializeWalletRequestWithArgs(serializedRequest, (d) => deserializeArgs(d, serializedRequest.version));\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, SupportedVersions> {\n    return request.name === name && request.version === currentVersion;\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { Deserializer, Serializer, Signature } from '@aptos-labs/ts-sdk';\nimport { deserializeSignature, serializeSignature } from '../../shared';\nimport { makeUserResponseDeserializeFn, makeUserResponseSerializeFn, UserResponse } from '../../UserResponse';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface SignMessageResponse extends WalletResponseWithArgs<SignMessageResponse.Args> {}\n\nexport namespace SignMessageResponse {\n  // region ApprovalArgs\n\n  export interface ApprovalArgs {\n    // Should return message parts\n    fullMessage: string;\n    signature: Signature;\n  }\n\n  function serializeApprovalArgs(serializer: Serializer, value: ApprovalArgs) {\n    serializer.serializeStr(value.fullMessage);\n    serializeSignature(serializer, value.signature);\n  }\n\n  function deserializeApprovalArgs(deserializer: Deserializer): ApprovalArgs {\n    const fullMessage = deserializer.deserializeStr();\n    const signature = deserializeSignature(deserializer);\n    return { fullMessage, signature };\n  }\n\n  // endregion\n\n  // region ResponseArgs\n\n  export type Args = UserResponse<ApprovalArgs>;\n\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n\n  // endregion\n\n  type _Response = SignMessageResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport {\n  AccountAddress,\n  Deserializer,\n  InputGenerateTransactionPayloadData,\n  Network,\n  PublicKey,\n  RawTransaction,\n  Serializer,\n  TransactionPayload,\n} from '@aptos-labs/ts-sdk';\nimport { chainIdToNetwork, isSupportedNetwork } from '../../helpers';\nimport {\n  AccountInput,\n  DappInfo,\n  deserializeAccountInput,\n  deserializeTransactionPayloadInput,\n  serializeAccountInput,\n  serializeTransactionPayloadInput,\n} from '../../shared';\nimport {\n  deserializeWalletRequestWithArgs,\n  SerializedWalletRequest,\n  serializeWalletRequestWithArgs,\n  WalletRequest,\n} from '../../WalletRequest';\n\nexport interface SignTransactionRequest\n  extends WalletRequest<SignTransactionRequest.RequestName, SignTransactionRequest.SupportedVersions> {\n  args: SignTransactionRequest.Args;\n}\n\nexport namespace SignTransactionRequest {\n  export const name = 'signTransaction' as const;\n  export type RequestName = typeof name;\n\n  export const supportedVersions = [1, 2, 3, 4] as const;\n  export type SupportedVersions = (typeof supportedVersions)[number];\n  export const currentVersion = 4 as const;\n  export type CurrentVersion = typeof currentVersion;\n\n  // region Args\n\n  export interface Args {\n    expirationSecondsFromNow?: number;\n    expirationTimestamp?: number;\n    feePayer?: AccountInput;\n    gasUnitPrice?: number;\n    maxGasAmount?: number;\n    network?: Network;\n    payload: TransactionPayload | InputGenerateTransactionPayloadData;\n    secondarySigners?: AccountInput[];\n    sender?: AccountInput;\n    sequenceNumber?: number | bigint;\n    signerAddress?: AccountAddress;\n  }\n\n  export interface ArgsWithTransaction {\n    feePayer?: AccountInput;\n    secondarySigners?: AccountInput[];\n    senderPublicKey?: PublicKey;\n    signerAddress?: AccountAddress;\n    transaction: RawTransaction;\n  }\n\n  export function normalizeArgs(args: ArgsWithTransaction): Args {\n    const { feePayer, secondarySigners, senderPublicKey, signerAddress, transaction } = args;\n\n    const sender: AccountInput = {\n      address: transaction.sender,\n      publicKey: senderPublicKey,\n    };\n\n    const network = chainIdToNetwork(args.transaction.chain_id.chainId);\n\n    return {\n      expirationTimestamp: Number(transaction.expiration_timestamp_secs),\n      feePayer,\n      gasUnitPrice: Number(transaction.gas_unit_price),\n      maxGasAmount: Number(transaction.max_gas_amount),\n      network,\n      payload: transaction.payload,\n      secondarySigners,\n      sender,\n      signerAddress,\n    };\n  }\n\n  function serializeArgs(serializer: Serializer, value: Args) {\n    if (value.network !== undefined && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n\n    serializer.serializeBool(value.signerAddress !== undefined);\n    if (value.signerAddress !== undefined) {\n      serializer.serialize(value.signerAddress);\n    }\n\n    serializer.serializeOptionStr(value.network);\n    serializer.serializeBool(value.sender !== undefined);\n    if (value.sender !== undefined) {\n      serializeAccountInput(serializer, value.sender);\n    }\n\n    if ('bcsToBytes' in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n\n    serializer.serializeU32AsUleb128(value.expirationSecondsFromNow ?? 0);\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n\n    serializer.serializeBool(value.feePayer !== undefined);\n    if (value.feePayer !== undefined) {\n      serializeAccountInput(serializer, value.feePayer);\n    }\n\n    const secondarySigners = value.secondarySigners ?? [];\n    serializer.serializeU32AsUleb128(secondarySigners.length);\n    for (const signer of secondarySigners) {\n      serializeAccountInput(serializer, signer);\n    }\n  }\n\n  function deserializeArgs(deserializer: Deserializer, version: SupportedVersions): Args {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(AccountAddress) : undefined;\n\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOption('string');\n    if (network !== undefined && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n\n    const hasSender = deserializer.deserializeBool();\n    const sender = hasSender ? deserializeAccountInput(deserializer) : undefined;\n\n    const isPayloadBcsSerializable = version < 4 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable\n      ? deserializer.deserialize(TransactionPayload)\n      : deserializeTransactionPayloadInput(deserializer);\n\n    const expirationSecondsFromNow = deserializer.deserializeUleb128AsU32();\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeBool();\n    const feePayer = hasFeePayer ? deserializeAccountInput(deserializer) : undefined;\n\n    const secondarySignersLength = deserializer.deserializeUleb128AsU32();\n    const secondarySigners: AccountInput[] = [];\n    for (let i = 0; i < secondarySignersLength; i += 1) {\n      secondarySigners.push(deserializeAccountInput(deserializer));\n    }\n\n    return {\n      expirationSecondsFromNow: expirationSecondsFromNow > 0 ? expirationSecondsFromNow : undefined,\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : undefined,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : undefined,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : undefined,\n      network,\n      payload,\n      secondarySigners,\n      sender,\n      signerAddress,\n    };\n  }\n\n  // endregion\n\n  // region Request\n\n  export function serialize(dappInfo: DappInfo, args: Args): SerializedWalletRequest<RequestName, CurrentVersion> {\n    const request = { args, dappInfo, name, version: currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n\n  export function deserialize(\n    serializedRequest: SerializedWalletRequest<RequestName, SupportedVersions>,\n  ): SignTransactionRequest {\n    return deserializeWalletRequestWithArgs(serializedRequest, (deserializer) =>\n      deserializeArgs(deserializer, serializedRequest.version),\n    );\n  }\n\n  export function isSerialized(\n    request: SerializedWalletRequest,\n  ): request is SerializedWalletRequest<RequestName, SupportedVersions> {\n    return request.name === name && supportedVersions.includes(request.version as SupportedVersions);\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-inner-declarations */\n\nimport { AccountAuthenticator, Deserializer, RawTransaction, Serializer } from '@aptos-labs/ts-sdk';\nimport { makeUserResponseDeserializeFn, makeUserResponseSerializeFn, UserResponse } from '../../UserResponse';\nimport {\n  deserializeWalletResponse,\n  SerializedWalletResponse,\n  serializeWalletResponse,\n  WalletResponseWithArgs,\n} from '../../WalletResponse';\n\nexport interface SignTransactionResponse extends WalletResponseWithArgs<SignTransactionResponse.Args> {}\n\nexport namespace SignTransactionResponse {\n  // region ApprovalArgs\n\n  export interface ApprovalArgs {\n    authenticator: AccountAuthenticator;\n    rawTransaction?: RawTransaction;\n  }\n\n  function serializeApprovalArgs(serializer: Serializer, value: ApprovalArgs) {\n    serializer.serialize(value.authenticator);\n    serializer.serializeBool(value.rawTransaction !== undefined);\n    if (value.rawTransaction !== undefined) {\n      serializer.serialize(value.rawTransaction);\n    }\n  }\n\n  function deserializeApprovalArgs(deserializer: Deserializer): ApprovalArgs {\n    const authenticator = deserializer.deserialize(AccountAuthenticator);\n    const hasRawTransaction = deserializer.deserializeBool();\n    const rawTransaction = hasRawTransaction ? deserializer.deserialize(RawTransaction) : undefined;\n\n    return {\n      authenticator,\n      rawTransaction,\n    };\n  }\n\n  // endregion\n\n  // region ResponseArgs\n\n  export type Args = UserResponse<ApprovalArgs>;\n\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n\n  // endregion\n\n  type _Response = SignTransactionResponse;\n\n  export function serialize(args: Args): SerializedWalletResponse {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n\n  export function deserialize(serializedResponse: SerializedWalletResponse): _Response {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport type TypedMessage<MessageType extends string = string> = { __messageType: MessageType };\nexport type TypedMessageConstructor<TMessage extends TypedMessage<MessageType>, MessageType extends string> = {\n  TYPE: MessageType;\n  new (...args: any[]): TMessage;\n};\n\nexport function isTypedMessage<TMessage extends TypedMessage<MessageType>, MessageType extends string>(\n  messageCls: TypedMessageConstructor<TMessage, MessageType>,\n  message: any,\n): message is TMessage {\n  return message?.__messageType === messageCls.TYPE;\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Serializer } from '@aptos-labs/ts-sdk';\nimport { base64ToBytes, bytesToBase64 } from '../base64';\nimport { SerializedWalletRequest } from '../WalletRequest';\nimport { SerializedWalletResponse } from '../WalletResponse';\nimport { TypedMessage } from './common';\n\nexport class PromptConnectionRequestMessage implements TypedMessage {\n  static readonly TYPE = 'PromptConnectionRequest';\n  readonly __messageType = PromptConnectionRequestMessage.TYPE;\n}\n\nexport class PromptConnectionResponseMessage implements TypedMessage {\n  static readonly TYPE = 'PromptConnectionResponse';\n  readonly __messageType = PromptConnectionResponseMessage.TYPE;\n\n  constructor(public serializedRequest: SerializedWalletRequest) {}\n}\n\nexport class PromptApprovalResponseMessage implements TypedMessage {\n  static readonly TYPE = 'PromptApprovalResponse';\n  readonly __messageType = PromptApprovalResponseMessage.TYPE;\n\n  constructor(public serializedValue: SerializedWalletResponse) {}\n}\n\nexport class PromptUnauthorizedErrorMessage implements TypedMessage {\n  static readonly TYPE = 'PromptUnauthorizedError';\n  readonly __messageType = PromptUnauthorizedErrorMessage.TYPE;\n}\n\nexport function urlEncodeWalletRequest(request: SerializedWalletRequest) {\n  const serializer = new Serializer();\n  serializer.serializeStr(request.name);\n  serializer.serializeBytes(request.data);\n  serializer.serializeStr(request.version.toString());\n  return bytesToBase64(serializer.toUint8Array());\n}\n\nexport function urlDecodeWalletRequest(encodedRequest: string): SerializedWalletRequest {\n  const deserializer = new Deserializer(base64ToBytes(encodedRequest));\n  const name = deserializer.deserializeStr();\n  const data = deserializer.deserializeBytes();\n\n  let version: number;\n  try {\n    version = Number(deserializer.deserializeStr());\n  } catch {\n    version = 1;\n  }\n  return { data, name, version };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  AccountAddressInput,\n  Ed25519PublicKey,\n  Ed25519Signature,\n  Serializer,\n} from '@aptos-labs/ts-sdk';\nimport { base64ToBytes, base64urlToBytes, bytesToBase64, bytesToBase64url } from './base64';\nimport { decodeWalletRequestBody, encodeWalletRequestBody, type WalletRequestBody } from './WalletRequestBody';\n\nexport interface UnsignedPopupWalletRequest {\n  accountAddress?: AccountAddressInput;\n  body: WalletRequestBody;\n  clientIdentityKey?: undefined;\n}\n\nexport interface BaseSignedPopupWalletRequest {\n  accountAddress?: AccountAddressInput;\n  clientIdentityKey: Ed25519PublicKey;\n  id: string;\n  // against ('AptosConnectWalletRequest', id, body, address, timestamp)\n  signature: Ed25519Signature;\n  timestamp: number;\n}\n\nexport interface DeferredSignedPopupWalletRequest extends BaseSignedPopupWalletRequest {\n  body?: undefined;\n}\n\nexport interface SignedPopupWalletRequest extends BaseSignedPopupWalletRequest {\n  body: WalletRequestBody;\n}\n\nexport type PopupWalletRequest =\n  | UnsignedPopupWalletRequest\n  | DeferredSignedPopupWalletRequest\n  | SignedPopupWalletRequest;\n\nexport function encodePopupWalletRequest(request: PopupWalletRequest): string {\n  const serialized = JSON.stringify(request, (key, value) => {\n    switch (key) {\n      case 'body':\n        return encodeWalletRequestBody(value);\n      case 'clientIdentityKey':\n        return bytesToBase64((value as Ed25519PublicKey).toUint8Array());\n      case 'signature':\n        return bytesToBase64((value as Ed25519Signature).toUint8Array());\n      default:\n        return value;\n    }\n  });\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64url(utf8Encoded);\n}\n\nexport function decodePopupWalletRequest(encoded: string): PopupWalletRequest {\n  const utfEncoded = base64urlToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => {\n    switch (key) {\n      case 'body':\n        return decodeWalletRequestBody(value);\n      case 'clientIdentityKey':\n        return new Ed25519PublicKey(base64ToBytes(value));\n      case 'signature':\n        return new Ed25519Signature(base64ToBytes(value));\n      default:\n        return value;\n    }\n  });\n}\n\nexport function makePopupWalletRequestChallenge({\n  accountAddress,\n  body,\n  id,\n  timestamp,\n}: Omit<SignedPopupWalletRequest, 'clientIdentityKey' | 'signature'>) {\n  const serializer = new Serializer();\n  serializer.serializeStr('SignedPopupWalletRequest');\n  serializer.serializeStr(id);\n  serializer.serializeU64(timestamp);\n  serializer.serializeBool(accountAddress !== undefined);\n  if (accountAddress !== undefined) {\n    serializer.serialize(AccountAddress.from(accountAddress));\n  }\n  serializer.serializeStr(body.name);\n  serializer.serializeU8(body.version);\n  serializer.serializeBytes(body.data);\n  return serializer.toUint8Array();\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { base64ToBytes, bytesToBase64 } from './base64';\n\nexport interface WalletRequestBody<RequestName extends string = string, Version extends number = number> {\n  data: Uint8Array;\n  name: RequestName;\n  version: Version;\n}\n\nexport function encodeWalletRequestBody({ data, ...rest }: WalletRequestBody): string {\n  const serialized = JSON.stringify({ data, ...rest }, (key, value) => (key === 'data' ? bytesToBase64(value) : value));\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64(utf8Encoded);\n}\n\nexport function decodeWalletRequestBody(encoded: string): WalletRequestBody {\n  const utfEncoded = base64ToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => (key === 'data' ? base64ToBytes(value) : value));\n}\n"],"names":["Deserializer","Serializer","AccountAddress","AccountAddress","AccountAddress","AccountAddress","AccountAddress","EntryFunctionArgumentVariant","SigningScheme","AccountAddress","TransactionPayloadInputVariant","AccountAddress","Serializer","Deserializer","ConnectRequest","Deserializer","Serializer","ConnectResponse","DisconnectRequest","DisconnectResponse","SignInRequest","SignInResponse","GetConnectedAccountsRequest","GetConnectedAccountsResponse","IsConnectedRequest","IsConnectedResponse","AccountAddress","SignAndSubmitTransactionRequest","AccountAddress","SignAndSubmitTransactionResponse","AccountAddress","SignMessageRequest","AccountAddress","SignMessageResponse","AccountAddress","TransactionPayload","SignTransactionRequest","AccountAddress","TransactionPayload","AccountAuthenticator","RawTransaction","SignTransactionResponse","AccountAuthenticator","RawTransaction","Deserializer","Serializer","Serializer","Deserializer","AccountAddress","Ed25519PublicKey","Ed25519Signature","Serializer","Ed25519PublicKey","Ed25519Signature","Serializer","AccountAddress"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],"debugId":null}},
    {"offset": {"line": 1369, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/encrDecr.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/errors.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/utils.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/securedEnvelope.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/serialization.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/crypto/src/walletAccounts.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Ed25519Signature, PublicKey, Signature } from '@aptos-labs/ts-sdk';\nimport { sha3_256 } from '@noble/hashes/sha3';\nimport nacl from 'tweetnacl';\nimport ed2curve from 'ed2curve';\nimport { DecryptionError } from './errors';\nimport {\n  concatUint8array,\n  decodeBase64,\n  Ed25519PublicKey,\n  Ed25519SecretKey,\n  encodeBase64,\n  KeyTypes,\n  toKey,\n  X25519PublicKey,\n  X25519SecretKey,\n} from './utils';\n\n// This callback takes in a message bytes, and signs it.\n// THIS DOES NOT PERFORM DOMAIN SEPARATION: IT IS ASSUMED OUR LIBRARY ALREADY DID IT.\n// This is to support hardware wallets.\nexport type SignCallback = (message: Uint8Array) => Promise<Signature>;\n\nexport type SignaturePurpose = 'TRANSPORT_KEYPAIR' | 'ACCOUNT_INFO' | 'SECURED_ENVELOPE';\n\nexport const SIGNATURE_PREFIX = 'APTOS::IDENTITY_CONNECT';\n\nexport type EncryptionResult = {\n  nonce: Uint8Array;\n  secured: Uint8Array;\n};\n\nexport type SerializedEncryptionResult = {\n  nonceB64: string;\n  securedB64: string;\n};\n\n/**\n * Converts an Ed25519 public key to an X25519 public key\n * HERE THERE BE DRAGONS. ONLY USE THIS IF YOU KNOW WHAT YOU ARE DOING.\n * @param ed25519PublicKey The Ed25519 public key to convert\n * @param errorKeyName The name of the key to use in error messages\n */\nexport function convertEd25519PublicKeyToX25519PublicKey(\n  ed25519PublicKey: Ed25519PublicKey,\n  errorKeyName: string,\n): X25519PublicKey {\n  const x25519PublicKey = ed2curve.convertPublicKey(ed25519PublicKey.key.slice(0, 32));\n  if (!x25519PublicKey) throw new Error(`${errorKeyName} is not a valid Ed25519 public key`);\n  return toKey(x25519PublicKey, KeyTypes.X25519PublicKey);\n}\n\n/**\n * Converts an Ed25519 secret key to an X25519 secret key\n * HERE THERE BE DRAGONS. ONLY USE THIS IF YOU KNOW WHAT YOU ARE DOING.\n * @param ed25519SecretKey The Ed25519 secret key to convert\n */\nexport function convertEd25519SecretKeyToX25519SecretKey(ed25519SecretKey: Ed25519SecretKey): X25519SecretKey {\n  const x25519SecretKey = ed2curve.convertSecretKey(ed25519SecretKey.key.slice(0, 32));\n  return toKey(x25519SecretKey, KeyTypes.X25519SecretKey);\n}\nexport function serializeEncryptionResult(enc: EncryptionResult): SerializedEncryptionResult {\n  return {\n    nonceB64: encodeBase64(enc.nonce),\n    securedB64: encodeBase64(enc.secured),\n  };\n}\n\nexport function deserializeEncryptionResult(enc: SerializedEncryptionResult): EncryptionResult {\n  return {\n    nonce: decodeBase64(enc.nonceB64),\n    secured: decodeBase64(enc.securedB64),\n  };\n}\n\n/**\n * Decrypts a `SerializedEncryptionResult` to an object\n * Uses the sender's X25519 public key and receiver's Ed25519 secret key\n * The receivers Ed25519 secret key is converted to an X25519 secret key for the Diffie-Hellman key exchange\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverEd25519SecretKey The receiver's Ed25519 secret key\n * @param enc The serialized encryption result\n */\nexport function decryptSerializedEncryptionResult<T>(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverEd25519SecretKey: Ed25519SecretKey,\n  enc: SerializedEncryptionResult,\n): T {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObject<T>(senderX25519PublicKey, receiverEd25519SecretKey, des.secured, des.nonce);\n}\n\n/**\n * Decrypts a `SerializedEncryptionResult` to an object\n * Uses the sender's X25519 public key and receiver's X25519 secret key\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverX25519SecretKey The receiver's X25519 secret key\n * @param enc The serialized encryption result\n */\nexport function decryptSerializedEncryptionResultDirect<T>(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverX25519SecretKey: X25519SecretKey,\n  enc: SerializedEncryptionResult,\n): T {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObjectDirect<T>(senderX25519PublicKey, receiverX25519SecretKey, des.secured, des.nonce);\n}\n\n/**\n * Encrypts a string, by using the sender's X25519 secret key and receiver's Ed25519 public key\n * The receiver's Ed25519 public key is converted to an X25519 public key for the Diffie-Hellman key exchange\n * @param senderX25519SecretKey The sender's X25519 secret key\n * @param receiverEd25519PublicKey The receiver's Ed25519 public key\n * @param message The message to encrypt\n */\nexport function encryptMessage(\n  senderX25519SecretKey: X25519SecretKey,\n  receiverEd25519PublicKey: Ed25519PublicKey,\n  message: string,\n): EncryptionResult {\n  // Encrypt the message with the receiver's public key and sender's secret key\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    'receiver public key',\n  );\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\n\n/**\n * Encrypts a string, by using the sender's X25519 secret key and receiver's X25519 public key\n * @param senderX25519SecretKey The sender's X25519 secret key\n * @param receiverX25519PublicKey The receiver's X25519 public key\n * @param message The message to encrypt\n */\nexport function encryptMessageDirect(\n  senderX25519SecretKey: X25519SecretKey,\n  receiverX25519PublicKey: X25519PublicKey,\n  message: string,\n): EncryptionResult {\n  // Generate a random nonce\n  const nonce = nacl.randomBytes(nacl.box.nonceLength);\n\n  // Convert the message to a Uint8Array\n  const messageUint8 = new TextEncoder().encode(message);\n\n  const secured = nacl.box(messageUint8, nonce, receiverX25519PublicKey.key, senderX25519SecretKey.key.slice(0, 32));\n\n  return { nonce, secured };\n}\n\n/**\n * Encrypts an object to a string, by using the sender's X25519 secret key and receiver's Ed25519 public key\n * The receiver's Ed25519 public key is converted to an X25519 public key for the Diffie-Hellman key exchange\n * @param senderX25519SecretKey The sender's X25519 secret key\n * @param receiverEd25519PublicKey The receiver's Ed25519 public key\n * @param message The message to encrypt\n */\nexport function encryptObject<T>(\n  senderX25519SecretKey: X25519SecretKey,\n  receiverEd25519PublicKey: Ed25519PublicKey,\n  message: T,\n): EncryptionResult {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    'receiver public key',\n  );\n  return encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\n\n/**\n * Encrypts an object to a string, by using the sender's X25519 secret key and receiver's X25519 public key\n * @param senderX25519SecretKey The sender's X25519 secret key\n * @param receiverX25519PublicKey The receiver's X25519 public key\n * @param message The message to encrypt\n */\nexport function encryptObjectDirect<T>(\n  senderX25519SecretKey: X25519SecretKey,\n  receiverX25519PublicKey: X25519PublicKey,\n  message: T,\n): EncryptionResult {\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, JSON.stringify(message));\n}\n\n/**\n * Decrypts a string, by using the sender's X25519 public key and receiver's Ed25519 secret key\n * The receivers Ed25519 secret key is converted to an X25519 secret key for the Diffie-Hellman key exchange\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverEd25519SecretKey The receiver's Ed25519 secret key\n * @param securedMessage The message to decrypt\n * @param nonce The nonce used to encrypt the message\n */\nexport function decryptMessage(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverEd25519SecretKey: Ed25519SecretKey,\n  securedMessage: Uint8Array,\n  nonce: Uint8Array,\n): string {\n  // Decrypt the message with the receiver's secret key and sender's public key\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\n\n/**\n * Decrypts a string, by using the sender's X25519 public key and receiver's X25519 secret key\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverX25519SecretKey The receiver's X25519 secret key\n * @param securedMessage The message to decrypt\n * @param nonce The nonce used to encrypt the message\n */\nexport function decryptMessageDirect(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverX25519SecretKey: X25519SecretKey,\n  securedMessage: Uint8Array,\n  nonce: Uint8Array,\n): string {\n  let decryptedUint8;\n  try {\n    decryptedUint8 = nacl.box.open(\n      securedMessage,\n      nonce,\n      senderX25519PublicKey.key.slice(0, 32),\n      receiverX25519SecretKey.key.slice(0, 32),\n    );\n  } catch (e: any) {\n    throw new DecryptionError(`Could not decrypt message: ${e.message}`);\n  }\n  if (!decryptedUint8) throw new DecryptionError('Could not decrypt message');\n\n  // Convert the decrypted Uint8Array back to a string\n  return new TextDecoder().decode(decryptedUint8);\n}\n\n/**\n * Decrypts an object, by using the sender's X25519 public key and receiver's Ed25519 secret key\n * The receivers Ed25519 secret key is converted to an X25519 secret key for the Diffie-Hellman key exchange\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverEd25519SecretKey The receiver's Ed25519 secret key\n * @param securedMessage The message to decrypt\n * @param nonce The nonce used to encrypt the message\n */\nexport function decryptObject<T>(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverEd25519SecretKey: Ed25519SecretKey,\n  securedMessage: Uint8Array,\n  nonce: Uint8Array,\n): T {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptObjectDirect<T>(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\n\n/**\n * Decrypts an object, by using the sender's X25519 public key and receiver's X25519 secret key\n * @param senderX25519PublicKey The sender's X25519 public key\n * @param receiverX25519SecretKey The receiver's X25519 secret key\n * @param securedMessage The message to decrypt\n * @param nonce The nonce used to encrypt the message\n */\nexport function decryptObjectDirect<T>(\n  senderX25519PublicKey: X25519PublicKey,\n  receiverX25519SecretKey: X25519SecretKey,\n  securedMessage: Uint8Array,\n  nonce: Uint8Array,\n): T {\n  const decryptedStr = decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n  return JSON.parse(decryptedStr) as T;\n}\n\n/**\n * Hashes a message with a purpose-specific prefix using SHA-3 256-bit algorithm.\n * The purpose prefix is constructed as `'APTOS::IDENTITY_CONNECT' + '::' + purpose + '::'`\n * This is to prevent hash collisions with other services, uses, and purposes\n * @param message The message to hash as a Uint8Array.\n * @param purpose The purpose of the signature.\n * @returns Uint8Array The hashed message as a Uint8Array\n */\nexport function messageHash(message: Uint8Array, purpose: SignaturePurpose) {\n  const signaturePrefixHash = new Uint8Array(sha3_256(`${SIGNATURE_PREFIX}::${purpose}::`));\n  return new Uint8Array(sha3_256(concatUint8array(signaturePrefixHash, message)));\n}\n\nexport function signWithEd25519SecretKey(\n  message: Uint8Array,\n  signingEd25519SecretKey: Ed25519SecretKey,\n  purpose: SignaturePurpose,\n) {\n  return nacl.sign.detached(messageHash(message, purpose), signingEd25519SecretKey.key);\n}\n\n// This assumes that domain separation has already happened: this emulates the behavior of a hardware device\nexport function makeEd25519SecretKeySignCallbackNoDomainSeparation(\n  signingEd25519SecretKey: Ed25519SecretKey,\n): SignCallback {\n  return async (message: Uint8Array) => new Ed25519Signature(nacl.sign.detached(message, signingEd25519SecretKey.key));\n}\n\nexport function verifySignature(\n  message: Uint8Array,\n  signature: Signature,\n  signingPublicKey: PublicKey,\n  purpose: SignaturePurpose,\n): boolean {\n  return signingPublicKey.verifySignature({ message: messageHash(message, purpose), signature });\n}\n\nexport function hashAndVerifySignature(\n  message: string | Uint8Array,\n  signature: Signature,\n  signingPublicKey: PublicKey,\n  purpose: SignaturePurpose,\n): boolean {\n  const messageUint8 = message instanceof Uint8Array ? message : new TextEncoder().encode(message);\n  const messageUint8Hash = sha3_256(messageUint8);\n  return verifySignature(messageUint8Hash, signature, signingPublicKey, purpose);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport class EncryptionEnvelopeError extends Error {}\n\nexport class EnvelopeMessageMismatchError extends EncryptionEnvelopeError {\n  constructor(\n    message: string,\n    public field: string,\n  ) {\n    super(message);\n    this.name = 'EnvelopeMessageMismatchError';\n    Object.setPrototypeOf(this, EnvelopeMessageMismatchError.prototype);\n  }\n}\n\nexport class DecryptionError extends EncryptionEnvelopeError {\n  constructor(message: string) {\n    super(message);\n    this.name = 'DecryptionError';\n    Object.setPrototypeOf(this, DecryptionError.prototype);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport nacl from 'tweetnacl';\n\nexport enum KeyTypes {\n  'Ed25519PublicKey' = 'Ed25519PublicKey',\n  'Ed25519SecretKey' = 'Ed25519SecretKey',\n  'X25519PublicKey' = 'X25519PublicKey',\n  'X25519SecretKey' = 'X25519SecretKey',\n}\n\nexport interface IKey<Type extends KeyTypes> {\n  key: Uint8Array;\n  type: Type;\n}\n\nexport type X25519PublicKey = IKey<KeyTypes.X25519PublicKey>;\nexport type X25519SecretKey = IKey<KeyTypes.X25519SecretKey>;\nexport type X25519KeyPair = {\n  publicKey: X25519PublicKey;\n  secretKey: X25519SecretKey;\n};\n\nexport type Ed25519PublicKey = IKey<KeyTypes.Ed25519PublicKey>;\nexport type Ed25519SecretKey = IKey<KeyTypes.Ed25519SecretKey>;\nexport type Ed25519KeyPair = {\n  publicKey: Ed25519PublicKey;\n  secretKey: Ed25519SecretKey;\n};\n\nexport type RawKeyPair = {\n  publicKey: Uint8Array;\n  secretKey: Uint8Array;\n};\n\nexport function createX25519KeyPair(): X25519KeyPair {\n  return keypairToX25519(nacl.box.keyPair());\n}\n\nexport function createEd25519KeyPair(): Ed25519KeyPair {\n  return keypairToEd25519(nacl.sign.keyPair());\n}\n\nexport function toKey<Type extends KeyTypes = KeyTypes>(\n  rawKey: Uint8Array,\n  type: Type,\n): Type extends KeyTypes.Ed25519PublicKey\n  ? Ed25519PublicKey\n  : Type extends KeyTypes.Ed25519SecretKey\n    ? Ed25519SecretKey\n    : Type extends KeyTypes.X25519PublicKey\n      ? X25519PublicKey\n      : Type extends KeyTypes.X25519SecretKey\n        ? X25519SecretKey\n        : never {\n  return {\n    key: rawKey,\n    type,\n  } as any;\n}\n\nexport function keypairToEd25519(keyPair: RawKeyPair): Ed25519KeyPair {\n  return {\n    publicKey: toKey(keyPair.publicKey, KeyTypes.Ed25519PublicKey),\n    secretKey: toKey(keyPair.secretKey, KeyTypes.Ed25519SecretKey),\n  };\n}\n\nexport function keypairToX25519(keyPair: RawKeyPair): X25519KeyPair {\n  return {\n    publicKey: toKey(keyPair.publicKey, KeyTypes.X25519PublicKey),\n    secretKey: toKey(keyPair.secretKey, KeyTypes.X25519SecretKey),\n  };\n}\n\nexport function aptosAccountToEd25519Keypair(account: { signingKey: nacl.SignKeyPair }) {\n  return ed25519KeypairFromSecret(account.signingKey.secretKey);\n}\n\nexport function ed25519KeypairFromSecret(ed25519SecretKeyBytes: Uint8Array): Ed25519KeyPair {\n  return keypairToEd25519(nacl.sign.keyPair.fromSeed(ed25519SecretKeyBytes.slice(0, 32)));\n}\n\nexport function decodeBase64(base64Str: string): Uint8Array {\n  if (globalThis.Buffer) {\n    return new Uint8Array(Buffer.from(base64Str, 'base64'));\n  }\n  return Uint8Array.from(atob(base64Str), (m) => m.codePointAt(0)!);\n}\n\nexport function encodeBase64(bytes: Uint8Array): string {\n  if (globalThis.Buffer) {\n    return Buffer.from(bytes).toString('base64');\n  }\n  return btoa(Array.from(bytes, (x) => String.fromCodePoint(x)).join(''));\n}\n\nexport function concatUint8array(arrayOne: Uint8Array, arrayTwo: Uint8Array): Uint8Array {\n  const mergedArray = new Uint8Array(arrayOne.length + arrayTwo.length);\n  mergedArray.set(arrayOne);\n  mergedArray.set(arrayTwo, arrayOne.length);\n  return mergedArray;\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Ed25519PublicKey as AptosEd25519PublicKey, Ed25519Signature, Hex } from '@aptos-labs/ts-sdk';\nimport { sha3_256 } from '@noble/hashes/sha3';\nimport {\n  createX25519KeyPair,\n  decodeBase64,\n  Ed25519PublicKey,\n  Ed25519SecretKey,\n  encodeBase64,\n  X25519KeyPair,\n  KeyTypes,\n  toKey,\n  X25519PublicKey,\n} from './utils';\nimport { EnvelopeMessageMismatchError } from './errors';\nimport {\n  SerializedEncryptionResult,\n  SignCallback,\n  decryptObject,\n  encryptObject,\n  serializeEncryptionResult,\n  deserializeEncryptionResult,\n  verifySignature,\n  signWithEd25519SecretKey,\n} from './encrDecr';\n\n/**\n * When sending messages back and forth, there are some things that Identity Connect must know to function and provide\n * security for users, and dApps and wallets need to know that any messages sent to one another were sent (and\n * received) by the expected parties.\n *\n * To allow for secure communication between parties, we are introducing the\n * *SecuredEnvelope*. This envelope provides a secure channel for parties to encrypt private messages, *and*\n * authenticate one another, while allowing IC to route requests and block invalid messages.\n *\n * The envelope can be thought of as a wrapper around the JSON payload of a POST/PUT request T, and has two parts:\n * `messagePrivate`: This contains some of the parameters of `T`, which will be signed by the sender and encrypted\n *                   with the recipient's public key.\n * `publicMessage`: This field is sent unencrypted, but signed so that the IC endpoint can do basic validation before\n *                  processing. The parameters in `publicMessage` are DISJOINT from `messagePrivate`, and are invalid\n *                  otherwise: there are no keys in `messagePrivate` that also appear in `publicMessage`. It must\n *                  contain a ``_metadata`` field with security features like the timestamp, public keys, sequence\n *                  number, etc.\n *\n * Both IC and dApps can verify, on chain, that the senders’ keys match their address and that they are speaking\n * with who they expect. Encryption is done with an X25519 key derived from the ED25519 PublicKey of the wallet\n * account that is connecting (this allows for seamless cross-device account access), and an ephemeral X25519 KeyPair,\n * of which the SecretKey is thrown away after encryption. Decryption uses the X25519 key derived from the receiver\n * ED25519 SecretKey.\n *\n * Account private keys Ska (and their counterpart X25519 keys) are only used to decrypt and sign:\n * THEY ARE NEVER USED TO ENCRYPT!\n *\n * Operations follow the Cryptographic Doom Principle:\n *   Always verify the signature of the message before any other cryptographic operations\n * https://moxie.org/2011/12/13/the-cryptographic-doom-principle.html\n *\n *\n * To send a `SecuredEnvelope` over the wire, it must first be turned into a `SecuredEnvelopeTransport` - this\n * involves:\n * 1. Encrypting and serializing the `privateMessage` field to an `encryptedPrivateMessage`field.\n *     a. Generate ephemeral X25519 sender keypair `xPkse/xSkse`. The `xPkse` becomes the `senderX25519PublicKeyB64` in\n *      the `EnvelopeMetadata`.\n *     b. Convert the `receiverEd25519PublicKey` to a `receiverX25519PublicKey` - `xPkr`\n *     c. Generate a random `nonce` for the `[nacl.box](http://nacl.box)` encryption\n *     d. Encrypt the `privateMessage` using `[nacl.box](http://nacl.box)` with the `xSkse` and `xPkr`\n *     e. Package this encrypted data, and the `nonce`, into a `SerializedEncryptionResult`\n * 2. JSON serializing the `publicMessage` field into a `serializedPublicMessage`. We don’t care about canonical\n *    serialization/ordering as the sender signs over this serialized string.\n * 3.  Now that we have the private `encryptedPrivateMessage` and public `serializedPublicMessage` we can generate the\n *    `messageSignature`:\n *     a. Hash the `SHA3-256(encryptedPublicMessage)` to get `publicMessageHash`\n *     b. Hash the `SHA3-256(encryptedPrivateMessage)` to get `privateMessageHash`\n *     c. Hash `SHA3-256(publicMessageHash | privateMessageHash)` to get `combinedMessageHash`\n *     d. Get the `domainSeparatedMessageHash` by hashing the `combinedMessageHash` with a domain separator:\n *        `SHA3-256(SHA3-256('APTOS::IDENTITY_CONNECT::') | combinedMessageHash)`\n *     e. To obtain the final `messageSignature`, we sign the `domainSeparatedMessageHash` with the Ed25519 private\n *        key of the sender, and hex encode it.\n * 4. This creates the final `SecuredEnvelopeTransport` object, ready to be JSON serialized and sent in an HTTP\n *    request\n */\n\nexport const REQUIRED_FIELDS: (keyof EnvelopeMetadata)[] = [\n  'receiverEd25519PublicKeyB64',\n  'senderEd25519PublicKeyB64',\n  'senderX25519PublicKeyB64',\n  'sequence',\n  'timestampMillis',\n].sort() as (keyof EnvelopeMetadata)[];\n\n// The publicMessage._metadata field looks like this:\nexport type EnvelopeMetadata = {\n  // The receiver's public key, base64\n  receiverEd25519PublicKeyB64: string;\n  // The sender public key, base64\n  senderEd25519PublicKeyB64: string;\n  // The senders X25519 public key, base64\n  senderX25519PublicKeyB64: string;\n  // The sequence of the sender.\n  // This number only goes up, to prevent relay attacks\n  // This exists per pairing\n  // dApps, wallets, accounts, etc are expected to keep track of them\n  // IC will reject out-of-order sequence numbers\n  sequence: number;\n  // The timestamp this message was sent at\n  // IC will reject if it's in the future or older than 5 minutes\n  timestampMillis: number;\n};\n\nexport interface IEnvelopeMetadata extends Message {\n  _metadata: EnvelopeMetadata;\n}\n\n// A message- whether the `Public` or `Private` component- is a JSON object.\n// As such, we know that the keys are strings, and the values are any JSON-serializable type ('unknown')\nexport type Message = Record<string, unknown>;\n\nexport type SecuredEnvelope<Public extends Message> = {\n  encryptedPrivateMessage: SerializedEncryptionResult;\n  messageSignature: string;\n  publicMessage: Public & IEnvelopeMetadata;\n};\n\nexport type SecuredEnvelopeTransport = {\n  encryptedPrivateMessage: SerializedEncryptionResult;\n  messageSignature: string;\n  serializedPublicMessage: string;\n};\n\nexport type DecryptedEnvelope<\n  Public extends Message & { [K in keyof Private]?: never },\n  Private extends Message & { [K in keyof Public]?: never },\n> = {\n  messageSignature: string;\n  privateMessage: Private;\n  publicMessage: Public & IEnvelopeMetadata;\n};\n\nexport type DeserializedTransportEnvelope<Public extends Message> = SecuredEnvelopeTransport & SecuredEnvelope<Public>;\n\nexport type SignCallbackOrEd25519SecretKey = SignCallback | Ed25519SecretKey;\n\nexport function ensurePrivatePublicFieldsDisjoint<\n  Public extends Message & { [K in keyof Private]?: never },\n  Private extends Message & { [K in keyof Public]?: never },\n>(privateMessage: Private, publicMessage: Public) {\n  // gets all fields in privateMessage that are also in publicMessage\n  const intersection = Object.keys(privateMessage).filter((x) => Object.keys(publicMessage).includes(x));\n  if (intersection.length > 0) {\n    const field = intersection[0];\n    throw new EnvelopeMessageMismatchError(`Field ${field} appears in both private and public message fields`, field);\n  }\n}\n\nexport function ensureMetadataFields(message: EnvelopeMetadata) {\n  // ensure ONLY the fields in REQUIRED_FIELDS are present in message. Sort asc.\n  const messageKeys = Object.keys(message).sort();\n  const extraFields = messageKeys.filter((key) => !REQUIRED_FIELDS.includes(key as any));\n  const missingFields = REQUIRED_FIELDS.filter((key) => !messageKeys.includes(key as any));\n  if (extraFields.length > 0 || missingFields.length > 0) {\n    let extraFieldsStr = extraFields.length > 0 ? `extra(${extraFields.join(', ')})` : '';\n    const missingFieldsStr = missingFields.length > 0 ? `missing(${missingFields.join(', ')})` : '';\n    extraFieldsStr = extraFieldsStr.length > 0 && missingFieldsStr.length > 0 ? `${extraFieldsStr}, ` : extraFieldsStr;\n    throw new EnvelopeMessageMismatchError(\n      `PublicMessage metadata fields do not conform to spec: ${extraFieldsStr}${missingFieldsStr}`,\n      '_metadata',\n    );\n  }\n}\n\nexport function deserializeTransportEnvelope<Public extends Message>(\n  transportEnvelope: SecuredEnvelopeTransport,\n): DeserializedTransportEnvelope<Public> {\n  const publicMessage = JSON.parse(transportEnvelope.serializedPublicMessage) as Public & IEnvelopeMetadata;\n  return {\n    ...transportEnvelope,\n    publicMessage,\n  };\n}\n\n// This signs with the senders ed25519 private key,\n// but encrypts with an ephemeral X25519 keyPair + the receivers x25519 public key (converted from their ed25519 key)\n// This is so that the private key IS ONLY EVER USED FOR DECRYPTION, NEVER FOR ENCRYPTION\nexport function encryptAndSignEnvelope<\n  Public extends Message & { [K in keyof Private]?: never },\n  Private extends Message & { [K in keyof Public]?: never },\n>(\n  senderEd25519SecretKey: Ed25519SecretKey,\n  senderEd25519PublicKey: Ed25519PublicKey,\n  receiverEd25519PublicKey: Ed25519PublicKey,\n  sequence: number,\n  publicMessage: Public,\n  privateMessage: Private,\n): SecuredEnvelopeTransport {\n  const senderEphemeralX25519KeyPair = createX25519KeyPair();\n  const metadata = constructMetadata(\n    senderEd25519PublicKey,\n    receiverEd25519PublicKey,\n    sequence,\n    senderEphemeralX25519KeyPair.publicKey,\n  );\n\n  ensureMetadataFields(metadata);\n  ensurePrivatePublicFieldsDisjoint<Public, Private>(privateMessage, publicMessage);\n\n  return dangerouslyEncryptAndSignEnvelopeUnvalidated(\n    senderEd25519SecretKey,\n    receiverEd25519PublicKey,\n    metadata,\n    privateMessage,\n    publicMessage,\n    senderEphemeralX25519KeyPair,\n  );\n}\n\nexport function constructMetadata(\n  senderEd25519PublicKey: Ed25519PublicKey,\n  receiverEd25519PublicKey: Ed25519PublicKey,\n  sequence: number,\n  senderEphemeralX25519PublicKey: X25519PublicKey,\n): EnvelopeMetadata {\n  // This is used for SIGNING ONLY!\n  return {\n    receiverEd25519PublicKeyB64: encodeBase64(receiverEd25519PublicKey.key),\n    senderEd25519PublicKeyB64: encodeBase64(senderEd25519PublicKey.key),\n    senderX25519PublicKeyB64: encodeBase64(senderEphemeralX25519PublicKey.key),\n    sequence,\n    timestampMillis: Date.now(),\n  };\n}\n\nexport function dangerouslyEncryptAndSignEnvelopeUnvalidated<\n  Public extends Message & { [K in keyof Private]?: never },\n  Private extends Message & { [K in keyof Public]?: never },\n>(\n  senderEd25519SecretKey: Ed25519SecretKey,\n  receiverEd25519PublicKey: Ed25519PublicKey,\n  metadata: EnvelopeMetadata,\n  privateMessage: Private,\n  publicMessage: Public,\n  senderEphemeralX25519KeyPair: X25519KeyPair,\n): SecuredEnvelopeTransport {\n  const encryptionResult = encryptObject(\n    senderEphemeralX25519KeyPair.secretKey,\n    receiverEd25519PublicKey,\n    privateMessage,\n  );\n  const encryptedPrivateMessage = serializeEncryptionResult(encryptionResult);\n  const encryptedPrivateMessageBytes = decodeBase64(encryptedPrivateMessage.securedB64);\n  const serializedPublicMessage = JSON.stringify({ ...publicMessage, _metadata: metadata });\n  const publicMessageBytes = new TextEncoder().encode(serializedPublicMessage);\n  const messageSignature = signEnvelope(publicMessageBytes, encryptedPrivateMessageBytes, senderEd25519SecretKey);\n  return {\n    encryptedPrivateMessage,\n    messageSignature,\n    serializedPublicMessage,\n  };\n}\n\nfunction combineHashedEnvelopeMessageBytes(\n  publicMessageBytes: Uint8Array,\n  privateMessageBytes: Uint8Array,\n): Uint8Array {\n  const publicMessageBytesHash = sha3_256(publicMessageBytes);\n  const privateMessageBytesHash = sha3_256(privateMessageBytes);\n  // Concatenate the two hashes\n  const combinedHash = new Uint8Array(publicMessageBytesHash.length + privateMessageBytesHash.length);\n  combinedHash.set(publicMessageBytesHash);\n  combinedHash.set(privateMessageBytesHash, publicMessageBytesHash.length);\n  // Hash and return\n  return sha3_256(combinedHash);\n}\n\nfunction signEnvelope(\n  publicMessageBytes: Uint8Array,\n  privateMessageBytes: Uint8Array,\n  senderEd25519SecretKey: Ed25519SecretKey,\n) {\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const signatureBytes = signWithEd25519SecretKey(messageHashBytes, senderEd25519SecretKey, 'SECURED_ENVELOPE');\n  return Hex.fromHexInput(signatureBytes).toString();\n}\n\nexport function verifyEnvelopeSignature(\n  publicMessageBytes: Uint8Array,\n  privateMessageBytes: Uint8Array,\n  messageSignatureInput: string,\n  senderEd25519PublicKey: Ed25519PublicKey,\n) {\n  const messageSignature = new Ed25519Signature(Hex.fromHexInput(messageSignatureInput).toUint8Array());\n  const senderPublicKey = new AptosEd25519PublicKey(senderEd25519PublicKey.key);\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const messageVerified = verifySignature(messageHashBytes, messageSignature, senderPublicKey, 'SECURED_ENVELOPE');\n  if (!messageVerified) {\n    throw new EnvelopeMessageMismatchError('Could not verify SecuredEnvelope signature', 'messageSignature');\n  }\n}\n\nexport function decryptEnvelope<\n  Public extends Message & { [K in keyof Private]?: never },\n  Private extends Message & { [K in keyof Public]?: never },\n>(\n  senderEd25519PublicKey: Ed25519PublicKey,\n  receiverEd25519SecretKey: Ed25519SecretKey,\n  message: SecuredEnvelopeTransport,\n): DecryptedEnvelope<Public, Private> {\n  const { encryptedPrivateMessage, messageSignature, serializedPublicMessage } = message;\n  const publicMessage = JSON.parse(serializedPublicMessage) as Public & IEnvelopeMetadata;\n\n  // Ensure the private/public message signature matches the expected signature\n  const rawPrivateMessage = decodeBase64(encryptedPrivateMessage.securedB64);\n  const rawPublicMessage = new TextEncoder().encode(serializedPublicMessage);\n  verifyEnvelopeSignature(rawPublicMessage, rawPrivateMessage, messageSignature, senderEd25519PublicKey);\n\n  // Ensure the public key matches the expected public key\n  const senderEd25519PublicKeyB64 = encodeBase64(senderEd25519PublicKey.key);\n  const expectedPublicKeyB64 = publicMessage._metadata.senderEd25519PublicKeyB64;\n  if (senderEd25519PublicKeyB64 !== expectedPublicKeyB64) {\n    throw new EnvelopeMessageMismatchError(\n      'senderEd25519PublicKey in envelope does not match provided receiverEd25519SecretKey',\n      'senderPublicKey',\n    );\n  }\n\n  const senderX25519PublicKeyBytes = decodeBase64(publicMessage._metadata.senderX25519PublicKeyB64);\n  const senderX25519PublicKey = toKey(senderX25519PublicKeyBytes, KeyTypes.X25519PublicKey);\n  const encryptionResult = deserializeEncryptionResult(encryptedPrivateMessage);\n  const privateMessage = decryptObject<Private>(\n    senderX25519PublicKey,\n    receiverEd25519SecretKey,\n    encryptionResult.secured,\n    encryptionResult.nonce,\n  );\n\n  ensureMetadataFields(publicMessage._metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n\n  return {\n    messageSignature,\n    privateMessage,\n    publicMessage,\n  };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  base64ToBytes,\n  bytesToBase64,\n  deserializePublicKey,\n  deserializeSignature,\n  serializePublicKey,\n  serializeSignature,\n} from '@aptos-connect/wallet-api';\nimport {\n  AccountPublicKey,\n  Deserializer,\n  Ed25519PublicKey as AptosEd25519PublicKey,\n  Ed25519Signature,\n  Hex,\n  PublicKey,\n  Serializer,\n  Signature,\n} from '@aptos-labs/ts-sdk';\nimport { decodeBase64 } from './utils';\n\nexport function serializePublicKeyB64(publicKey: PublicKey) {\n  const serializer = new Serializer();\n  serializePublicKey(serializer, publicKey);\n  return bytesToBase64(serializer.toUint8Array());\n}\n\nexport function deserializePublicKeyB64(publicKeyB64: string) {\n  const serializedPublicKey = base64ToBytes(publicKeyB64);\n  const deserializer = new Deserializer(serializedPublicKey);\n  return deserializePublicKey(deserializer) as AccountPublicKey;\n}\n\nexport function deserializeEd25519PublicKeyB64(ed25519PublicKeyB64: string) {\n  return new AptosEd25519PublicKey(decodeBase64(ed25519PublicKeyB64));\n}\n\nexport function serializeSignatureB64(signature: Signature) {\n  const serializer = new Serializer();\n  serializeSignature(serializer, signature);\n  return bytesToBase64(serializer.toUint8Array());\n}\n\nexport function deserializeSignatureB64(signatureB64: string) {\n  const serializedSignature = base64ToBytes(signatureB64);\n  const deserializer = new Deserializer(serializedSignature);\n  return deserializeSignature(deserializer);\n}\n\nexport function deserializeEd25519SignatureB64(ed25519SignatureB64: string) {\n  const signatureBytes = Hex.fromHexInput(ed25519SignatureB64).toUint8Array();\n  return new Ed25519Signature(signatureBytes);\n}\n\nexport function publicKeyB64FromEd25519PublicKeyB64(ed25519PublicKeyB64: string) {\n  const publicKey = deserializeEd25519PublicKeyB64(ed25519PublicKeyB64);\n  return serializePublicKeyB64(publicKey);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n// Adding or removing an account? This will be idempotent, but racy\nimport { Account, AccountPublicKey, PublicKey as AptosPublicKey, Signature } from '@aptos-labs/ts-sdk';\nimport { sha3_256 } from '@noble/hashes/sha3';\nimport { messageHash, signWithEd25519SecretKey } from './encrDecr';\nimport { serializePublicKeyB64, serializeSignatureB64 } from './serialization';\nimport { Ed25519KeyPair, ed25519KeypairFromSecret, Ed25519PublicKey, Ed25519SecretKey, encodeBase64 } from './utils';\n\n// ADD/REMOVE is used for account connections\nexport enum AccountConnectionAction {\n  ADD = 'add',\n  REMOVE = 'remove',\n}\n\n/**\n * When a wallet wants to create a pairing, or add/remove an account from a wallet connection, it must prove that it\n * has the secret key for a given account. To do so it uses an `AccountConnectInfo` object.\n *  1. Once the `AccountConnectInfo` is assembled, it’s JSON serialized to get a `accountInfoSerialized` string.\n *  2. We then domain separate and hash the `accountInfoSerialized` to get the `accountInfoHash`:\n *    `SHA3-256(SHA3-256('APTOS::IDENTITY_CONNECT::') | SHA3-256(accountInfoSerialized))`\n *  3. To obtain the `signature`, we sign the `accountInfoHash` with the Ed25519 private key of the sender, and hex\n *     encode it.\n *  4. These are assembled into an `AccountConnectInfoSerialized`, ready to be sent in an HTTP request.\n */\n\nexport type BaseAccountConnectInfo = {\n  // The account address\n  accountAddress: string;\n  // either 'add' or 'remove'\n  action: AccountConnectionAction;\n  // A unique identifier for this connection: it is either the walletId or the pairingId\n  // Prevents replay attacks across wallets\n  intentId: string;\n  // Prevents replay attacks across time- these are only valid for 5 minutes\n  timestampMillis: number;\n  // The public key for the encrypted e2e channel, base64\n  transportEd25519PublicKeyB64: string;\n};\n\nexport type Ed25519AccountConnectInfo = BaseAccountConnectInfo & {\n  // The account ed25519 public key, base64\n  ed25519PublicKeyB64: string;\n  publicKeyB64?: undefined;\n};\n\nexport type AnyAccountConnectInfo = BaseAccountConnectInfo & {\n  ed25519PublicKeyB64?: undefined;\n  // The account public key, bcs-serialized and base64-encoded\n  publicKeyB64: string;\n};\n\n// Ensuring compatibility with previous wallet-sdk versions\nexport type AccountConnectInfo = Ed25519AccountConnectInfo | AnyAccountConnectInfo;\n\nexport type Ed25519AccountConnectInfoSerialized = {\n  accountInfoSerialized: string;\n  signature: string;\n  signatureB64?: undefined;\n};\n\nexport type AnyAccountConnectInfoSerialized = {\n  accountInfoSerialized: string;\n  signature?: undefined;\n  signatureB64: string;\n};\n\nexport type AccountConnectInfoSerialized = Ed25519AccountConnectInfoSerialized | AnyAccountConnectInfoSerialized;\n\nexport type SyncSignCallback = (message: Uint8Array) => Signature;\nexport type AsyncSignCallback = (message: Uint8Array) => Promise<Signature>;\nexport type AnySignCallback = SyncSignCallback | AsyncSignCallback;\n\nexport function deriveAccountTransportEd25519Keypair(\n  ed25519SecretKey: Ed25519SecretKey,\n  publicKey: Ed25519PublicKey | AptosPublicKey,\n): Ed25519KeyPair;\n\nexport function deriveAccountTransportEd25519Keypair(\n  signCallback: SyncSignCallback,\n  publicKey: Ed25519PublicKey | AptosPublicKey,\n): Ed25519KeyPair;\n\nexport async function deriveAccountTransportEd25519Keypair(\n  signCallback: AsyncSignCallback,\n  publicKey: Ed25519PublicKey | AptosPublicKey,\n): Promise<Ed25519KeyPair>;\n\nexport function deriveAccountTransportEd25519Keypair(\n  signCallback: AnySignCallback,\n  publicKey: Ed25519PublicKey | AptosPublicKey,\n): Ed25519KeyPair | Promise<Ed25519KeyPair>;\n\nexport function deriveAccountTransportEd25519Keypair(\n  ed25519SecretKeyOrSignCallback: Ed25519SecretKey | AnySignCallback,\n  publicKey: Ed25519PublicKey | AptosPublicKey,\n) {\n  const publicKeyBytes = publicKey instanceof AptosPublicKey ? publicKey.toUint8Array() : publicKey.key;\n  if (ed25519SecretKeyOrSignCallback instanceof Function) {\n    const seedGeneratorBytes = messageHash(publicKeyBytes, 'TRANSPORT_KEYPAIR');\n    const signature = ed25519SecretKeyOrSignCallback(seedGeneratorBytes);\n    if (signature instanceof Promise) {\n      return signature.then((value) => ed25519KeypairFromSecret(value.toUint8Array()));\n    }\n    return ed25519KeypairFromSecret(signature.toUint8Array());\n  }\n\n  const seedBytes = signWithEd25519SecretKey(publicKeyBytes, ed25519SecretKeyOrSignCallback, 'TRANSPORT_KEYPAIR');\n  return ed25519KeypairFromSecret(seedBytes);\n}\n\nexport type CreateSerializedAccountInfoArgs<TSignCallback extends AnySignCallback> = [\n  signCallback: TSignCallback,\n  publicKey: AccountPublicKey,\n  transportEd25519PublicKey: Ed25519PublicKey,\n  action: AccountConnectionAction,\n  intentId: string,\n  accountAddress?: string,\n];\n\nexport function createSerializedAccountInfo(\n  ...args: CreateSerializedAccountInfoArgs<SyncSignCallback>\n): AccountConnectInfoSerialized;\nexport function createSerializedAccountInfo(\n  ...args: CreateSerializedAccountInfoArgs<AsyncSignCallback>\n): Promise<AccountConnectInfoSerialized>;\nexport function createSerializedAccountInfo(\n  ...args: CreateSerializedAccountInfoArgs<AnySignCallback>\n): AccountConnectInfoSerialized | Promise<AccountConnectInfoSerialized>;\n\nexport function createSerializedAccountInfo(\n  ...[\n    signCallback,\n    publicKey,\n    transportEd25519PublicKey,\n    action,\n    intentId,\n    accountAddress,\n  ]: CreateSerializedAccountInfoArgs<AnySignCallback>\n): AccountConnectInfoSerialized | Promise<AccountConnectInfoSerialized> {\n  // TODO: WRITE TESTS FOR THIS!\n\n  // Either the passed in Pk, or the Pk derived from the Sk\n  const authKey = publicKey.authKey();\n\n  // Either the passed in account address, or the one derived from the authKey: (either Pk, or derived from Sk)\n  const finalAccountAddress = accountAddress || authKey.derivedAddress().toString();\n  const publicKeyB64 = serializePublicKeyB64(publicKey);\n\n  const accountInfo: AccountConnectInfo = {\n    accountAddress: finalAccountAddress,\n    action,\n    intentId,\n    publicKeyB64,\n    timestampMillis: Date.now(),\n    transportEd25519PublicKeyB64: encodeBase64(transportEd25519PublicKey.key),\n  };\n  const accountInfoSerialized = JSON.stringify(accountInfo);\n  const accountInfoBytes = new TextEncoder().encode(accountInfoSerialized);\n  const accountInfoHash = sha3_256(accountInfoBytes);\n\n  const signature = signCallback(messageHash(accountInfoHash, 'ACCOUNT_INFO'));\n  if (signature instanceof Promise) {\n    return signature.then((value) => ({\n      accountInfoSerialized,\n      signatureB64: serializeSignatureB64(value),\n    }));\n  }\n  return {\n    accountInfoSerialized,\n    signatureB64: serializeSignatureB64(signature),\n  };\n}\n\nexport async function aptosAccountToSerializedInfo(\n  account: Account,\n  intentId: string,\n): Promise<AccountConnectInfoSerialized> {\n  const signCallback = async (data: Uint8Array) => account.sign(data);\n  const transportKey = await deriveAccountTransportEd25519Keypair(signCallback, account.publicKey);\n  return createSerializedAccountInfo(\n    signCallback,\n    account.publicKey,\n    transportKey.publicKey,\n    AccountConnectionAction.ADD,\n    intentId,\n  );\n}\n"],"names":["nacl","KeyTypes","nacl","Ed25519Signature","sha3_256","sha3_256","Ed25519Signature","AptosEd25519PublicKey","Ed25519Signature","Hex","AptosEd25519PublicKey","Hex","Ed25519Signature","sha3_256","AccountConnectionAction","sha3_256"],"mappings":"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","ignoreList":[0,1,2,3,4,5],"debugId":null}},
    {"offset": {"line": 1816, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/native.js"],"sourcesContent":["import crypto from 'crypto';\nexport default {\n  randomUUID: crypto.randomUUID\n};"],"names":[],"mappings":";;;AAAA;;uCACe;IACb,YAAY,qGAAA,CAAA,UAAM,CAAC,UAAU;AAC/B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1830, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/rng.js"],"sourcesContent":["import crypto from 'crypto';\nconst rnds8Pool = new Uint8Array(256); // # of random values to pre-allocate\n\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n  if (poolPtr > rnds8Pool.length - 16) {\n    crypto.randomFillSync(rnds8Pool);\n    poolPtr = 0;\n  }\n\n  return rnds8Pool.slice(poolPtr, poolPtr += 16);\n}"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,YAAY,IAAI,WAAW,MAAM,qCAAqC;AAE5E,IAAI,UAAU,UAAU,MAAM;AACf,SAAS;IACtB,IAAI,UAAU,UAAU,MAAM,GAAG,IAAI;QACnC,qGAAA,CAAA,UAAM,CAAC,cAAc,CAAC;QACtB,UAAU;IACZ;IAEA,OAAO,UAAU,KAAK,CAAC,SAAS,WAAW;AAC7C","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1850, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/regex.js"],"sourcesContent":["export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;"],"names":[],"mappings":";;;uCAAe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1860, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/validate.js"],"sourcesContent":["import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;"],"names":[],"mappings":";;;AAAA;;AAEA,SAAS,SAAS,IAAI;IACpB,OAAO,OAAO,SAAS,YAAY,yNAAA,CAAA,UAAK,CAAC,IAAI,CAAC;AAChD;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1875, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/stringify.js"],"sourcesContent":["import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;"],"names":[],"mappings":";;;;AAAA;;AACA;;;CAGC,GAED,MAAM,YAAY,EAAE;AAEpB,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,EAAE,EAAG;IAC5B,UAAU,IAAI,CAAC,CAAC,IAAI,KAAK,EAAE,QAAQ,CAAC,IAAI,KAAK,CAAC;AAChD;AAEO,SAAS,gBAAgB,GAAG,EAAE,SAAS,CAAC;IAC7C,uEAAuE;IACvE,oFAAoF;IACpF,OAAO,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC;AACpf;AAEA,SAAS,UAAU,GAAG,EAAE,SAAS,CAAC;IAChC,MAAM,OAAO,gBAAgB,KAAK,SAAS,4EAA4E;IACvH,oBAAoB;IACpB,wEAAwE;IACxE,2BAA2B;IAC3B,mEAAmE;IAEnE,IAAI,CAAC,CAAA,GAAA,4NAAA,CAAA,UAAQ,AAAD,EAAE,OAAO;QACnB,MAAM,UAAU;IAClB;IAEA,OAAO;AACT;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1911, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/v4.js"],"sourcesContent":["import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;"],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEA,SAAS,GAAG,OAAO,EAAE,GAAG,EAAE,MAAM;IAC9B,IAAI,0NAAA,CAAA,UAAM,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,SAAS;QACzC,OAAO,0NAAA,CAAA,UAAM,CAAC,UAAU;IAC1B;IAEA,UAAU,WAAW,CAAC;IACtB,MAAM,OAAO,QAAQ,MAAM,IAAI,CAAC,QAAQ,GAAG,IAAI,uNAAA,CAAA,UAAG,KAAK,gEAAgE;IAEvH,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO;IAC3B,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO,MAAM,oCAAoC;IAErE,IAAI,KAAK;QACP,SAAS,UAAU;QAEnB,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,EAAG;YAC3B,GAAG,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,EAAE;QAC3B;QAEA,OAAO;IACT;IAEA,OAAO,CAAA,GAAA,6NAAA,CAAA,kBAAe,AAAD,EAAE;AACzB;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1954, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/index.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/prompt.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/state.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/openTelegramPrompt.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/createWalletRequest.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/getClientIdentityKey.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/getWalletResponse.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/smartPolling.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40aptos-connect/web-transport/src/telegram/index.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  ConnectRequest,\n  ConnectResponse,\n  DisconnectRequest,\n  DisconnectResponse,\n  GetConnectedAccountsRequest,\n  GetConnectedAccountsResponse,\n  IsConnectedRequest,\n  IsConnectedResponse,\n  SerializedWalletRequest,\n  SignAndSubmitTransactionRequest,\n  SignInRequest,\n  SignInResponse,\n  SignMessageRequest,\n  SignTransactionRequest,\n} from '@aptos-connect/wallet-api';\nimport { openPrompt, waitForPromptResponse } from './prompt';\nimport { addConnectedAccount, getConnectedAccounts, removeConnectedAccount } from './state';\n\nimport { isTelegramMiniApp, openTelegramPrompt } from './telegram';\n\nexport class WebWalletTransport {\n  constructor(\n    private readonly baseUrl: string,\n    private readonly provider: 'google' | 'apple' = 'google',\n    private readonly tgWebAppUrl?: string,\n  ) {\n    this.baseUrl = baseUrl;\n  }\n\n  async sendPromptRequest(request: SerializedWalletRequest) {\n    if (isTelegramMiniApp()) {\n      return openTelegramPrompt({\n        baseUrl: this.baseUrl,\n        provider: this.provider,\n        request,\n        tgWebAppUrl: this.tgWebAppUrl,\n      });\n    }\n\n    const url = new URL(`${this.baseUrl}/prompt/`);\n    url.searchParams.set('provider', this.provider);\n    const prompt = openPrompt(url);\n\n    return waitForPromptResponse(this.baseUrl, prompt, request);\n  }\n\n  async sendRequest(request: SerializedWalletRequest) {\n    switch (request.name) {\n      case IsConnectedRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return IsConnectedResponse.serialize(connectedAccounts.length > 0);\n      }\n      case GetConnectedAccountsRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return GetConnectedAccountsResponse.serialize(connectedAccounts);\n      }\n      case ConnectRequest.name: {\n        const serializedResponse = await this.sendPromptRequest(request);\n        const response = ConnectResponse.deserialize(serializedResponse);\n        if (response.args.status === 'approved') {\n          const { account, pairing } = response.args.args;\n          if (pairing === undefined) {\n            addConnectedAccount(account);\n          }\n        }\n        return serializedResponse;\n      }\n      case SignInRequest.name: {\n        const serializedResponse = await this.sendPromptRequest(request);\n        const response = SignInResponse.deserialize(serializedResponse, (request as unknown as SignInRequest).version);\n        if (response.args.status === 'approved') {\n          const { account } = response.args.args;\n          addConnectedAccount(account);\n        }\n        return serializedResponse;\n      }\n      case DisconnectRequest.name: {\n        const [activeAccount] = getConnectedAccounts();\n        if (activeAccount) {\n          removeConnectedAccount(activeAccount.address);\n        }\n        return DisconnectResponse.serialize({});\n      }\n      case SignMessageRequest.name:\n      case SignTransactionRequest.name:\n      case SignAndSubmitTransactionRequest.name: {\n        return this.sendPromptRequest(request);\n      }\n      default: {\n        throw new Error('Unexpected request');\n      }\n    }\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  ConnectResponse,\n  isTypedMessage,\n  PromptApprovalResponseMessage,\n  PromptConnectionRequestMessage,\n  PromptConnectionResponseMessage,\n  PromptUnauthorizedErrorMessage,\n  SerializedWalletRequest,\n  SerializedWalletResponse,\n} from '@aptos-connect/wallet-api';\n\nconst DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nconst PROMPT_POLLER_INTERVAL = 500;\n\nconst dismissalSerializedResponse = ConnectResponse.serialize({ status: 'dismissed' });\n\nexport class PromptUnauthorizedError extends Error {\n  constructor() {\n    super('Unauthorized');\n  }\n}\n\nexport function openPrompt(url: string | URL, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width,\n  };\n\n  const strOptions = Object.entries(options)\n    .map(([key, value]) => `${key}=${JSON.stringify(value)}`)\n    .reduce((acc, entry) => `${acc}, ${entry}`);\n\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, undefined, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n\n  return promptWindow;\n}\n\nexport async function waitForPromptResponse(baseUrl: string, promptWindow: Window, request: SerializedWalletRequest) {\n  return new Promise<SerializedWalletResponse>((resolve, reject) => {\n    const listeners = {\n      onMessage: (message: MessageEvent) => {\n        // Ignore messages from untrusted sources\n        if (message.source !== promptWindow || message.origin !== baseUrl) {\n          return;\n        }\n        if (isTypedMessage(PromptUnauthorizedErrorMessage, message.data)) {\n          window.removeEventListener('message', listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          reject(new PromptUnauthorizedError());\n          return;\n        }\n        if (isTypedMessage(PromptConnectionRequestMessage, message.data)) {\n          promptWindow.postMessage(new PromptConnectionResponseMessage(request), baseUrl);\n          return;\n        }\n        if (isTypedMessage(PromptApprovalResponseMessage, message.data)) {\n          window.removeEventListener('message', listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(message.data.serializedValue);\n        }\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener('message', listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(dismissalSerializedResponse);\n        }\n      }, PROMPT_POLLER_INTERVAL),\n    };\n\n    window.addEventListener('message', listeners.onMessage);\n  });\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountInfo,\n  base64ToBytes,\n  bytesToBase64,\n  deserializeAccountInfo,\n  serializeAccountInfo,\n} from '@aptos-connect/wallet-api';\nimport { AccountAddress, Deserializer, Serializer } from '@aptos-labs/ts-sdk';\n\nconst localDappStateKey = '@aptos-connect/dapp-local-state';\n\n/**\n * Local dapp state loosely synced with the web wallet's state.\n * Due to browser restrictions (storage partitioning), it's no longer possible\n * to access the web wallet's state.\n */\ninterface DappLocalState {\n  connectedAccounts: AccountInfo[];\n}\n\nfunction serializeLocalDappState(state: DappLocalState): Uint8Array {\n  const serializer = new Serializer();\n  serializer.serializeU32AsUleb128(state.connectedAccounts.length);\n  for (const account of state.connectedAccounts) {\n    serializeAccountInfo(serializer, account);\n  }\n  return serializer.toUint8Array();\n}\n\nfunction deserializeLocalDappState(serializedValue: Uint8Array): DappLocalState {\n  const deserializer = new Deserializer(serializedValue);\n  const connectedAccountsLength = deserializer.deserializeUleb128AsU32();\n  const connectedAccounts: AccountInfo[] = [];\n  for (let i = 0; i < connectedAccountsLength; i += 1) {\n    connectedAccounts.push(deserializeAccountInfo(deserializer));\n  }\n  return { connectedAccounts };\n}\n\nfunction getState(): DappLocalState {\n  const encodedValue = window.localStorage.getItem(localDappStateKey);\n  return encodedValue ? deserializeLocalDappState(base64ToBytes(encodedValue)) : { connectedAccounts: [] };\n}\n\nfunction setState(state: DappLocalState) {\n  const serializedValue = serializeLocalDappState(state);\n  const encodedValue = bytesToBase64(serializedValue);\n  window.localStorage.setItem(localDappStateKey, encodedValue);\n}\n\nexport function getConnectedAccounts() {\n  const state = getState();\n  return state.connectedAccounts;\n}\n\nexport function addConnectedAccount(account: AccountInfo) {\n  const { connectedAccounts, ...state } = getState();\n  connectedAccounts.push(account);\n  setState({ ...state, connectedAccounts });\n}\n\nexport function removeConnectedAccount(address: AccountAddress) {\n  const { connectedAccounts, ...state } = getState();\n  const index = connectedAccounts.findIndex((a) => a.address.equals(address));\n  if (index >= 0) {\n    connectedAccounts.splice(index, 1);\n  }\n  setState({ ...state, connectedAccounts });\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  encodePopupWalletRequest,\n  makePopupWalletRequestChallenge,\n  SerializedWalletRequest,\n  SignedPopupWalletRequest,\n} from '@aptos-connect/wallet-api';\nimport { postEvent as postTelegramEvent } from '@telegram-apps/bridge';\nimport { v4 as randomUUID } from 'uuid';\nimport { createWalletRequest } from './createWalletRequest';\nimport { getClientIdentityKey } from './getClientIdentityKey';\nimport { getWalletResponse } from './getWalletResponse';\n\nexport async function openTelegramPrompt(args: {\n  baseUrl: string;\n  provider?: 'google' | 'apple';\n  request: SerializedWalletRequest;\n  tgWebAppUrl?: string;\n}) {\n  const { baseUrl, provider, request: body, tgWebAppUrl = '/AptosConnectBot/AptosConnect' } = args;\n  const identityKey = getClientIdentityKey();\n  const clientIdentityKey = identityKey.publicKey();\n  const requestId = randomUUID();\n  const timestamp = Date.now();\n\n  const challenge = makePopupWalletRequestChallenge({ body, id: requestId, timestamp });\n  const signature = identityKey.sign(challenge);\n\n  const signedWalletRequest: SignedPopupWalletRequest = {\n    body,\n    clientIdentityKey,\n    id: requestId,\n    signature,\n    timestamp,\n  };\n\n  // Telegram only supports start parameters up to 1024 characters\n  // If the encoded request is longer, we send it to the backend and mark\n  // the request as \"deferred\" by omitting the body\n  let encodedRequest = encodePopupWalletRequest(signedWalletRequest);\n  if (encodedRequest.length > 1024) {\n    void createWalletRequest(baseUrl, signedWalletRequest);\n    encodedRequest = encodePopupWalletRequest({\n      clientIdentityKey,\n      id: requestId,\n      signature,\n      timestamp,\n    });\n  }\n\n  const startParam = `prompt_${provider ?? ''}${encodedRequest}`;\n  postTelegramEvent('web_app_open_tg_link', {\n    path_full: `${tgWebAppUrl}?startapp=${startParam}`,\n  });\n\n  return getWalletResponse(baseUrl, clientIdentityKey, requestId);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  bytesToBase64,\n  bytesToBase64url,\n  encodeWalletRequestBody,\n  SignedPopupWalletRequest,\n} from '@aptos-connect/wallet-api';\n\nexport async function createWalletRequest(baseUrl: string, request: SignedPopupWalletRequest) {\n  const encodedClientIdentityKey = bytesToBase64url(request.clientIdentityKey.toUint8Array());\n\n  const response = await fetch(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/`, {\n    body: JSON.stringify({\n      body: encodeWalletRequestBody(request.body),\n      id: request.id,\n      signature: bytesToBase64(request.signature.toUint8Array()),\n      timestamp: request.timestamp,\n    }),\n    headers: { Accept: 'application/json', 'Content-Type': 'application/json' },\n    method: 'post',\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed creating the wallet request');\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Ed25519PrivateKey } from '@aptos-labs/ts-sdk';\n\nconst identityKeyStorageKey = '@aptos-connect/client-identity-key';\n\nexport function getClientIdentityKey() {\n  const serialized = window.localStorage.getItem(identityKeyStorageKey);\n  if (serialized) {\n    return new Ed25519PrivateKey(serialized);\n  }\n  const identityKey = Ed25519PrivateKey.generate();\n  window.localStorage.setItem(identityKeyStorageKey, identityKey.toString());\n  return identityKey;\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { base64ToBytes, bytesToBase64url, SerializedWalletResponse } from '@aptos-connect/wallet-api';\nimport { Ed25519PublicKey } from '@aptos-labs/ts-sdk';\nimport { smartPolling } from './smartPolling';\n\nexport async function getWalletResponse(\n  baseUrl: string,\n  clientIdentityKey: Ed25519PublicKey,\n  requestId: string,\n): Promise<SerializedWalletResponse> {\n  const encodedClientIdentityKey = bytesToBase64url(clientIdentityKey.toUint8Array());\n  const url = new URL(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/${requestId}/response/`);\n  const response = await smartPolling(() =>\n    fetch(url, {\n      headers: { Accept: 'application/json' },\n      method: 'get',\n    }),\n  );\n\n  const responseBody = await response.json();\n  const data = base64ToBytes(responseBody.data.body);\n  return { data };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-await-in-loop */\n\n/**\n * How long to wait after resuming before trying to fetch the resource again.\n * This gives time for the underlying resource to be persisted.\n */\nconst ON_RESUME_DELAY = 300;\n\n/**\n * How often to poll for the resource when the window is in the foreground.\n * This should typically not be needed, but it's a good fallback in case we\n * can't detect whether the window is in the background\n */\nconst FG_RESPONSE_POLLING_INTERVAL = 2000;\n\n/**\n * Polling interval when the window is in the background.\n * This can be arbitrarily long, but it's still good to keep polling as fallback.\n */\nconst BG_RESPONSE_POLLING_INTERVAL = 3000;\n\n/**\n * Given there's no \"cancel\" mechanism for polling, we should time out the polling after\n * an arbitrarily long time to prevent memory leaks.\n */\nconst POLLING_TIMEOUT = 5 * 60000;\n\nexport interface Timer extends Promise<void> {\n  cancel: () => void;\n}\n\nfunction waitFor(milliseconds: number): Timer {\n  let timeoutId: ReturnType<typeof setTimeout>;\n  let cancel = () => {};\n  const timer = new Promise((resolve) => {\n    timeoutId = setTimeout(resolve, milliseconds);\n    cancel = () => {\n      clearTimeout(timeoutId);\n      resolve();\n    };\n  }) as Timer;\n  timer.cancel = cancel;\n  return timer;\n}\n\n/**\n * Smart polling function that tries to reduce as much as possible the number of requests,\n * while still returning quickly after the resource becomes available.\n */\nexport async function smartPolling(callback: () => Promise<Response>): Promise<Response> {\n  let timer: Timer | undefined;\n  let justResumed = false;\n  let pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n\n  const onWindowFocus = () => {\n    justResumed = true;\n    pollingInterval = FG_RESPONSE_POLLING_INTERVAL;\n    timer?.cancel();\n  };\n\n  const onWindowBlur = () => {\n    pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n  };\n\n  window.addEventListener('focus', onWindowFocus);\n  window.addEventListener('blur', onWindowBlur);\n\n  try {\n    const startTime = Date.now();\n    while (Date.now() - startTime < POLLING_TIMEOUT) {\n      timer = waitFor(pollingInterval);\n      await timer;\n\n      if (justResumed) {\n        timer = waitFor(ON_RESUME_DELAY);\n        await timer;\n      }\n\n      const response = await callback();\n      if (response.status === 200) {\n        return response;\n      }\n      justResumed = false;\n    }\n    throw new Error('Timeout');\n  } finally {\n    window.removeEventListener('focus', onWindowFocus);\n    window.removeEventListener('blur', onWindowFocus);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport function isTelegramMiniApp() {\n  return (window as any).TelegramWebviewProxy !== undefined;\n}\n\nexport * from './openTelegramPrompt';\n"],"names":["ConnectResponse","bytesToBase64","base64ToBytes","bytesToBase64url","bytesToBase64url","base64ToBytes","ConnectResponse"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8],"debugId":null}},
    {"offset": {"line": 2317, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/bcsSerialization.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/jsonPayload.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/error.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/rawTxn.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/signAndSubmitTransactionRequestArgs.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/signTransactionRequestArgs.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/serialization/signTransactionResponseArgs.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/node_modules/%40identity-connect/wallet-api/src/utils/makeFullMessage.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Deserializer, Hex, Serializable as BcsSerializableV2 } from '@aptos-labs/ts-sdk';\nimport { BCS } from 'aptos';\n\nexport type BcsSerializableV1 = { serialize(serializer: BCS.Serializer): void };\nexport type BcsDeserializableV1Class<T extends BcsSerializableV1> = {\n  deserialize(deserializer: BCS.Deserializer): T;\n};\nexport type BcsDeserializableV2Class<T extends BcsSerializableV2> = {\n  deserialize(deserializer: Deserializer): T;\n};\n\nfunction isBcsSerializableV1(value: any): value is BcsSerializableV1 {\n  return (value as BcsSerializableV1)?.serialize !== undefined;\n}\n\nfunction isBcsSerializableV2(value: any): value is BcsSerializableV2 {\n  return (\n    (value as BcsSerializableV2)?.serialize !== undefined &&\n    (value as BcsSerializableV2)?.bcsToBytes !== undefined &&\n    (value as BcsSerializableV2)?.bcsToHex !== undefined\n  );\n}\n\n/**\n * Check if a value is BCS serializable\n */\nexport function isBcsSerializable(value: any): value is BcsSerializableV1 | BcsSerializableV2 {\n  return isBcsSerializableV1(value) || isBcsSerializableV2(value);\n}\n\nexport function bcsSerialize(serializable: BcsSerializableV1 | BcsSerializableV2) {\n  if (isBcsSerializableV2(serializable)) {\n    return serializable.bcsToHex().toString();\n  }\n  const serializedValueBytes = BCS.bcsToBytes(serializable);\n  return Hex.fromHexInput(serializedValueBytes).toString();\n}\n\nexport function bcsDeserialize<T extends BcsSerializableV2>(\n  deserializableClass: BcsDeserializableV2Class<T>,\n  serializedValue: string,\n) {\n  const serializedValueBytes = Hex.fromHexString(serializedValue).toUint8Array();\n  const deserializer = new Deserializer(serializedValueBytes);\n  return deserializableClass.deserialize(deserializer);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { Hex } from '@aptos-labs/ts-sdk';\nimport type { EntryFunctionPayloadResponse } from '@aptos-labs/ts-sdk';\nimport type { EntryFunctionJsonTransactionPayload, JsonTransactionPayload } from '../types';\nimport { UnexpectedValueError } from './error';\n\ninterface SerializedUint8ArrayArg {\n  type: 'Uint8Array';\n  value: string;\n}\n\nfunction isSerializedUint8Array(arg: any): arg is SerializedUint8ArrayArg {\n  return arg?.type === 'Uint8Array' && typeof arg?.value === 'string';\n}\n\nfunction serializeEntryFunctionArg(arg: any): any {\n  if (arg instanceof Uint8Array) {\n    return {\n      type: 'Uint8Array',\n      value: Hex.fromHexInput(arg).toString(),\n    };\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(serializeEntryFunctionArg);\n  }\n  return arg;\n}\n\nfunction deserializeEntryFunctionArg(arg: any): any {\n  if (isSerializedUint8Array(arg)) {\n    return Hex.fromHexInput(arg.value).toUint8Array();\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(deserializeEntryFunctionArg);\n  }\n  return arg;\n}\n\nfunction serializeEntryFunctionPayload(payload: EntryFunctionPayloadResponse): EntryFunctionJsonTransactionPayload {\n  const normalizedArgs = payload.arguments.map(serializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: normalizedArgs,\n    type: 'entry_function_payload',\n  };\n}\n\nfunction deserializeEntryFunctionPayload(payload: EntryFunctionPayloadResponse): EntryFunctionJsonTransactionPayload {\n  const deserializedArgs = payload.arguments.map(deserializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: deserializedArgs,\n    type: 'entry_function_payload',\n  };\n}\n\nexport function serializeJsonTransactionPayload(payload: JsonTransactionPayload): JsonTransactionPayload {\n  if (payload.type === 'entry_function_payload' || payload.type === undefined) {\n    return serializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === 'multisig_payload') {\n    const innerPayload =\n      payload.transaction_payload !== undefined\n        ? serializeEntryFunctionPayload(payload.transaction_payload)\n        : undefined;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\n\nexport function deserializeJsonTransactionPayload(payload: JsonTransactionPayload): JsonTransactionPayload {\n  if (payload.type === 'entry_function_payload' || payload.type === undefined) {\n    return deserializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === 'multisig_payload') {\n    const innerPayload =\n      payload.transaction_payload !== undefined\n        ? deserializeEntryFunctionPayload(payload.transaction_payload)\n        : undefined;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport class UnexpectedValueError extends Error {\n  constructor(message?: string) {\n    super(message);\n    this.name = 'UnexpectedValueError';\n    Object.setPrototypeOf(this, UnexpectedValueError.prototype);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  FeePayerRawTransaction,\n  MultiAgentRawTransaction,\n  RawTransaction,\n  RawTransactionWithData,\n} from '@aptos-labs/ts-sdk';\nimport { TxnBuilderTypes } from 'aptos';\nimport { bcsDeserialize, bcsSerialize } from './bcsSerialization';\nimport { UnexpectedValueError } from './error';\n\nexport type SerializableRawTransaction = RawTransaction | FeePayerRawTransaction | MultiAgentRawTransaction;\n\nexport type SerializableRawTransactionV1 =\n  | TxnBuilderTypes.RawTransaction\n  | TxnBuilderTypes.FeePayerRawTransaction\n  | TxnBuilderTypes.MultiAgentRawTransaction;\n\nexport interface SerializedSimpleRawTransaction {\n  type: 'raw_txn';\n  value: string;\n}\n\nexport interface SerializedFeePayerRawTransaction {\n  type: 'fee_payer_raw_txn';\n  value: string;\n}\n\nexport interface SerializedMultiAgentRawTransaction {\n  type: 'multi_agent_raw_txn';\n  value: string;\n}\n\nexport type SerializedRawTransaction =\n  | SerializedSimpleRawTransaction\n  | SerializedFeePayerRawTransaction\n  | SerializedMultiAgentRawTransaction;\n\nexport function serializeRawTransaction(\n  rawTxn: RawTransaction | TxnBuilderTypes.RawTransaction,\n): SerializedSimpleRawTransaction;\nexport function serializeRawTransaction(\n  rawTxn: FeePayerRawTransaction | TxnBuilderTypes.FeePayerRawTransaction,\n): SerializedFeePayerRawTransaction;\nexport function serializeRawTransaction(\n  rawTxn: MultiAgentRawTransaction | TxnBuilderTypes.MultiAgentRawTransaction,\n): SerializedMultiAgentRawTransaction;\nexport function serializeRawTransaction(\n  rawTxn: SerializableRawTransaction | SerializableRawTransactionV1,\n): SerializedRawTransaction;\n\nexport function serializeRawTransaction(\n  rawTxn: SerializableRawTransaction | SerializableRawTransactionV1,\n): SerializedRawTransaction {\n  const value = bcsSerialize(rawTxn);\n  if ('fee_payer_address' in rawTxn) {\n    return { type: 'fee_payer_raw_txn', value };\n  }\n  if ('secondary_signer_addresses' in rawTxn) {\n    return { type: 'multi_agent_raw_txn', value };\n  }\n  if ('chain_id' in rawTxn) {\n    return { type: 'raw_txn', value };\n  }\n  throw new UnexpectedValueError('Invalid raw transaction type');\n}\n\nexport function deserializeRawTransaction(serialized: SerializedSimpleRawTransaction): RawTransaction;\nexport function deserializeRawTransaction(serialized: SerializedFeePayerRawTransaction): FeePayerRawTransaction;\nexport function deserializeRawTransaction(serialized: SerializedMultiAgentRawTransaction): MultiAgentRawTransaction;\nexport function deserializeRawTransaction(serialized: SerializedRawTransaction): SerializableRawTransaction;\n\nexport function deserializeRawTransaction(serialized: SerializedRawTransaction): SerializableRawTransaction {\n  switch (serialized.type) {\n    case 'raw_txn':\n      return bcsDeserialize(RawTransaction, serialized.value);\n    case 'fee_payer_raw_txn':\n      return bcsDeserialize(RawTransactionWithData, serialized.value) as FeePayerRawTransaction;\n    case 'multi_agent_raw_txn':\n      return bcsDeserialize(RawTransactionWithData, serialized.value) as MultiAgentRawTransaction;\n    default:\n      throw new UnexpectedValueError('Invalid raw transaction type');\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountAuthenticator, TransactionPayload } from '@aptos-labs/ts-sdk';\nimport type {\n  SignAndSubmitTransactionRequestArgs,\n  SignAndSubmitTransactionRequestV1Args,\n  SignAndSubmitTransactionWithFeePayerRawTxnRequestArgs,\n  SignAndSubmitTransactionWithPayloadRequestArgs,\n  SignAndSubmitTransactionWithRawTxnRequestArgs,\n} from '../types';\nimport { JsonTransactionPayload, TransactionOptions } from '../types';\nimport { bcsDeserialize, bcsSerialize, isBcsSerializable } from './bcsSerialization';\n\nimport { UnexpectedValueError } from './error';\nimport { deserializeJsonTransactionPayload, serializeJsonTransactionPayload } from './jsonPayload';\nimport {\n  deserializeRawTransaction,\n  type SerializedFeePayerRawTransaction,\n  type SerializedSimpleRawTransaction,\n  serializeRawTransaction,\n} from './rawTxn';\n\nexport interface SerializedSignAndSubmitTransactionWithPayloadRequestArgs {\n  options?: TransactionOptions;\n  payload: JsonTransactionPayload | string;\n}\n\nexport interface SerializedSignAndSubmitTransactionWithRawTxnRequestArgs {\n  rawTxn: SerializedSimpleRawTransaction;\n}\n\nexport interface SerializedSignAndSubmitTransactionWithFeePayerRawTxnRequestArgs {\n  feePayerAuthenticator: string;\n  rawTxn: SerializedFeePayerRawTransaction;\n}\n\nexport type SerializedSignAndSubmitTransactionRequestArgs =\n  | SerializedSignAndSubmitTransactionWithPayloadRequestArgs\n  | SerializedSignAndSubmitTransactionWithRawTxnRequestArgs\n  | SerializedSignAndSubmitTransactionWithFeePayerRawTxnRequestArgs;\n\nexport function serializeSignAndSubmitTransactionRequestArgs(\n  args: SignAndSubmitTransactionRequestArgs | SignAndSubmitTransactionRequestV1Args,\n): SerializedSignAndSubmitTransactionRequestArgs {\n  if ('payload' in args) {\n    const serializedPayload = isBcsSerializable(args.payload)\n      ? bcsSerialize(args.payload)\n      : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if ('feePayerAuthenticator' in args) {\n    return {\n      feePayerAuthenticator: bcsSerialize(args.feePayerAuthenticator),\n      rawTxn: serializeRawTransaction(args.rawTxn),\n    };\n  }\n  if ('rawTxn' in args) {\n    return { rawTxn: serializeRawTransaction(args.rawTxn) };\n  }\n  throw new UnexpectedValueError();\n}\n\nexport function deserializeSignAndSubmitTransactionRequestArgs(\n  args: SerializedSignAndSubmitTransactionWithPayloadRequestArgs,\n): SignAndSubmitTransactionWithPayloadRequestArgs;\nexport function deserializeSignAndSubmitTransactionRequestArgs(\n  args: SerializedSignAndSubmitTransactionWithRawTxnRequestArgs,\n): SignAndSubmitTransactionWithRawTxnRequestArgs;\nexport function deserializeSignAndSubmitTransactionRequestArgs(\n  args: SerializedSignAndSubmitTransactionWithFeePayerRawTxnRequestArgs,\n): SignAndSubmitTransactionWithFeePayerRawTxnRequestArgs;\nexport function deserializeSignAndSubmitTransactionRequestArgs(\n  args: SerializedSignAndSubmitTransactionRequestArgs,\n): SignAndSubmitTransactionRequestArgs;\n\nexport function deserializeSignAndSubmitTransactionRequestArgs(\n  args: SerializedSignAndSubmitTransactionRequestArgs,\n): SignAndSubmitTransactionRequestArgs {\n  if ('payload' in args) {\n    const payload =\n      typeof args.payload === 'string'\n        ? bcsDeserialize(TransactionPayload, args.payload)\n        : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if ('feePayerAuthenticator' in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    const feePayerAuthenticator = bcsDeserialize(AccountAuthenticator, args.feePayerAuthenticator);\n    return { feePayerAuthenticator, rawTxn: deserializedRawTxn };\n  }\n  if ('rawTxn' in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { TransactionPayload } from '@aptos-labs/ts-sdk';\nimport type {\n  JsonTransactionPayload,\n  SignTransactionRequestArgs,\n  SignTransactionRequestV1Args,\n  SignTransactionWithPayloadRequestArgs,\n  SignTransactionWithRawTxnRequestArgs,\n  TransactionOptions,\n} from '../types';\nimport { bcsDeserialize, bcsSerialize, isBcsSerializable } from './bcsSerialization';\nimport { UnexpectedValueError } from './error';\nimport { deserializeJsonTransactionPayload, serializeJsonTransactionPayload } from './jsonPayload';\nimport type { SerializedRawTransaction } from './rawTxn';\nimport { deserializeRawTransaction, serializeRawTransaction } from './rawTxn';\n\nexport interface SerializedSignTransactionWithPayloadRequestArgs {\n  options?: TransactionOptions;\n  payload: JsonTransactionPayload | string;\n}\n\nexport interface SerializedSignTransactionWithRawTxnRequestArgs {\n  rawTxn: SerializedRawTransaction;\n}\n\nexport type SerializedSignTransactionRequestArgs =\n  | SerializedSignTransactionWithPayloadRequestArgs\n  | SerializedSignTransactionWithRawTxnRequestArgs;\n\nexport function serializeSignTransactionRequestArgs(\n  args: SignTransactionRequestArgs | SignTransactionRequestV1Args,\n): SerializedSignTransactionRequestArgs {\n  if ('payload' in args) {\n    const serializedPayload = isBcsSerializable(args.payload)\n      ? bcsSerialize(args.payload)\n      : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if ('rawTxn' in args) {\n    const serializedRawTxn = serializeRawTransaction(args.rawTxn);\n    return { rawTxn: serializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\nexport function deserializeSignTransactionRequestArgs(\n  args: SerializedSignTransactionWithPayloadRequestArgs,\n): SignTransactionWithPayloadRequestArgs;\nexport function deserializeSignTransactionRequestArgs(\n  args: SerializedSignTransactionWithRawTxnRequestArgs,\n): SignTransactionWithRawTxnRequestArgs;\nexport function deserializeSignTransactionRequestArgs(\n  args: SerializedSignTransactionRequestArgs,\n): SignTransactionRequestArgs;\n\nexport function deserializeSignTransactionRequestArgs(\n  args: SerializedSignTransactionRequestArgs,\n): SignTransactionRequestArgs {\n  if ('payload' in args) {\n    const payload =\n      typeof args.payload === 'string'\n        ? bcsDeserialize(TransactionPayload, args.payload)\n        : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if ('rawTxn' in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountAuthenticator, RawTransaction } from '@aptos-labs/ts-sdk';\nimport type { SignTransactionResponseArgs } from '../types';\nimport { bcsDeserialize, bcsSerialize } from './bcsSerialization';\n\nexport interface SerializedSignTransactionWithPayloadResponseArgs {\n  accountAuthenticator: string;\n  rawTxn: string;\n}\n\nexport interface SerializedSignTransactionWithRawTxnResponseArgs {\n  accountAuthenticator: string;\n}\n\nexport type SerializedSignTransactionResponseArgs =\n  | SerializedSignTransactionWithPayloadResponseArgs\n  | SerializedSignTransactionWithRawTxnResponseArgs;\n\nexport function serializeSignTransactionResponseArgs(\n  args: SignTransactionResponseArgs,\n): SerializedSignTransactionResponseArgs {\n  const accountAuthenticator = bcsSerialize(args.accountAuthenticator);\n  if ('rawTxn' in args) {\n    const rawTxn = bcsSerialize(args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\n\nexport function deserializeSignTransactionResponseArgs(\n  args: SerializedSignTransactionResponseArgs,\n): SignTransactionResponseArgs {\n  const accountAuthenticator = bcsDeserialize(AccountAuthenticator, args.accountAuthenticator);\n  if ('rawTxn' in args) {\n    const rawTxn = bcsDeserialize(RawTransaction, args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport type { FullMessageFlags, FullMessageParams, FullMessageResult } from '../types';\n\nconst prefix = 'APTOS';\n\nexport function makeFullMessage(params: FullMessageParams, flags: FullMessageFlags): FullMessageResult {\n  let fullMessage = prefix;\n  if (flags.address) {\n    fullMessage += `\\naddress: ${params.address}`;\n  }\n  if (flags.application) {\n    fullMessage += `\\napplication: ${params.application}`;\n  }\n  if (flags.chainId) {\n    fullMessage += `\\nchainId: ${params.chainId}`;\n  }\n\n  fullMessage += `\\nmessage: ${params.message}`;\n  fullMessage += `\\nnonce: ${params.nonce}`;\n\n  return {\n    fullMessage,\n    prefix,\n  };\n}\n"],"names":["Hex","Hex","TransactionPayload","TransactionPayload","AccountAuthenticator","RawTransaction","AccountAuthenticator","RawTransaction"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7],"debugId":null}},
    {"offset": {"line": 2617, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/ACDappClient.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/constants.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/conversion.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/PairingClient.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/errors.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/state.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/utils.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/ICDappClient.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/prompt.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/node_modules/%40identity-connect/dapp-sdk/src/KeylessClient.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  chainIdToNetwork,\n  ConnectRequest,\n  ConnectResponse,\n  type DappInfo,\n  DisconnectRequest,\n  GetConnectedAccountsRequest,\n  GetConnectedAccountsResponse,\n  makeUserApproval,\n  SignAndSubmitTransactionRequest,\n  SignAndSubmitTransactionResponse,\n  SignInRequest,\n  SignInResponse,\n  SignMessageRequest,\n  SignMessageResponse,\n  SignTransactionRequest,\n  SignTransactionResponse,\n  UserApproval,\n  UserDismissal,\n} from '@aptos-connect/wallet-api';\nimport { WebWalletTransport } from '@aptos-connect/web-transport';\nimport {\n  AccountAddress,\n  AccountAddressInput,\n  AnySignature,\n  AptosConfig,\n  Deserializer,\n  Ed25519Signature,\n  FeePayerRawTransaction,\n  generateRawTransaction,\n  Hex,\n} from '@aptos-labs/ts-sdk';\nimport { NetworkName } from '@identity-connect/api';\nimport { createEd25519KeyPair, encodeBase64 } from '@identity-connect/crypto';\nimport { SignAndSubmitTransactionRequestArgs } from '@identity-connect/wallet-api';\nimport { DEFAULT_FRONTEND_URL } from './constants';\nimport { normalizePayloadForIC } from './conversion';\nimport { ACPairingClient } from './PairingClient';\n\nexport interface WithSignerAddress {\n  signerAddress: AccountAddress;\n}\n\nexport interface ACDappClientConfig {\n  backendBaseURL?: string;\n  dappId?: string;\n  dappImageURI?: string;\n  dappName?: string;\n  defaultNetworkName?: NetworkName;\n  frontendBaseURL?: string;\n  provider?: 'google' | 'apple';\n  tgWebAppURL?: string;\n}\n\nexport class ACDappClient {\n  private readonly defaultNetworkName: NetworkName;\n  readonly dappInfo: DappInfo;\n\n  private readonly transport: WebWalletTransport;\n\n  private readonly dappId?: string;\n  private readonly pairingClient: ACPairingClient;\n\n  constructor({\n    backendBaseURL,\n    dappId,\n    dappImageURI,\n    dappName,\n    defaultNetworkName = NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL,\n    provider = 'google',\n    tgWebAppURL,\n  }: ACDappClientConfig = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title,\n    };\n\n    this.transport = new WebWalletTransport(frontendBaseURL, provider, tgWebAppURL);\n\n    this.dappId = dappId;\n    this.pairingClient = new ACPairingClient({\n      axiosConfig: {\n        baseURL: backendBaseURL ?? frontendBaseURL,\n      },\n      defaultNetworkName,\n    });\n  }\n\n  // region Public API\n\n  private async getKeylessAccounts() {\n    const serializedRequest = GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  private async getIcAccounts() {\n    return this.pairingClient.getConnectedAccounts() ?? [];\n  }\n\n  private async isIcAccount(address: AccountAddressInput) {\n    const icAccounts = await this.getIcAccounts();\n    return icAccounts.find((account) => account.address.equals(AccountAddress.from(address))) !== undefined;\n  }\n\n  async getConnectedAccounts() {\n    const keylessAccounts = await this.getKeylessAccounts();\n    const icAccounts = await this.getIcAccounts();\n    return [...keylessAccounts, ...icAccounts];\n  }\n\n  async disconnect(address: AccountAddressInput) {\n    if (await this.isIcAccount(address)) {\n      const stringAddress = AccountAddress.from(address).toString();\n      await this.pairingClient.disconnect(stringAddress);\n    } else {\n      const serializedRequest = DisconnectRequest.serialize(this.dappInfo);\n      await this.transport.sendRequest(serializedRequest);\n    }\n  }\n\n  async connect({\n    claimOptions,\n    preferredWalletName,\n  }: Omit<ConnectRequest.Args, 'dappId' | 'dappEd25519PublicKeyB64'> = {}) {\n    const dappKeypair = createEd25519KeyPair();\n    const injectedPreferredWalletName =\n      typeof window !== 'undefined' ? (window as any).AC_PREFERRED_WALLET_NAME : undefined;\n\n    const requestArgs = {\n      claimOptions,\n      dappEd25519PublicKeyB64: encodeBase64(dappKeypair.publicKey.key),\n      dappId: this.dappId,\n      preferredWalletName: preferredWalletName ?? injectedPreferredWalletName,\n    } satisfies ConnectRequest.Args;\n\n    const serializedRequest = ConnectRequest.serialize(this.dappInfo, requestArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = ConnectResponse.deserialize(serializedResponse);\n\n    if (response.args.status === 'approved') {\n      const { account, pairing } = response.args.args;\n      if (pairing) {\n        await this.pairingClient.addPairing(dappKeypair, pairing);\n      }\n      return makeUserApproval({ account });\n    }\n    return response.args;\n  }\n\n  async signIn(args: SignInRequest.Args): Promise<UserDismissal | UserApproval<SignInResponse.ApprovalArgs>> {\n    const serializedRequest = SignInRequest.serialize(this.dappInfo, args);\n\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n\n    const response = SignInResponse.deserialize(serializedResponse, serializedRequest.version);\n\n    return response.args;\n  }\n\n  async signMessage(args: SignMessageRequest.Args & WithSignerAddress) {\n    const { signerAddress } = args;\n\n    if (await this.isIcAccount(signerAddress)) {\n      const { chainId } = args;\n      const network = chainIdToNetwork(chainId) as string;\n\n      let message: string;\n      let nonce: string;\n      try {\n        message = new TextDecoder().decode(args.message);\n        nonce = new TextDecoder().decode(args.nonce);\n      } catch (err) {\n        throw new Error('Only UTF-8 encoded text is supported when using IC');\n      }\n\n      const { fullMessage, signature: hexSignature } = await this.pairingClient.signMessage(\n        signerAddress.toString(),\n        {\n          address: true,\n          application: true,\n          chainId: true,\n          message,\n          nonce,\n        },\n        { networkName: network as NetworkName },\n      );\n\n      const signatureBytes = Hex.fromHexInput(hexSignature).toUint8Array();\n      const signature =\n        signatureBytes.length === Ed25519Signature.LENGTH\n          ? new Ed25519Signature(signatureBytes)\n          : AnySignature.deserialize(new Deserializer(signatureBytes));\n      return makeUserApproval<SignMessageResponse.ApprovalArgs>({\n        fullMessage,\n        signature,\n      });\n    }\n    const serializedRequest = SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async signTransaction(\n    args: (SignTransactionRequest.Args | SignTransactionRequest.ArgsWithTransaction) & WithSignerAddress,\n  ): Promise<SignTransactionResponse.Args> {\n    const normalizedArgs = 'transaction' in args ? SignTransactionRequest.normalizeArgs(args) : args;\n    const { signerAddress } = args;\n\n    if (await this.isIcAccount(signerAddress)) {\n      const {\n        expirationSecondsFromNow,\n        expirationTimestamp,\n        feePayer,\n        gasUnitPrice,\n        maxGasAmount,\n        network,\n        payload,\n        secondarySigners,\n        sender,\n        sequenceNumber,\n      } = normalizedArgs;\n\n      if (feePayer !== undefined) {\n        throw new Error('Sponsored transaction not currently supported');\n      }\n\n      if (secondarySigners && secondarySigners.length > 0) {\n        throw new Error('Multi-agent transactions not currently supported');\n      }\n\n      if (!('bcsToBytes' in payload)) {\n        throw new Error('Payload input format is only supported with Keyless accounts.');\n      }\n\n      const responseArgs = await this.pairingClient.signTransaction(\n        signerAddress.toString(),\n        {\n          options: {\n            expirationSecondsFromNow,\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount,\n            sender: sender?.address.toString(),\n            sequenceNumber: sequenceNumber !== undefined ? Number(sequenceNumber) : undefined,\n          },\n          payload,\n        },\n        {\n          networkName: network as NetworkName | undefined,\n        },\n      );\n      return makeUserApproval({\n        authenticator: responseArgs.accountAuthenticator,\n        rawTransaction: responseArgs.rawTxn,\n      });\n    }\n\n    const serializedRequest = SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async signAndSubmitTransaction(args: SignAndSubmitTransactionRequest.Args & WithSignerAddress) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { expirationTimestamp, feePayer, gasUnitPrice, maxGasAmount, network } = args;\n      const aptosConfig = new AptosConfig({ network });\n\n      let convertedArgs: SignAndSubmitTransactionRequestArgs;\n      if (feePayer !== undefined) {\n        const payload = await normalizePayloadForIC(args.payload, aptosConfig);\n        const rawTxn = await generateRawTransaction({\n          aptosConfig,\n          feePayerAddress: feePayer.address,\n          options: {\n            gasUnitPrice,\n            maxGasAmount,\n          },\n          payload,\n          sender: signerAddress,\n        });\n        convertedArgs = {\n          feePayerAuthenticator: feePayer.authenticator,\n          rawTxn: new FeePayerRawTransaction(rawTxn, [], feePayer.address),\n        };\n      } else {\n        const payload = normalizePayloadForIC(args.payload);\n        convertedArgs = {\n          options: {\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount,\n          },\n          payload,\n        };\n      }\n\n      const { hash } = await this.pairingClient.signAndSubmitTransaction(signerAddress.toString(), convertedArgs, {\n        networkName: network as NetworkName | undefined,\n      });\n      return makeUserApproval<SignAndSubmitTransactionResponse.ApprovalArgs>({ txnHash: hash });\n    }\n\n    const serializedRequest = SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport const DEFAULT_FRONTEND_URL = 'https://aptosconnect.app';\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  AnyTransactionPayloadInstance,\n  AptosConfig,\n  EntryFunctionArgumentTypes,\n  generateTransactionPayload,\n  generateTransactionPayloadWithABI,\n  InputGenerateTransactionPayloadData,\n  SimpleEntryFunctionArgumentTypes,\n  TransactionPayload,\n} from '@aptos-labs/ts-sdk';\nimport { JsonTransactionPayload } from '@identity-connect/wallet-api';\n\ntype EntryFunctionArgument = SimpleEntryFunctionArgumentTypes | EntryFunctionArgumentTypes;\ntype SerializableArgument = undefined | null | number | string | boolean | Uint8Array | SerializableArgument[];\n\n/**\n * Return an equivalent argument value that can be safely serialized.\n */\nfunction convertToSerializableArgument(argument: EntryFunctionArgument): SerializableArgument {\n  if (argument === undefined || argument === null) {\n    return argument;\n  }\n\n  if (Array.isArray(argument)) {\n    return argument.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n\n  if (\n    typeof argument === 'string' ||\n    typeof argument === 'number' ||\n    typeof argument === 'boolean' ||\n    argument instanceof Uint8Array\n  ) {\n    return argument;\n  }\n\n  if (typeof argument === 'bigint') {\n    return argument.toString();\n  }\n\n  // ArrayBuffer\n  if (argument instanceof ArrayBuffer) {\n    return new Uint8Array(argument);\n  }\n\n  // MoveVector\n  if ('values' in argument) {\n    return argument.values.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n\n  // AccountAddress\n  if ('data' in argument) {\n    return AccountAddress.from(argument.data).toString();\n  }\n\n  // MoveOption\n  if (argument.value === undefined) {\n    return undefined;\n  }\n\n  if (\n    typeof argument.value === 'string' ||\n    typeof argument.value === 'number' ||\n    typeof argument.value === 'boolean' ||\n    argument.value instanceof Uint8Array\n  ) {\n    return argument.value;\n  }\n\n  if (typeof argument.value === 'bigint') {\n    return argument.value.toString();\n  }\n\n  throw new Error('Unexpected argument');\n}\n\n/**\n * Normalize payload input so that it's compatible with IC requests.\n * This variant is sync and will convert a payload generation input into a\n * `JsonTransactionPayload` when the ABI is not available\n */\nexport function normalizePayloadForIC(\n  payload: TransactionPayload | InputGenerateTransactionPayloadData,\n): AnyTransactionPayloadInstance | JsonTransactionPayload;\n/**\n * Normalize payload input so that it's compatible with IC requests.\n * This variant is async and will generate a payload instance when an input is provided\n */\nexport async function normalizePayloadForIC(\n  payload: TransactionPayload | InputGenerateTransactionPayloadData,\n  aptosConfig: AptosConfig,\n): Promise<AnyTransactionPayloadInstance>;\n\nexport function normalizePayloadForIC(\n  payload: TransactionPayload | InputGenerateTransactionPayloadData,\n  aptosConfig?: AptosConfig,\n): AnyTransactionPayloadInstance | JsonTransactionPayload | Promise<AnyTransactionPayloadInstance> {\n  if ('bcsToBytes' in payload) {\n    return payload as AnyTransactionPayloadInstance;\n  }\n  if ('bytecode' in payload) {\n    // The signature of this function returns a promise, but it's actually sync code\n    return generateTransactionPayload(payload);\n  }\n  if (aptosConfig) {\n    return payload.abi !== undefined\n      ? generateTransactionPayloadWithABI({ ...payload, abi: payload.abi })\n      : generateTransactionPayload({ aptosConfig, ...payload });\n  }\n\n  const entryFunctionPayload = {\n    arguments: payload.functionArguments.map(convertToSerializableArgument),\n    function: payload.function,\n    type: 'entry_function_payload' as const,\n    type_arguments: (payload.typeArguments ?? []).map((ta) => ta.toString()),\n  };\n\n  return 'multisigAddress' in payload\n    ? {\n        multisig_address: AccountAddress.from(payload.multisigAddress).toString(),\n        transaction_payload: entryFunctionPayload,\n        type: 'multisig_payload' as const,\n      }\n    : entryFunctionPayload;\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\n/* eslint-disable no-await-in-loop */\n\nimport { AccountInfo } from '@aptos-connect/wallet-api';\nimport { AccountAddress } from '@aptos-labs/ts-sdk';\nimport {\n  CancelSigningRequestSerializedResponse,\n  CreateSigningRequestSerializedResponse,\n  FinalizedPairingData,\n  GetPairingSerializedResponse,\n  GetSigningRequestSerializedResponse,\n  NetworkName,\n  SerializedDate,\n  SigningRequestData,\n  SigningRequestStatus,\n  SigningRequestTypes,\n} from '@identity-connect/api';\nimport {\n  decodeBase64,\n  decryptEnvelope,\n  deserializeEd25519PublicKeyB64,\n  deserializePublicKeyB64,\n  Ed25519KeyPair,\n  Ed25519PublicKey,\n  Ed25519SecretKey,\n  encodeBase64,\n  encryptAndSignEnvelope,\n  KeyTypes,\n  toKey,\n} from '@identity-connect/crypto';\nimport {\n  deserializeSignTransactionResponseArgs,\n  type SerializedSignAndSubmitTransactionRequestArgs,\n  type SerializedSignTransactionRequestArgs,\n  type SerializedSignTransactionResponseArgs,\n  serializeSignAndSubmitTransactionRequestArgs,\n  serializeSignTransactionRequestArgs,\n  type SignAndSubmitTransactionRequestArgs,\n  type SignAndSubmitTransactionResponseArgs,\n  SignMessageRequestArgs,\n  SignMessageResponseArgs,\n  type SignTransactionRequestArgs,\n  type SignTransactionResponseArgs,\n  type SignTransactionWithPayloadRequestArgs,\n  type SignTransactionWithPayloadResponseArgs,\n  type SignTransactionWithRawTxnRequestArgs,\n  type SignTransactionWithRawTxnResponseArgs,\n} from '@identity-connect/wallet-api';\nimport axios, { AxiosError, AxiosInstance, CreateAxiosDefaults, isAxiosError } from 'axios';\nimport { DEFAULT_FRONTEND_URL } from './constants';\nimport { PairingExpiredError, SignatureRequestError } from './errors';\nimport { DappPairingData, DappStateAccessors, windowStateAccessors } from './state';\nimport { CancelToken } from './types';\nimport { validateSignAndSubmitTransactionResponse, validateSignMessageResponse } from './utils';\n\nconst API_VERSION = '0.2.0' as const;\nconst SIGNING_REQUEST_POLLING_INTERVAL = 2500;\nconst SEQUENCE_NUMBER_MISMATCH_PATTERN = /^Sequence number mismatch, expected (?:\\S+ to be )?(\\d+)/;\n\nasync function waitFor(milliseconds: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n}\n\nasync function withRetries<Response>(\n  requestFn: () => Promise<Response>,\n  onError: (err: any) => void,\n  retries: number = 1,\n) {\n  for (let i = 0; i < retries; i += 1) {\n    try {\n      return await requestFn();\n    } catch (err) {\n      onError(err);\n    }\n  }\n  return requestFn();\n}\n\nexport interface SignRequestOptions {\n  cancelToken?: CancelToken;\n  networkName?: NetworkName;\n}\n\nexport type OnDisconnectListener = (address: string) => void;\nexport type OnDisconnectListenerCleanup = () => void;\n\nexport interface ACPairingClientConfig {\n  accessors?: DappStateAccessors;\n  axiosConfig?: CreateAxiosDefaults;\n  defaultNetworkName?: NetworkName;\n}\n\nexport class ACPairingClient {\n  protected readonly accessors: DappStateAccessors;\n  private readonly defaultNetworkName: NetworkName;\n  protected readonly axiosInstance: AxiosInstance;\n  private readonly initPromise?: Promise<void>;\n\n  constructor({\n    accessors = windowStateAccessors,\n    axiosConfig,\n    defaultNetworkName = NetworkName.MAINNET,\n  }: ACPairingClientConfig = {}) {\n    this.accessors = accessors;\n    this.defaultNetworkName = defaultNetworkName;\n    this.axiosInstance = axios.create({\n      baseURL: DEFAULT_FRONTEND_URL,\n      ...axiosConfig,\n    });\n\n    const isClientSideRendering = typeof window !== 'undefined';\n    this.initPromise = isClientSideRendering ? this.syncFirstPairing() : undefined;\n  }\n\n  private async getPairing(id: string) {\n    const response = await this.axiosInstance.get<GetPairingSerializedResponse>(`v1/pairing/${id}/`);\n    return response.data.data.pairing;\n  }\n\n  private async syncFirstPairing() {\n    const pairings = await this.accessors.getAll();\n    const firstPairing = Object.values(pairings)[0];\n    if (firstPairing === undefined) {\n      return;\n    }\n\n    try {\n      const { dappSpecificWallet, maxDappSequenceNumber } = await this.getPairing(firstPairing.pairingId);\n      await this.accessors.update(firstPairing.accountAddress, {\n        ...firstPairing,\n        currSequenceNumber: maxDappSequenceNumber,\n        dappWalletId: dappSpecificWallet?.id,\n      });\n    } catch (err) {\n      await this.accessors.update(firstPairing.accountAddress, undefined);\n    }\n  }\n\n  private async createSigningRequest<TRequestBody>(\n    pairing: DappPairingData,\n    type: string,\n    networkName: NetworkName,\n    requestBody: TRequestBody,\n  ) {\n    const dappEd25519SecretKey = decodeBase64(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = decodeBase64(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = decodeBase64(pairing.accountTransportEd25519PublicKeyB64);\n\n    let sequenceNumber = pairing.currSequenceNumber + 1;\n    return withRetries(\n      async () => {\n        const requestEnvelope = await encryptAndSignEnvelope<any, any>(\n          toKey(dappEd25519SecretKey, KeyTypes.Ed25519SecretKey),\n          toKey(dappEd25519PublicKey, KeyTypes.Ed25519PublicKey),\n          toKey(accountTransportEd25519PublicKey, KeyTypes.Ed25519PublicKey),\n          sequenceNumber,\n          { apiVersion: API_VERSION, networkName, requestType: type },\n          requestBody,\n        );\n\n        const response = await this.axiosInstance.post<CreateSigningRequestSerializedResponse>(\n          `v1/pairing/${pairing.pairingId}/signing-request/`,\n          requestEnvelope,\n        );\n\n        await this.accessors.update(pairing.accountAddress, {\n          ...pairing,\n          currSequenceNumber: sequenceNumber,\n        });\n\n        return response.data.data.signingRequest;\n      },\n      (err) => {\n        if (isAxiosError(err)) {\n          const errorMessage: string = err.response?.data?.message;\n          const expectedSequenceNumber = errorMessage?.match(SEQUENCE_NUMBER_MISMATCH_PATTERN)?.[1];\n          if (expectedSequenceNumber !== undefined) {\n            sequenceNumber = Number(expectedSequenceNumber);\n            return;\n          }\n        }\n        throw err;\n      },\n    );\n  }\n\n  private async getSigningRequest(id: string) {\n    const response = await this.axiosInstance.get<GetSigningRequestSerializedResponse | undefined>(\n      `v1/signing-request/${id}/`,\n      {\n        validateStatus: (status) => status === 200 || status === 404,\n      },\n    );\n    return response.data?.data?.signingRequest;\n  }\n\n  protected async deletePairing(pairingId: string, secretKey: Ed25519SecretKey, publicKey: Ed25519PublicKey) {\n    const requestEnvelope = await encryptAndSignEnvelope<any, any>(\n      secretKey,\n      publicKey,\n      publicKey,\n      0, // ignored\n      {},\n      {},\n    );\n\n    await this.axiosInstance.post<CreateSigningRequestSerializedResponse>(\n      `v1/pairing/${pairingId}/delete/`,\n      requestEnvelope,\n      { validateStatus: (status) => status === 204 || status === 404 },\n    );\n  }\n\n  async cancelSigningRequest(pairing: DappPairingData, id: string) {\n    const sequenceNumber = pairing.currSequenceNumber;\n    const dappEd25519SecretKey = decodeBase64(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = decodeBase64(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = decodeBase64(pairing.accountTransportEd25519PublicKeyB64);\n\n    const requestEnvelope = await encryptAndSignEnvelope<any, any>(\n      toKey(dappEd25519SecretKey, KeyTypes.Ed25519SecretKey),\n      toKey(dappEd25519PublicKey, KeyTypes.Ed25519PublicKey),\n      toKey(accountTransportEd25519PublicKey, KeyTypes.Ed25519PublicKey),\n      sequenceNumber + 1,\n      {},\n      {},\n    );\n\n    const response = await this.axiosInstance.patch<CancelSigningRequestSerializedResponse>(\n      `v1/signing-request/${id}/cancel/`,\n      requestEnvelope,\n    );\n\n    // TODO: auto-sync sequence number on error\n    await this.accessors.update(pairing.accountAddress, {\n      ...pairing,\n      currSequenceNumber: sequenceNumber + 1,\n    });\n\n    return response.data.data.signingRequest;\n  }\n\n  private async signRequest<TRequestBody, TResponseBody>(\n    address: string,\n    type: SigningRequestTypes,\n    requestBody: TRequestBody,\n    { cancelToken, networkName }: SignRequestOptions = {},\n  ) {\n    await this.initPromise;\n    const pairing = await this.accessors.get(address);\n    if (pairing === undefined) {\n      throw new Error('The requested account is not paired');\n    }\n\n    let signingRequest: SerializedDate<SigningRequestData>;\n\n    try {\n      signingRequest = await this.createSigningRequest<TRequestBody>(\n        pairing,\n        type,\n        networkName || this.defaultNetworkName,\n        requestBody,\n      );\n\n      while (signingRequest.status === 'PENDING') {\n        await waitFor(SIGNING_REQUEST_POLLING_INTERVAL);\n        if (cancelToken?.cancelled) {\n          // TODO: send cancel request\n          signingRequest.status = SigningRequestStatus.CANCELLED;\n          break;\n        }\n        signingRequest = (await this.getSigningRequest(signingRequest.id)) ?? signingRequest;\n      }\n    } catch (err) {\n      if (isAxiosError(err) && err.code === '404') {\n        await this.accessors.update(address, undefined);\n        for (const listener of this.onDisconnectListeners) {\n          listener(address);\n        }\n        throw new PairingExpiredError();\n      }\n      throw err;\n    }\n\n    if (signingRequest.status !== 'APPROVED') {\n      throw new SignatureRequestError(signingRequest.status);\n    }\n\n    const decrypted = decryptEnvelope<{}, TResponseBody & {}>(\n      toKey(decodeBase64(pairing.accountTransportEd25519PublicKeyB64), KeyTypes.Ed25519PublicKey),\n      toKey(decodeBase64(pairing.dappEd25519SecretKeyB64), KeyTypes.Ed25519SecretKey),\n      signingRequest.responseEnvelope!,\n    );\n    return decrypted.privateMessage;\n  }\n\n  // region Public API\n\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async addPairing({ publicKey, secretKey }: Ed25519KeyPair, finalizedPairing: SerializedDate<FinalizedPairingData>) {\n    await this.accessors.update(finalizedPairing.account.accountAddress, {\n      accountAddress: finalizedPairing.account.accountAddress,\n      accountAlias: finalizedPairing.account.userSubmittedAlias ?? undefined,\n      accountPublicKeyB64: finalizedPairing.account.publicKeyB64,\n      accountTransportEd25519PublicKeyB64: finalizedPairing.account.transportEd25519PublicKeyB64,\n      currSequenceNumber: finalizedPairing.maxDappSequenceNumber,\n      dappEd25519PublicKeyB64: encodeBase64(publicKey.key),\n      dappEd25519SecretKeyB64: encodeBase64(secretKey.key),\n      dappWalletId: finalizedPairing.dappSpecificWalletId,\n      pairingId: finalizedPairing.id,\n    });\n  }\n\n  async disconnect(address: string) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === undefined) {\n      throw new Error('The specified account is not paired');\n    }\n\n    const dappEd25519SecretKey = decodeBase64(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = decodeBase64(pairing.dappEd25519PublicKeyB64);\n    await this.deletePairing(\n      pairing.pairingId,\n      toKey(dappEd25519SecretKey, KeyTypes.Ed25519SecretKey),\n      toKey(dappEd25519PublicKey, KeyTypes.Ed25519PublicKey),\n    );\n    await this.accessors.update(address, undefined);\n    for (const listener of this.onDisconnectListeners) {\n      listener(address);\n    }\n  }\n\n  async signMessage(address: string, args: SignMessageRequestArgs, options?: SignRequestOptions) {\n    const response = await this.signRequest<SignMessageRequestArgs, SignMessageResponseArgs>(\n      address,\n      SigningRequestTypes.SIGN_MESSAGE,\n      args,\n      options,\n    );\n    validateSignMessageResponse(response);\n    return response;\n  }\n\n  // region signTransaction\n\n  async signTransaction(\n    address: string,\n    args: SignTransactionWithPayloadRequestArgs,\n    options?: SignRequestOptions,\n  ): Promise<SignTransactionWithPayloadResponseArgs>;\n\n  async signTransaction(\n    address: string,\n    args: SignTransactionWithRawTxnRequestArgs,\n    options?: SignRequestOptions,\n  ): Promise<SignTransactionWithRawTxnResponseArgs>;\n\n  async signTransaction(\n    address: string,\n    args: SignTransactionRequestArgs,\n    options?: SignRequestOptions,\n  ): Promise<SignTransactionResponseArgs>;\n\n  async signTransaction(\n    address: string,\n    args: SignTransactionRequestArgs,\n    options?: SignRequestOptions,\n  ): Promise<SignTransactionResponseArgs> {\n    const serializedRequestArgs = serializeSignTransactionRequestArgs(args);\n    const serializedResponseArgs = await this.signRequest<\n      SerializedSignTransactionRequestArgs,\n      SerializedSignTransactionResponseArgs\n    >(address, SigningRequestTypes.SIGN_TRANSACTION, serializedRequestArgs, options);\n    return deserializeSignTransactionResponseArgs(serializedResponseArgs);\n  }\n\n  // endregion\n\n  async signAndSubmitTransaction(\n    address: string,\n    args: SignAndSubmitTransactionRequestArgs,\n    options?: SignRequestOptions,\n  ): Promise<SignAndSubmitTransactionResponseArgs> {\n    const serializedRequestArgs = serializeSignAndSubmitTransactionRequestArgs(args);\n    try {\n      const responseArgs = await this.signRequest<\n        SerializedSignAndSubmitTransactionRequestArgs,\n        SignAndSubmitTransactionResponseArgs\n      >(address, SigningRequestTypes.SIGN_AND_SUBMIT_TRANSACTION, serializedRequestArgs, options);\n      validateSignAndSubmitTransactionResponse(responseArgs);\n      return responseArgs;\n    } catch (e) {\n      if (e instanceof AxiosError && e.response?.data?.message) {\n        throw new Error(e.response?.data?.message);\n      }\n      throw e;\n    }\n  }\n\n  async getConnectedAccounts() {\n    await this.initPromise;\n    const pairings = await this.accessors.getAll();\n    return Object.values(pairings).map<AccountInfo>(\n      ({ accountAddress, accountEd25519PublicKeyB64, accountPublicKeyB64 }) => ({\n        address: AccountAddress.from(accountAddress),\n        publicKey:\n          accountPublicKeyB64 !== undefined\n            ? deserializePublicKeyB64(accountPublicKeyB64)\n            : deserializeEd25519PublicKeyB64(accountEd25519PublicKeyB64),\n      }),\n    );\n  }\n\n  // endregion\n\n  private readonly onDisconnectListeners = new Set<OnDisconnectListener>();\n\n  onDisconnect(listener: OnDisconnectListener): OnDisconnectListenerCleanup {\n    this.onDisconnectListeners.add(listener);\n    return () => this.onDisconnectListeners.delete(listener);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { SigningRequestStatus } from '@identity-connect/api';\n\nexport class SignatureRequestError extends Error {\n  constructor(status: SigningRequestStatus) {\n    super(status);\n    this.name = 'SignatureRequestError';\n    Object.setPrototypeOf(this, SignatureRequestError.prototype);\n  }\n}\n\nexport class UnexpectedSignatureResponseError extends Error {\n  constructor(missingFields: string[]) {\n    const message = `Missing the following fields: ${missingFields.join(', ')}`;\n    super(message);\n    this.name = 'UnexpectedSignatureResponseError';\n    Object.setPrototypeOf(this, UnexpectedSignatureResponseError.prototype);\n  }\n}\n\nexport class PairingExpiredError extends Error {\n  constructor() {\n    super();\n    this.name = 'PairingExpiredError';\n    Object.setPrototypeOf(this, PairingExpiredError.prototype);\n  }\n}\n\nexport class UnregisteredDappError extends Error {\n  constructor() {\n    super('Dapp ID is invalid or not associated with a registered Dapp.');\n    this.name = 'UnregisteredDappError';\n    Object.setPrototypeOf(this, UnregisteredDappError.prototype);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport interface BaseDappPairingData {\n  accountAddress: string;\n  accountAlias?: string;\n  accountTransportEd25519PublicKeyB64: string;\n  currSequenceNumber: number;\n  dappEd25519PublicKeyB64: string;\n  dappEd25519SecretKeyB64: string;\n  dappWalletId?: string;\n  pairingId: string;\n}\n\n// Keeping this temporarily for backward compatibility\nexport interface PrevDappPairingData extends BaseDappPairingData {\n  accountEd25519PublicKeyB64: string;\n  accountPublicKeyB64?: undefined;\n}\n\nexport interface CurrDappPairingData extends BaseDappPairingData {\n  accountEd25519PublicKeyB64?: undefined;\n  accountPublicKeyB64: string;\n}\n\nexport type DappPairingData = PrevDappPairingData | CurrDappPairingData;\n\nexport type DappPairingDataMap = { [address: string]: DappPairingData };\n\nexport interface DappStateAccessors {\n  get: (address: string) => Promise<DappPairingData | undefined>;\n  getAll: () => Promise<DappPairingDataMap>;\n  update: (address: string, pairing?: DappPairingData) => Promise<void>;\n}\n\nexport const DAPP_PAIRINGS_WINDOW_STORAGE_KEY = 'icDappPairings';\n\n/**\n * Default implementation of DappStateAccessors that uses the Window localStorage API.\n * This should work for most dapps.\n */\nexport const windowStateAccessors: DappStateAccessors = {\n  async get(address: string) {\n    const pairings = await this.getAll();\n    return pairings[address];\n  },\n  async getAll() {\n    const serialized = window.localStorage.getItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY);\n    return serialized ? (JSON.parse(serialized) as DappPairingDataMap) : {};\n  },\n  async update(address: string, pairing?: DappPairingData) {\n    const pairings = await this.getAll();\n    if (pairing === undefined) {\n      delete pairings[address];\n    } else {\n      pairings[address] = pairing;\n    }\n    const newSerialized = JSON.stringify(pairings);\n    window.localStorage.setItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY, newSerialized);\n  },\n};\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { SignAndSubmitTransactionResponseArgs, SignMessageResponseArgs } from '@identity-connect/wallet-api';\nimport { UnexpectedSignatureResponseError } from './errors';\n\nconst SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS: (keyof SignMessageResponseArgs)[] = [\n  'address',\n  'application',\n  'chainId',\n  'fullMessage',\n  'message',\n  'nonce',\n  'prefix',\n  'signature',\n];\n\nexport function validateSignMessageResponse(response: SignMessageResponseArgs) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS.filter((field) => !providedFields.has(field));\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\n\nconst SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS: (keyof SignAndSubmitTransactionResponseArgs)[] = ['hash'];\n\nexport function validateSignAndSubmitTransactionResponse(response: SignAndSubmitTransactionResponseArgs) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS.filter(\n    (field) => !providedFields.has(field),\n  );\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { CreatePairingSerializedResponse, FinalizedPairingData, SerializedDate } from '@identity-connect/api';\nimport { createEd25519KeyPair, encodeBase64 } from '@identity-connect/crypto';\nimport { isAxiosError } from 'axios';\nimport { DEFAULT_FRONTEND_URL } from './constants';\nimport { UnregisteredDappError } from './errors';\nimport { ACPairingClient, ACPairingClientConfig } from './PairingClient';\nimport { openPrompt, waitForPromptResponse } from './prompt';\n\nexport interface ICDappClientConfig extends ACPairingClientConfig {\n  frontendBaseURL?: string;\n}\n\nexport class ICDappClient extends ACPairingClient {\n  private readonly frontendBaseURL: string;\n\n  constructor(\n    private readonly dappId: string,\n    { frontendBaseURL = DEFAULT_FRONTEND_URL, ...pairingClientConfig }: ICDappClientConfig = {},\n  ) {\n    super(pairingClientConfig);\n    this.frontendBaseURL = frontendBaseURL;\n  }\n\n  private async createPairingRequest(dappEd25519PublicKeyB64: string) {\n    try {\n      const response = await this.axiosInstance.post<CreatePairingSerializedResponse>('v1/pairing/', {\n        dappEd25519PublicKeyB64,\n        dappId: this.dappId,\n      });\n      return response.data.data.pairing;\n    } catch (err) {\n      // TODO: export typed errors from API\n      if (isAxiosError(err) && err.response?.data?.message === 'Dapp not found') {\n        throw new UnregisteredDappError();\n      }\n      throw err;\n    }\n  }\n\n  // region Public API\n\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async connect() {\n    const { publicKey, secretKey } = createEd25519KeyPair();\n    const dappEd25519PublicKeyB64 = encodeBase64(publicKey.key);\n\n    // Open the prompt without pairingId (for a snappier ux)\n    const url = new URL(`${this.frontendBaseURL}/pairing`);\n    const promptWindow = await openPrompt(url.href);\n\n    let pairingId: string;\n    try {\n      const pendingPairing = await this.createPairingRequest(dappEd25519PublicKeyB64);\n      pairingId = pendingPairing.id;\n    } catch (err) {\n      // Close the prompt and have the dapp handle the error\n      promptWindow.close();\n      throw err;\n    }\n\n    // Update the prompt's URL as soon as a pairingId is available\n    url.searchParams.set('pairingId', pairingId);\n    promptWindow.location.href = url.href;\n    const promptResponse = await waitForPromptResponse<SerializedDate<FinalizedPairingData>>(promptWindow);\n\n    if (promptResponse.status === 'dismissed') {\n      // Ignore the result. This is just a courtesy call, so if anything goes wrong\n      // the pairing will be removed during scheduled cleanup)\n      void this.deletePairing(pairingId, secretKey, publicKey);\n      return undefined;\n    }\n\n    const finalizedPairing = promptResponse.args;\n    await this.addPairing({ publicKey, secretKey }, finalizedPairing);\n\n    return finalizedPairing.account.accountAddress;\n  }\n\n  async offboard(address: string) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === undefined) {\n      throw new Error('This account is not paired');\n    }\n\n    const walletId = pairing.dappWalletId;\n    if (walletId === undefined) {\n      throw new Error('This account cannot be offboarded');\n    }\n\n    const url = new URL(`${this.frontendBaseURL}/offboarding?walletId=${walletId}`);\n    const promptWindow = openPrompt(url);\n    const response = await waitForPromptResponse<{ offboarded: boolean }>(promptWindow);\n    if (response.status === 'approved' && response.args.offboarded) {\n      // If exported, disconnect the pairing to clean up\n      this.disconnect(address);\n      return true;\n    }\n    return false;\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nconst DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nconst PROMPT_POLLER_INTERVAL = 500;\n\nexport function openPrompt(url: string | URL, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width,\n  };\n\n  const strOptions = Object.entries(options)\n    .map(([key, value]) => `${key}=${JSON.stringify(value)}`)\n    .reduce((acc, entry) => `${acc}, ${entry}`);\n\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, undefined, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n\n  return promptWindow;\n}\n\nexport interface PromptApproval<TResponseArgs> {\n  args: TResponseArgs;\n  status: 'approved';\n}\n\nexport interface PromptDismissal {\n  status: 'dismissed';\n}\n\nexport type PromptResponse<TResponseArgs> = PromptApproval<TResponseArgs> | PromptDismissal;\n\nexport async function waitForPromptResponse<TResponseArgs>(promptWindow: Window) {\n  return new Promise<PromptResponse<TResponseArgs>>((resolve) => {\n    const listeners = {\n      onMessage: (message: MessageEvent) => {\n        if (message.source !== promptWindow) {\n          return;\n        }\n        window.removeEventListener('message', listeners.onMessage);\n        clearTimeout(listeners.promptPollerId);\n        resolve({\n          args: message.data,\n          status: 'approved',\n        });\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener('message', listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve({\n            status: 'dismissed',\n          });\n        }\n      }, PROMPT_POLLER_INTERVAL),\n    };\n\n    window.addEventListener('message', listeners.onMessage);\n  });\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  ConnectRequest,\n  ConnectResponse,\n  type DappInfo,\n  DisconnectRequest,\n  GetConnectedAccountsRequest,\n  GetConnectedAccountsResponse,\n  IsConnectedRequest,\n  IsConnectedResponse,\n  SignAndSubmitTransactionRequest,\n  SignAndSubmitTransactionResponse,\n  SignMessageRequest,\n  SignMessageResponse,\n  SignTransactionRequest,\n  SignTransactionResponse,\n} from '@aptos-connect/wallet-api';\nimport { WebWalletTransport } from '@aptos-connect/web-transport';\nimport { NetworkName } from '@identity-connect/api';\nimport { DEFAULT_FRONTEND_URL } from './constants';\n\nexport interface ACKeylessClientConfig {\n  dappImageURI?: string;\n  dappName?: string;\n  defaultNetworkName?: NetworkName;\n  frontendBaseURL?: string;\n  provider?: 'google' | 'apple';\n}\n\nexport class ACKeylessClient {\n  private readonly defaultNetworkName: NetworkName;\n\n  readonly dappInfo: DappInfo;\n\n  private readonly transport: WebWalletTransport;\n\n  constructor({\n    dappImageURI,\n    dappName,\n    defaultNetworkName = NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL,\n    provider = 'google',\n  }: ACKeylessClientConfig = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title,\n    };\n\n    this.transport = new WebWalletTransport(frontendBaseURL, provider);\n  }\n\n  // region Public API\n\n  async isConnected() {\n    const serializedRequest = IsConnectedRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = IsConnectedResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async getConnectedAccounts() {\n    const serializedRequest = GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async disconnect() {\n    const serializedRequest = DisconnectRequest.serialize(this.dappInfo);\n    await this.transport.sendRequest(serializedRequest);\n  }\n\n  async connect() {\n    const serializedRequest = ConnectRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = ConnectResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async signMessage(args: SignMessageRequest.Args) {\n    const serializedRequest = SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async signTransaction(\n    args: SignTransactionRequest.Args | SignTransactionRequest.ArgsWithTransaction,\n  ): Promise<SignTransactionResponse.Args> {\n    const normalizedArgs = 'transaction' in args ? SignTransactionRequest.normalizeArgs(args) : args;\n    const serializedRequest = SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  async signAndSubmitTransaction(args: SignAndSubmitTransactionRequest.Args) {\n    const serializedRequest = SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n\n  // endregion\n}\n"],"names":["AccountAddress","AptosConfig","NetworkName","encodeBase64","AccountAddress","AccountAddress","NetworkName","AccountAddress","encodeBase64","AptosConfig","createEd25519KeyPair","encodeBase64","isAxiosError","isAxiosError","createEd25519KeyPair","encodeBase64","ConnectRequest","ConnectResponse","DisconnectRequest","GetConnectedAccountsRequest","GetConnectedAccountsResponse","SignAndSubmitTransactionRequest","SignAndSubmitTransactionResponse","SignMessageRequest","SignMessageResponse","SignTransactionRequest","SignTransactionResponse","WebWalletTransport","NetworkName","NetworkName","WebWalletTransport","GetConnectedAccountsRequest","GetConnectedAccountsResponse","DisconnectRequest","ConnectRequest","ConnectResponse","SignMessageRequest","SignMessageResponse","SignTransactionRequest","SignTransactionResponse","SignAndSubmitTransactionRequest","SignAndSubmitTransactionResponse"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9],"debugId":null}},
    {"offset": {"line": 3392, "column": 0}, "map": {"version":3,"sources":["file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/index.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/AptosConnectGoogleWallet.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/AptosConnectWallet.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/AptosConnectAccount.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/helpers.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/config.ts","file:///home/enliven/Desktop/aptos/aptopos/node_modules/%40aptos-connect/wallet-adapter-plugin/src/AptosConnectAppleWallet.ts"],"sourcesContent":["// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { registerWallet } from '@aptos-labs/wallet-standard';\nimport { AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { AptosConnectGoogleWallet } from './AptosConnectGoogleWallet';\nimport { AptosConnectAppleWallet } from './AptosConnectAppleWallet';\n\nexport * from './AptosConnectAccount';\nexport * from './AptosConnectWallet';\nexport { AptosConnectGoogleWallet, AptosConnectAppleWallet };\n\nexport function registerAptosConnect(config: AptosConnectWalletConfig = {}) {\n  const googleWalletPlugin = new AptosConnectGoogleWallet(config);\n  const appleWalletPlugin = new AptosConnectAppleWallet(config);\n  registerWallet(googleWalletPlugin);\n  registerWallet(appleWalletPlugin);\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AptosConnectNamespace,\n  AptosDisconnectNamespace,\n  AptosFeatures,\n  AptosGetAccountNamespace,\n  AptosGetNetworkNamespace,\n  AptosOnAccountChangeNamespace,\n  AptosOnNetworkChangeNamespace,\n  AptosSignAndSubmitTransactionFeature,\n  AptosSignAndSubmitTransactionNamespace,\n  AptosSignInNamespace,\n  AptosSignMessageNamespace,\n  AptosSignTransactionNamespace,\n  AptosWallet,\n} from '@aptos-labs/wallet-standard';\nimport { AptosConnectWallet, AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { walletMetadata } from './config';\n\nexport class AptosConnectGoogleWallet extends AptosConnectWallet implements AptosWallet {\n  readonly name = walletMetadata.google.name;\n\n  readonly icon = walletMetadata.google.icon;\n\n  readonly url = walletMetadata.google.url;\n\n  constructor(config: AptosConnectWalletConfig) {\n    super({ ...config, provider: 'google' });\n  }\n\n  // region AptosWallet\n\n  get features(): AptosFeatures & AptosSignAndSubmitTransactionFeature {\n    return {\n      [AptosConnectNamespace]: {\n        connect: this.connect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosDisconnectNamespace]: {\n        disconnect: this.disconnect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetAccountNamespace]: {\n        account: this.getAccount.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetNetworkNamespace]: {\n        network: this.getNetwork.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnAccountChangeNamespace]: {\n        onAccountChange: this.onAccountChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnNetworkChangeNamespace]: {\n        onNetworkChange: this.onNetworkChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignAndSubmitTransactionNamespace]: {\n        signAndSubmitTransaction: this.signAndSubmitTransaction.bind(this),\n        version: '1.1.0',\n      },\n      [AptosSignInNamespace]: {\n        signIn: this.signIn.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignMessageNamespace]: {\n        signMessage: this.signMessage.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignTransactionNamespace]: {\n        signTransaction: this.signTransaction.bind(this),\n        version: '1.1',\n      },\n    };\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { ClaimOptions } from '@aptos-connect/wallet-api';\nimport {\n  AccountAddress,\n  AccountAuthenticator,\n  AnyRawTransaction,\n  Aptos,\n  AptosConfig,\n  Ed25519PrivateKey,\n  HexInput,\n  MultiAgentTransaction,\n  Network,\n  NetworkToNodeAPI,\n  SimpleTransaction,\n} from '@aptos-labs/ts-sdk';\nimport {\n  AccountInfo,\n  APTOS_CHAINS,\n  AptosSignAndSubmitTransactionInput,\n  AptosSignAndSubmitTransactionOutput,\n  AptosSignInInput,\n  AptosSignInOutput,\n  AptosSignMessageInput,\n  AptosSignMessageOutput,\n  AptosSignTransactionInputV1_1,\n  AptosSignTransactionOutputV1_1,\n  AptosWalletError,\n  AptosWalletErrorCode,\n  NetworkInfo,\n  UserResponse,\n  UserResponseStatus,\n} from '@aptos-labs/wallet-standard';\nimport { deserializePublicKeyB64, serializePublicKeyB64 } from '@identity-connect/crypto';\nimport { ACDappClient, ACDappClientConfig } from '@identity-connect/dapp-sdk';\nimport { AptosConnectAccount } from './AptosConnectAccount';\nimport { customAccountToStandardAccount, networkToChainId, unwrapUserResponse } from './helpers';\n\ninterface SerializedCurrentAccount {\n  address: string;\n  publicKey: string;\n}\n\ntype WithSSOProvider<T> = T & {\n  provider: 'google' | 'apple';\n};\n\nexport interface AptosConnectWalletConfig extends Omit<ACDappClientConfig, 'defaultNetworkName' | 'provider'> {\n  claimSecretKey?: HexInput;\n  network?: Network;\n  preferredWalletName?: string;\n}\n\nexport abstract class AptosConnectWallet {\n  // region connectedAccount\n\n  protected static connectedAccountStorageKey = '@aptos-connect/connectedAccount';\n\n  protected static get connectedAccount(): AccountInfo | undefined {\n    const serialized = localStorage.getItem(AptosConnectWallet.connectedAccountStorageKey);\n    if (!serialized) {\n      return undefined;\n    }\n\n    try {\n      const { address, publicKey } = JSON.parse(serialized) as SerializedCurrentAccount;\n      return new AccountInfo({\n        address: AccountAddress.from(address),\n        publicKey: deserializePublicKeyB64(publicKey),\n      });\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.warn('Inconsistent state, resetting it');\n      this.connectedAccount = undefined;\n      return undefined;\n    }\n  }\n\n  protected static set connectedAccount(value: AccountInfo | undefined) {\n    if (value !== undefined) {\n      const serialized: SerializedCurrentAccount = {\n        address: value.address.toString(),\n        publicKey: serializePublicKeyB64(value.publicKey),\n      };\n      localStorage.setItem(AptosConnectWallet.connectedAccountStorageKey, JSON.stringify(serialized));\n    } else {\n      localStorage.removeItem(AptosConnectWallet.connectedAccountStorageKey);\n    }\n  }\n\n  // endregion\n\n  // region AptosWallet\n\n  readonly version = '1.0.0';\n\n  readonly chains = APTOS_CHAINS;\n\n  // eslint-disable-next-line class-methods-use-this\n  get accounts() {\n    const { connectedAccount } = AptosConnectWallet;\n    return connectedAccount ? [new AptosConnectAccount(connectedAccount)] : [];\n  }\n\n  // endregion\n\n  // PetraWallet\n\n  private readonly aptosClient: Aptos;\n\n  private readonly client: ACDappClient;\n\n  private readonly preferredWalletName?: string;\n  private readonly claimOptions?: ClaimOptions;\n\n  constructor({\n    claimSecretKey,\n    network = Network.MAINNET,\n    preferredWalletName,\n    ...clientConfig\n  }: WithSSOProvider<AptosConnectWalletConfig>) {\n    this.client = new ACDappClient(clientConfig);\n\n    if (!NetworkToNodeAPI[network]) {\n      throw new Error('Network not supported');\n    }\n\n    const aptosConfig = new AptosConfig({ network });\n    this.aptosClient = new Aptos(aptosConfig);\n    this.preferredWalletName = preferredWalletName;\n    this.claimOptions = claimSecretKey ? { network, secretKey: new Ed25519PrivateKey(claimSecretKey) } : undefined;\n  }\n\n  async connect(): Promise<UserResponse<AccountInfo>> {\n    // If this is an auto-connect, try not opening the prompt\n    const { connectedAccount } = AptosConnectWallet;\n    if (connectedAccount !== undefined) {\n      return { args: connectedAccount, status: UserResponseStatus.APPROVED };\n    }\n\n    const response = await this.client.connect({\n      claimOptions: this.claimOptions,\n      preferredWalletName: this.preferredWalletName,\n    });\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    const newConnectedAccount = customAccountToStandardAccount(response.args.account);\n    AptosConnectWallet.connectedAccount = newConnectedAccount;\n\n    return {\n      args: newConnectedAccount,\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  async disconnect() {\n    const { connectedAccount } = AptosConnectWallet;\n    if (connectedAccount) {\n      await this.client.disconnect(connectedAccount.address);\n      AptosConnectWallet.connectedAccount = undefined;\n    }\n  }\n\n  async signIn(input: AptosSignInInput): Promise<UserResponse<AptosSignInOutput>> {\n    const response = await this.client.signIn({ network: this.aptosClient.config.network, ...input });\n\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    const output = response.args;\n\n    AptosConnectWallet.connectedAccount = output.account;\n\n    return { args: output, status: UserResponseStatus.APPROVED };\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async getAccount(): Promise<AccountInfo> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      // TODO: this function should fail gracefully\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n    return customAccountToStandardAccount(connectedAccount);\n  }\n\n  async getNetwork(): Promise<NetworkInfo> {\n    const { network } = this.aptosClient.config;\n    const chainId = await this.aptosClient.getChainId();\n    const url = NetworkToNodeAPI[network];\n    return {\n      chainId,\n      name: network,\n      url,\n    };\n  }\n\n  async signMessage(input: AptosSignMessageInput): Promise<UserResponse<AptosSignMessageOutput>> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    const chainId = networkToChainId(this.aptosClient.config.network);\n    const { message, nonce } = input;\n\n    const encoder = new TextEncoder();\n    const messageBytes = encoder.encode(message);\n    const nonceBytes = encoder.encode(nonce);\n\n    const response = await this.client.signMessage({\n      chainId,\n      message: messageBytes,\n      nonce: nonceBytes,\n      signerAddress: connectedAccount.address,\n    });\n\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    const { fullMessage, signature } = response.args;\n\n    const extraResponseArgs = {\n      address: connectedAccount.address.toString(),\n      application: this.client.dappInfo.domain,\n      chainId,\n      message,\n      nonce,\n      prefix: 'APTOS' as const,\n    };\n\n    return {\n      args: {\n        fullMessage,\n        signature,\n        ...extraResponseArgs,\n      },\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  async signTransaction(rawTxn: AnyRawTransaction): Promise<UserResponse<AccountAuthenticator>>;\n  async signTransaction(args: AptosSignTransactionInputV1_1): Promise<UserResponse<AptosSignTransactionOutputV1_1>>;\n  async signTransaction(\n    txnOrArgs: AnyRawTransaction | AptosSignTransactionInputV1_1,\n    _asFeePayer?: boolean,\n  ): Promise<UserResponse<AccountAuthenticator | AptosSignTransactionOutputV1_1>> {\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    if ('bcsToBytes' in txnOrArgs) {\n      const transaction = txnOrArgs;\n      const feePayer = transaction.feePayerAddress ? { address: transaction.feePayerAddress } : undefined;\n      const secondarySigners = transaction.secondarySignerAddresses?.map((address) => ({ address }));\n      const response = await this.client.signTransaction({\n        feePayer,\n        secondarySigners,\n        signerAddress: connectedAccount.address,\n        transaction: transaction.rawTransaction,\n      });\n      return unwrapUserResponse(response, (args) => args.authenticator);\n    }\n\n    const requestArgs = txnOrArgs;\n    const response = await this.client.signTransaction({\n      ...requestArgs,\n      signerAddress: connectedAccount.address,\n    });\n\n    return unwrapUserResponse(response, (responseArgs) => {\n      const { authenticator, rawTransaction } = responseArgs;\n      if (!rawTransaction) {\n        throw new Error('Expected raw transaction in response args');\n      }\n\n      const secondarySigners = requestArgs.secondarySigners ?? [];\n      let transaction: AnyRawTransaction;\n      if (secondarySigners.length > 0) {\n        transaction = new MultiAgentTransaction(\n          rawTransaction,\n          secondarySigners.map((s) => s.address),\n          requestArgs.feePayer?.address,\n        );\n      } else {\n        transaction = new SimpleTransaction(rawTransaction, requestArgs.feePayer?.address);\n      }\n\n      return {\n        authenticator,\n        rawTransaction: transaction,\n      };\n    });\n  }\n\n  async signAndSubmitTransaction(\n    args: AptosSignAndSubmitTransactionInput,\n  ): Promise<UserResponse<AptosSignAndSubmitTransactionOutput>> {\n    const { gasUnitPrice, maxGasAmount, payload } = args;\n\n    const { connectedAccount } = AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new AptosWalletError(AptosWalletErrorCode.Unauthorized);\n    }\n\n    const response = await this.client.signAndSubmitTransaction({\n      gasUnitPrice,\n      maxGasAmount,\n      network: this.aptosClient.config.network,\n      payload,\n      signerAddress: connectedAccount.address,\n    });\n\n    if (response.status === 'dismissed') {\n      return { status: UserResponseStatus.REJECTED };\n    }\n\n    return {\n      args: { hash: response.args.txnHash },\n      status: UserResponseStatus.APPROVED,\n    };\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async onAccountChange(_callback?: (newAccount: AccountInfo) => void): Promise<void> {\n    // TODO\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async onNetworkChange(_callback?: (newNetwork: NetworkInfo) => void): Promise<void> {\n    // Not applicable\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AccountAddress,\n  AnyPublicKey,\n  Ed25519PublicKey,\n  MultiEd25519PublicKey,\n  MultiKey,\n  PublicKey,\n  SigningScheme,\n} from '@aptos-labs/ts-sdk';\nimport { AccountInfo, APTOS_CHAINS, AptosWalletAccount } from '@aptos-labs/wallet-standard';\n\nexport class AptosConnectAccount implements AptosWalletAccount {\n  // region AptosWalletAccount\n\n  readonly chains = APTOS_CHAINS;\n\n  get address() {\n    return this.#address.toString();\n  }\n\n  get publicKey() {\n    return this.#publicKey.toUint8Array();\n  }\n\n  get signingScheme() {\n    if (this.#publicKey instanceof Ed25519PublicKey) {\n      return SigningScheme.Ed25519;\n    }\n    if (this.#publicKey instanceof MultiEd25519PublicKey) {\n      return SigningScheme.MultiEd25519;\n    }\n    if (this.#publicKey instanceof AnyPublicKey) {\n      return SigningScheme.SingleKey;\n    }\n    if (this.#publicKey instanceof MultiKey) {\n      return SigningScheme.MultiKey;\n    }\n    throw new Error('Unsupported public key type');\n  }\n\n  readonly label?: string;\n\n  readonly features = [];\n\n  // endregion\n\n  // region PetraAccount\n\n  readonly #address: AccountAddress;\n\n  readonly #publicKey: PublicKey;\n\n  constructor({ address, ansName, publicKey }: AccountInfo) {\n    this.#publicKey = publicKey;\n    this.#address = address;\n    this.label = ansName;\n  }\n\n  // endregion\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AccountInfo as ACAccountInfo, UserResponse as ACUserResponse } from '@aptos-connect/wallet-api';\nimport { Network, NetworkToChainId } from '@aptos-labs/ts-sdk';\nimport { AccountInfo, UserResponse, UserResponseStatus } from '@aptos-labs/wallet-standard';\n\nexport function customAccountToStandardAccount({ address, name, publicKey }: ACAccountInfo) {\n  return new AccountInfo({\n    address,\n    ansName: name,\n    publicKey,\n  });\n}\n\nexport function unwrapUserResponse<T, U>(response: ACUserResponse<T>, callback: (args: T) => U): UserResponse<U> {\n  if (response.status === 'dismissed') {\n    return { status: UserResponseStatus.REJECTED };\n  }\n  return { args: callback(response.args), status: UserResponseStatus.APPROVED };\n}\n\nexport function networkToChainId(network: Network): number {\n  switch (network) {\n    case Network.MAINNET:\n      return NetworkToChainId.mainnet;\n    case Network.TESTNET:\n      return NetworkToChainId.testnet;\n    default:\n      return NetworkToChainId.devnet;\n  }\n}\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nexport const walletMetadata = {\n  apple: {\n    icon:\n      // eslint-disable-next-line max-len\n      'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxzdHlsZT4KICAgICAgICBwYXRoIHsKICAgICAgICAgICAgZmlsbDogYmxhY2s7CiAgICAgICAgfQoKICAgICAgICBAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CiAgICAgICAgICAgIHBhdGggewogICAgICAgICAgICAgICAgZmlsbDogd2hpdGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICA8L3N0eWxlPgogICAgPHBhdGgKICAgICAgICBkPSJNMjAuMzkzMiA4LjE4MjQyQzIwLjI1NzggOC4yOTA0MyAxNy44NjggOS42NzUzNyAxNy44NjggMTIuNzU0OUMxNy44NjggMTYuMzE2OCAyMC45MDkgMTcuNTc3IDIxIDE3LjYwODJDMjAuOTg2IDE3LjY4NSAyMC41MTY5IDE5LjMzMzkgMTkuMzk2NiAyMS4wMTQxQzE4LjM5NzcgMjIuNDkyNiAxNy4zNTQ1IDIzLjk2ODggMTUuNzY3NSAyMy45Njg4QzE0LjE4MDQgMjMuOTY4OCAxMy43NzIgMjMuMDIwNyAxMS45Mzk5IDIzLjAyMDdDMTAuMTU0NSAyMy4wMjA3IDkuNTE5NzIgMjQgOC4wNjgwNSAyNEM2LjYxNjM5IDI0IDUuNjAzNDkgMjIuNjMxOSA0LjQzODg5IDIwLjk1MTdDMy4wODk5MiAxOC45Nzg3IDIgMTUuOTEzNiAyIDEzLjAwNDVDMiA4LjMzODQzIDQuOTUwMDEgNS44NjM3OSA3Ljg1MzM0IDUuODYzNzlDOS4zOTYwMiA1Ljg2Mzc5IDEwLjY4MiA2LjkwNTQ5IDExLjY1MDUgNi45MDU0OUMxMi41NzI0IDYuOTA1NDkgMTQuMDEwMSA1LjgwMTM4IDE1Ljc2NTEgNS44MDEzOEMxNi40MzAzIDUuODAxMzggMTguODIwMiA1Ljg2Mzc5IDIwLjM5MzIgOC4xODI0MlpNMTQuOTMxOSAzLjgyNTk4QzE1LjY1NzggMi45NDAyOSAxNi4xNzEyIDEuNzExMzcgMTYuMTcxMiAwLjQ4MjQ0OEMxNi4xNzEyIDAuMzEyMDMxIDE2LjE1NzIgMC4xMzkyMTQgMTYuMTI2OSAwQzE0Ljk0NiAwLjA0NTYwNDYgMTMuNTQxIDAuODA4ODgxIDEyLjY5MzggMS44MTkzOEMxMi4wMjg2IDIuNTk3MDYgMTEuNDA3OCAzLjgyNTk4IDExLjQwNzggNS4wNzE3MUMxMS40MDc4IDUuMjU4OTMgMTEuNDM4MiA1LjQ0NjE0IDExLjQ1MjIgNS41MDYxNUMxMS41MjY4IDUuNTIwNTUgMTEuNjQ4MiA1LjUzNzM1IDExLjc2OTYgNS41MzczNUMxMi44MjkxIDUuNTM3MzUgMTQuMTYxOCA0LjgwNzY4IDE0LjkzMTkgMy44MjU5OFoiIC8+Cjwvc3ZnPg==',\n    name: 'Continue with Apple',\n    url: 'https://aptosconnect.app',\n  },\n  google: {\n    icon:\n      // eslint-disable-next-line max-len\n      'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0iaF8yMCB3XzIwIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIzLjU0IDEyLjc2MTNDMjMuNTQgMTEuOTQ1OSAyMy40NjY4IDExLjE2MTggMjMuMzMwOSAxMC40MDkxSDEyLjVWMTQuODU3NUgxOC42ODkxQzE4LjQyMjUgMTYuMjk1IDE3LjYxMjMgMTcuNTEyOSAxNi4zOTQzIDE4LjMyODRWMjEuMjEzOEgyMC4xMTA5QzIyLjI4NTUgMTkuMjExOCAyMy41NCAxNi4yNjM2IDIzLjU0IDEyLjc2MTNaIiBmaWxsPSIjNDI4NUY0Ij48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi40OTk1IDIzLjk5OThDMTUuNjA0NSAyMy45OTk4IDE4LjIwNzcgMjIuOTcgMjAuMTEwNCAyMS4yMTM3TDE2LjM5MzggMTguMzI4MkMxNS4zNjQgMTkuMDE4MiAxNC4wNDY3IDE5LjQyNTkgMTIuNDk5NSAxOS40MjU5QzkuNTA0MjUgMTkuNDI1OSA2Ljk2OTAyIDE3LjQwMyA2LjA2NDcgMTQuNjg0OEgyLjIyMjY2VjE3LjY2NDRDNC4xMTQ5MyAyMS40MjI4IDguMDA0MDIgMjMuOTk5OCAxMi40OTk1IDIzLjk5OThaIiBmaWxsPSIjMzRBODUzIj48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjA2NTIzIDE0LjY4NTFDNS44MzUyMyAxMy45OTUxIDUuNzA0NTUgMTMuMjU4MSA1LjcwNDU1IDEyLjUwMDFDNS43MDQ1NSAxMS43NDIyIDUuODM1MjMgMTEuMDA1MSA2LjA2NTIzIDEwLjMxNTFWNy4zMzU1N0gyLjIyMzE4QzEuNDQ0MzIgOC44ODgwNyAxIDEwLjY0NDQgMSAxMi41MDAxQzEgMTQuMzU1OCAxLjQ0NDMyIDE2LjExMjIgMi4yMjMxOCAxNy42NjQ3TDYuMDY1MjMgMTQuNjg1MVoiIGZpbGw9IiNGQkJDMDUiPjwvcGF0aD48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyLjQ5OTUgNS41NzM4NkMxNC4xODc5IDUuNTczODYgMTUuNzAzOCA2LjE1NDA5IDE2Ljg5NTYgNy4yOTM2NEwyMC4xOTQgMy45OTUyM0MxOC4yMDI0IDIuMTM5NTUgMTUuNTk5MiAxIDEyLjQ5OTUgMUM4LjAwNDAyIDEgNC4xMTQ5MyAzLjU3NzA1IDIuMjIyNjYgNy4zMzU0NUw2LjA2NDcgMTAuMzE1QzYuOTY5MDIgNy41OTY4MiA5LjUwNDI1IDUuNTczODYgMTIuNDk5NSA1LjU3Mzg2WiIgZmlsbD0iI0VBNDMzNSI+PC9wYXRoPjwvc3ZnPg==',\n    name: 'Continue with Google',\n    url: 'https://aptosconnect.app',\n  },\n} as const;\n","// Copyright © Aptos\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n  AptosConnectNamespace,\n  AptosDisconnectNamespace,\n  AptosFeatures,\n  AptosGetAccountNamespace,\n  AptosGetNetworkNamespace,\n  AptosOnAccountChangeNamespace,\n  AptosOnNetworkChangeNamespace,\n  AptosSignAndSubmitTransactionFeature,\n  AptosSignAndSubmitTransactionNamespace,\n  AptosSignInNamespace,\n  AptosSignMessageNamespace,\n  AptosSignTransactionNamespace,\n  AptosWallet,\n} from '@aptos-labs/wallet-standard';\nimport { AptosConnectWallet, AptosConnectWalletConfig } from './AptosConnectWallet';\nimport { walletMetadata } from './config';\n\nexport class AptosConnectAppleWallet extends AptosConnectWallet implements AptosWallet {\n  readonly name = walletMetadata.apple.name;\n\n  readonly icon = walletMetadata.apple.icon;\n\n  readonly url = walletMetadata.apple.url;\n\n  constructor(config: AptosConnectWalletConfig) {\n    super({ ...config, provider: 'apple' });\n  }\n\n  // region AptosWallet\n\n  get features(): AptosFeatures & AptosSignAndSubmitTransactionFeature {\n    return {\n      [AptosConnectNamespace]: {\n        connect: this.connect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosDisconnectNamespace]: {\n        disconnect: this.disconnect.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetAccountNamespace]: {\n        account: this.getAccount.bind(this),\n        version: '1.0.0',\n      },\n      [AptosGetNetworkNamespace]: {\n        network: this.getNetwork.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnAccountChangeNamespace]: {\n        onAccountChange: this.onAccountChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosOnNetworkChangeNamespace]: {\n        onNetworkChange: this.onNetworkChange.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignAndSubmitTransactionNamespace]: {\n        signAndSubmitTransaction: this.signAndSubmitTransaction.bind(this),\n        version: '1.1.0',\n      },\n      [AptosSignInNamespace]: {\n        signIn: this.signIn.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignMessageNamespace]: {\n        signMessage: this.signMessage.bind(this),\n        version: '1.0.0',\n      },\n      [AptosSignTransactionNamespace]: {\n        signTransaction: this.signTransaction.bind(this),\n        version: '1.1',\n      },\n    };\n  }\n\n  // endregion\n}\n"],"names":["AccountAddress","Network","AccountInfo","APTOS_CHAINS","UserResponseStatus","AccountInfo","Network","APTOS_CHAINS","AccountInfo","AccountAddress","UserResponseStatus","response","AptosConnectNamespace","AptosDisconnectNamespace","AptosGetAccountNamespace","AptosGetNetworkNamespace","AptosOnAccountChangeNamespace","AptosOnNetworkChangeNamespace","AptosSignAndSubmitTransactionNamespace","AptosSignInNamespace","AptosSignMessageNamespace","AptosSignTransactionNamespace","AptosConnectNamespace","AptosDisconnectNamespace","AptosGetAccountNamespace","AptosGetNetworkNamespace","AptosOnAccountChangeNamespace","AptosOnNetworkChangeNamespace","AptosSignAndSubmitTransactionNamespace","AptosSignInNamespace","AptosSignMessageNamespace","AptosSignTransactionNamespace"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6],"debugId":null}}]
}